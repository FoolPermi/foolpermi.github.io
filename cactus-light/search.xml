<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Collection Types in Swift</title>
      <link href="/cactus-light/2019/11/25/Collection-Types-in-Swift/"/>
      <url>/cactus-light/2019/11/25/Collection-Types-in-Swift/</url>
      <content type="html"><![CDATA[<p>åŒå„ç§å¸¸è§çš„è¯­è¨€ä¸€æ ·ï¼Œswift ä¸­ä¹ŸåŒ…æ‹¬å„ç§é›†åˆç±»å‹ã€‚swift ä¸­çš„é›†åˆç±»å‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§: <strong>Array</strong>, <strong>Set</strong>, <strong>Dictionary</strong>.<br>å£°æ˜ä¸€ä¸ªé›†åˆç±»å‹çš„æ—¶å€™ï¼Œå¿…é¡»æ˜ç¡®æŒ‡å‡ºé›†åˆç±»å‹æ˜¯ <strong>let</strong> è¿˜æ˜¯ <strong>var</strong>, ä½¿ç”¨çš„å…³é”®å­—ä¸åŒå°†å†³å®šé›†åˆä¸­çš„å…ƒç´ åœ¨å£°æ˜ä»¥åæ˜¯å¦å¯ä»¥æ”¹å˜ã€‚</p><h2 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h2><p>æ•°ç»„æ˜¯æŒ‰ç…§ä¸€å®šé¡ºåºå­˜å‚¨ç›¸åŒç±»å‹æ•°æ®çš„åˆé›†ã€‚æ•°ç»„å…ƒç´ çš„ä¸‹æ ‡ä» 0 å¼€å§‹ï¼Œä¾æ¬¡é€’å¢ã€‚</p><h3 id="Creating-Array"><a href="#Creating-Array" class="headerlink" title="Creating Array"></a>Creating Array</h3><p>åˆ›å»ºæ•°ç»„çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥ä½¿ç”¨ <strong>[]</strong> æ¥åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>Array</strong> å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ªæ•°ç»„ã€‚åˆ›å»ºæ•°ç»„çš„æ—¶å€™å¯ä»¥æ˜ç¡®æŒ‡å‡ºæ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å‡ºï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œç±»å‹æ¨æ–­ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// eg1:</span></span><br><span class="line"><span class="keyword">let</span> evenNumbers = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>] <span class="comment">// æ•°ç»„çš„ç±»å‹ä¸º[Int]</span></span><br><span class="line"><span class="comment">// eg2:</span></span><br><span class="line"><span class="keyword">var</span> subscribers: [<span class="type">String</span>] = [] <span class="comment">// åˆ›å»ºç©ºæ•°ç»„ï¼Œå¿…é¡»æŒ‡å®šæ•°ç»„ç±»å‹</span></span><br><span class="line"><span class="comment">// eg3:</span></span><br><span class="line"><span class="keyword">let</span> allZeros = <span class="type">Array</span>(repeating: <span class="number">0</span>, <span class="built_in">count</span>: <span class="number">5</span>) <span class="comment">// [0, 0, 0, 0, 0]</span></span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="Accessing-Array"><a href="#Accessing-Array" class="headerlink" title="Accessing Array"></a>Accessing Array</h3><p>æ•°ç»„ä¸­æœ‰å¾ˆå¤šçš„å±æ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„ä¸­çš„å±æ€§å’Œæ–¹æ³•æ¥æ“ä½œå’Œè®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> players = [<span class="string">"Alisa"</span>, <span class="string">"Bob"</span>, <span class="string">"Cindy"</span>, <span class="string">"Dennis"</span>]</span><br><span class="line"><span class="built_in">print</span>(players.isEmpty) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">print</span>(players.<span class="built_in">count</span>) <span class="comment">// 4</span></span><br><span class="line"><span class="keyword">var</span> currentPlayer = players.first <span class="comment">// access first element</span></span><br><span class="line"><span class="built_in">print</span>(currentPlayer <span class="keyword">as</span> <span class="type">Any</span>) <span class="comment">// currentPlayer is optional</span></span><br><span class="line"><span class="built_in">print</span>(players.last <span class="keyword">as</span> <span class="type">Any</span>) <span class="comment">// last element is also optional</span></span><br><span class="line">currentPlayer = players.<span class="built_in">min</span>() <span class="comment">// optional</span></span><br><span class="line"><span class="keyword">var</span> firstPlayer = players[<span class="number">0</span>] <span class="comment">// ä½¿ç”¨ä¸‹æ ‡è®¿é—®</span></span><br><span class="line">players.<span class="built_in">contains</span>(<span class="string">"Bob"</span>) <span class="comment">// å…ƒç´ æ£€æŸ¥</span></span><br></pre></td></tr></table></figure><h3 id="ArraySlice"><a href="#ArraySlice" class="headerlink" title="ArraySlice"></a>ArraySlice</h3><p>å¯ä»¥ç»™æ•°ç»„æŒ‡å®šä¸€ä¸ª range, ç„¶åå¯ä»¥è¿”å›ä¸€ä¸ªåŒ…å«éƒ¨åˆ†å…ƒç´ çš„å­æ•°ç»„ï¼Œä¹Ÿç§°ä¸ºåˆ‡ç‰‡ã€‚åˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡çš„æ–¹æ³•å¦‚ä¸‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> players = [<span class="string">"Alisa"</span>, <span class="string">"Bob"</span>, <span class="string">"Cindy"</span>, <span class="string">"Dennis"</span>]</span><br><span class="line"><span class="keyword">let</span> upcomingPlayersSlice = players[<span class="number">1</span>...<span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(upcomingPlayersSlice[<span class="number">1</span>], upcomingPlayersSlice[<span class="number">2</span>]) <span class="comment">// "Bob", "Cindy"</span></span><br></pre></td></tr></table></figure><h3 id="Modifying-Array"><a href="#Modifying-Array" class="headerlink" title="Modifying Array"></a>Modifying Array</h3><p>ä½¿ç”¨ var å£°æ˜çš„æ•°ç»„åœ¨åˆ›å»ºä»¥åå¯ä»¥è¿›è¡Œå¢åŠ /åˆ é™¤/æ’å…¥/æ›´æ–°å…ƒç´ ç­‰æ“ä½œã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> players = [<span class="string">"Alisa"</span>, <span class="string">"Bob"</span>, <span class="string">"Cindy"</span>, <span class="string">"Dennis"</span>]</span><br><span class="line"><span class="comment">// add elements</span></span><br><span class="line">players.append(<span class="string">"Eli"</span>)</span><br><span class="line">players += [<span class="string">"Gina"</span>]</span><br><span class="line"><span class="comment">// remove elements</span></span><br><span class="line"><span class="keyword">var</span> removedPlayer = players.removeLast()</span><br><span class="line">removedPlayer = players.remove(at: <span class="number">2</span>)</span><br><span class="line"><span class="comment">// insert elements</span></span><br><span class="line">players.insert(<span class="string">"Frank"</span>, at: <span class="number">3</span>)</span><br><span class="line"><span class="comment">// update elements</span></span><br><span class="line">players[<span class="number">4</span>] = <span class="string">"Linda"</span></span><br><span class="line"><span class="comment">// swap elements</span></span><br><span class="line">players.swapAt(<span class="number">1</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure><h3 id="Array-Iteration"><a href="#Array-Iteration" class="headerlink" title="Array Iteration"></a>Array Iteration</h3><p>ä½¿ç”¨ for-in éå†æ•°ç»„ä¸­çš„å…ƒç´ åŠå…¶ä¸‹æ ‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> players = [<span class="string">"Alisa"</span>, <span class="string">"Bob"</span>, <span class="string">"Cindy"</span>, <span class="string">"Dennis"</span>]</span><br><span class="line"><span class="keyword">for</span> player <span class="keyword">in</span> players &#123;</span><br><span class="line">    <span class="built_in">print</span>(player)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (index, player) <span class="keyword">in</span> players.enumerated() &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(index + <span class="number">1</span>)</span>. <span class="subst">\(player)</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Dictionary"><a href="#Dictionary" class="headerlink" title="Dictionary"></a>Dictionary</h2><p>Dictionary æ˜¯ä¸€ç§å­˜å‚¨å¤šä¸ªç›¸åŒç±»å‹çš„å€¼çš„å®¹å™¨ã€‚æ¯ä¸ªå€¼ (value) éƒ½å…³è”å”¯ä¸€çš„é”® (key), é”®ä½œä¸ºå­—å…¸ä¸­çš„è¿™ä¸ªå€¼æ•°æ®çš„æ ‡è¯†ç¬¦ã€‚å’Œæ•°ç»„ä¸­çš„æ•°æ®é¡¹ä¸åŒï¼Œå­—å…¸ä¸­çš„æ•°æ®é¡¹å¹¶æ²¡æœ‰å…·ä½“é¡ºåºã€‚</p><h3 id="Creating-Dictionary"><a href="#Creating-Dictionary" class="headerlink" title="Creating Dictionary"></a>Creating Dictionary</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> nameAndScores = [<span class="string">"Anna"</span>: <span class="number">2</span>, <span class="string">"Linda"</span>: <span class="number">6</span>, <span class="string">"Ermei"</span>: <span class="number">3</span>, <span class="string">"Bella"</span>: <span class="number">5</span>] <span class="comment">// type: [String: Int]</span></span><br><span class="line">nameAndScores = [:] <span class="comment">// make existed dictionary empty</span></span><br><span class="line"><span class="comment">// create an empty dictionary</span></span><br><span class="line"><span class="keyword">var</span> namesAndAges: [<span class="type">String</span>: <span class="type">Int</span>] = [:]</span><br></pre></td></tr></table></figure><h3 id="Accessing-Dictionary"><a href="#Accessing-Dictionary" class="headerlink" title="Accessing Dictionary"></a>Accessing Dictionary</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> namesAndScores = [<span class="string">"Anna"</span>: <span class="number">2</span>, <span class="string">"Linda"</span>: <span class="number">6</span>, <span class="string">"Ermei"</span>: <span class="number">3</span>, <span class="string">"Bella"</span>: <span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> scoreOfAnna = namesAndScores[<span class="string">"Anna"</span>] <span class="comment">// 2</span></span><br><span class="line">namesAndScores.isEmpty <span class="comment">// false</span></span><br><span class="line">namesAndScores.<span class="built_in">count</span> <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><h3 id="Modifying-Dictionary"><a href="#Modifying-Dictionary" class="headerlink" title="Modifying Dictionary"></a>Modifying Dictionary</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> namesAndScores = [<span class="string">"Anna"</span>: <span class="number">2</span>, <span class="string">"Linda"</span>: <span class="number">6</span>, <span class="string">"Ermei"</span>: <span class="number">3</span>, <span class="string">"Bella"</span>: <span class="number">5</span>]</span><br><span class="line">namesAndScores.updateValue(<span class="number">4</span>, forKey: <span class="string">"Ermei"</span>)</span><br><span class="line">namesAndScores[<span class="string">"Bella"</span>] = <span class="number">7</span> <span class="comment">// update element, add it if not exist</span></span><br><span class="line">namesAndScores.removeValue(forKey: <span class="string">"Anna"</span>)</span><br><span class="line">namesAndScores[<span class="string">"Linda"</span>] = <span class="literal">nil</span> <span class="comment">// remove element</span></span><br></pre></td></tr></table></figure><p>å¦‚æœ Dictionary ä¸­çš„ value æ˜¯ optinal ç±»å‹çš„å…ƒç´ ï¼Œé€šè¿‡ <code>dic[key] = nil</code>, çš„æ–¹å¼ä»ç„¶ä¼šç§»é™¤å…ƒç´ ï¼Œå¦‚æœæƒ³è¦å°† optional çš„å…ƒç´ è®¾ç½®ä¸º nil, å¿…é¡»ä½¿ç”¨ <code>dic.updateValue(nil, forKey: key)</code> çš„æ–¹å¼ã€‚</p><h3 id="Dictionary-Iteration"><a href="#Dictionary-Iteration" class="headerlink" title="Dictionary Iteration"></a>Dictionary Iteration</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> namesAndScores = [<span class="string">"Anna"</span>: <span class="number">2</span>, <span class="string">"Linda"</span>: <span class="number">6</span>, <span class="string">"Ermei"</span>: <span class="number">3</span>, <span class="string">"Bella"</span>: <span class="number">5</span>]</span><br><span class="line"><span class="keyword">for</span> (name, score) <span class="keyword">in</span> namesAndScores &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(name)</span> - <span class="subst">\(score)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> namesAndScores.keys &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(name)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> score <span class="keyword">in</span> namesAndScores.values&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(score)</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><p>Set ç”¨æ¥å­˜å‚¨ç±»å‹ç›¸åŒä¸”æ²¡æœ‰ç¡®å®šé¡ºåºçš„å€¼ã€‚ä¸æ•°ç»„çš„ä¸»è¦åŒºåˆ«æ˜¯é›†åˆä¸­çš„å…ƒç´ æ˜¯æ— åºçš„ï¼Œè€Œä¸”é›†åˆä¸­çš„å…ƒç´ ä¸å…è®¸é‡å¤ã€‚</p><h3 id="Creating-Set"><a href="#Creating-Set" class="headerlink" title="Creating Set"></a>Creating Set</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> setOne: <span class="type">Set</span>&lt;<span class="type">Int</span>&gt; = [<span class="number">1</span>]</span><br><span class="line"><span class="keyword">let</span> someSet = <span class="type">Set</span>([<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>])</span><br></pre></td></tr></table></figure><h3 id="Accessing-Set"><a href="#Accessing-Set" class="headerlink" title="Accessing Set"></a>Accessing Set</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> someSet: <span class="type">Set</span>&lt;<span class="type">Int</span>&gt; = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">someSet.<span class="built_in">contains</span>(<span class="number">1</span>) <span class="comment">// true</span></span><br><span class="line">someSet.<span class="built_in">contains</span>(<span class="number">5</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h3 id="Modifying-Set"><a href="#Modifying-Set" class="headerlink" title="Modifying Set"></a>Modifying Set</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> someSet:<span class="type">Set</span>&lt;<span class="type">Int</span>&gt; = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">someSet.insert(<span class="number">5</span>)</span><br><span class="line">someSet.remove(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="Set-Iteration"><a href="#Set-Iteration" class="headerlink" title="Set Iteration"></a>Set Iteration</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> someSet: <span class="type">Set</span>&lt;<span class="type">Int</span>&gt; = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> someSet &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(num)</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h2><p>Swift ä¸­ String ç±»ä¼¼äºé›†åˆç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨é›†åˆç±»å‹éå†çš„æ–¹æ³•æ¥éå†ä¸€ä¸ª Stringã€‚å’Œæ™®é€šçš„é›†åˆç±»å‹æœ‰æ‰€åŒºåˆ«çš„æ˜¯ï¼Œä¸å¯ä»¥ä½¿ç”¨ä¸‹æ ‡æ¥ç›´æ¥è·å– String ä¸­æŒ‡å®šä½ç½®çš„å­—ç¬¦ã€‚å› ä¸º String ä¸­çš„å­—ç¬¦ç”±äºç¼–ç æ–¹å¼çš„å·®å¼‚ï¼Œå¯èƒ½éœ€è¦ä¸åŒå­—èŠ‚é•¿åº¦çš„å­˜å‚¨ç©ºé—´ã€‚</p><h3 id="Creating-Accessing-Strings"><a href="#Creating-Accessing-Strings" class="headerlink" title="Creating/Accessing Strings"></a>Creating/Accessing Strings</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> string = <span class="string">"Ray"</span></span><br><span class="line"><span class="keyword">var</span> greeting = <span class="type">String</span>(<span class="string">"Hello World"</span>)</span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> string &#123;</span><br><span class="line">    <span class="built_in">print</span>(char)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> strLen = string.<span class="built_in">count</span></span><br><span class="line"><span class="keyword">let</span> secondChar = string[<span class="number">1</span>] <span class="comment">// error</span></span><br><span class="line"><span class="keyword">let</span> cafeNormal = <span class="string">"cafÃ©"</span></span><br><span class="line"><span class="keyword">let</span> cafeCombining = <span class="string">"cafe\u&#123;0301&#125;"</span></span><br><span class="line">cafeNormal.<span class="built_in">count</span> <span class="comment">// 4</span></span><br><span class="line">cafeCombining.<span class="built_in">count</span> <span class="comment">// 4</span></span><br><span class="line">cafeNormal.unicodeScalars.<span class="built_in">count</span> <span class="comment">// 4</span></span><br><span class="line">cafeCombining.unicodeScalars.<span class="built_in">count</span> <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="built_in">equal</span> = cafeNormal == cafeCombining <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="Indexing-Strings"><a href="#Indexing-Strings" class="headerlink" title="Indexing Strings"></a>Indexing Strings</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> cafeNormal = <span class="string">"cafÃ©"</span></span><br><span class="line"><span class="keyword">let</span> firstIdx = cafeNormal.startIndex</span><br><span class="line"><span class="keyword">let</span> firstChar = cafeNormal[firstIdx]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fourthIdx = cafeNormal.index(cafeNormal.startIndex, offsetBy: <span class="number">3</span>)</span><br><span class="line"><span class="keyword">let</span> fourthChar = cafeNormal[fourthIdx] <span class="comment">// Ã©</span></span><br><span class="line">fourthChar.unicodeScalars.<span class="built_in">count</span> <span class="comment">// 1</span></span><br><span class="line">fourthChar.unicodeScalars.forEach &#123; codePoint <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(codePoint.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> lastIdx = cafeNormal.index(before: cafeNormal.endIndex)</span><br><span class="line"><span class="keyword">let</span> lastChar = cafeNormal[lastIdx] <span class="comment">// Ã©</span></span><br></pre></td></tr></table></figure><h3 id="Strings-as-Collections"><a href="#Strings-as-Collections" class="headerlink" title="Strings as Collections"></a>Strings as Collections</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">"Matt"</span></span><br><span class="line"><span class="keyword">let</span> backwardsName = name.reversed() <span class="comment">// ReversedCollection&lt;String&gt;</span></span><br><span class="line"><span class="keyword">let</span> thirdCharIdx = backwardsName.index(backwardsName.startIndex, offsetBy: <span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> thirdChar = backwardsName[thirdCharIdx]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> backwardsNameStr = <span class="type">String</span>(backwardsName)</span><br></pre></td></tr></table></figure><h3 id="Raw-Strings"><a href="#Raw-Strings" class="headerlink" title="Raw Strings"></a>Raw Strings</h3><p>å½“ String ä¸­å«æœ‰éœ€è¦è½¬è¯‘çš„å­—ç¬¦æ—¶ï¼Œä¸ºäº†é¿å…è½¬è¯‘ï¼Œå¯ä»¥ä½¿ç”¨ â€˜#â€™ æ¥æ ‡è®°ä¸º <strong>Raw String</strong>.</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> raw1 = #<span class="string">"Raw "</span><span class="type">No</span> <span class="type">Escaping</span><span class="string">" <span class="subst">\(no interpolation!)</span>. Use all the \ you want!"</span>#</span><br><span class="line"><span class="built_in">print</span>(raw1) <span class="comment">// Raw "No Escaping" \(no interpolation!). Use all the \ you want!</span></span><br><span class="line"><span class="keyword">let</span> raw2 = ##<span class="string">"Aren't we "</span># clever<span class="string">"##</span></span><br><span class="line"><span class="string">print(raw2) // Aren't we "</span># clever</span><br><span class="line"><span class="keyword">let</span> can = <span class="string">"can do that too"</span></span><br><span class="line"><span class="keyword">let</span> raw3 = #<span class="string">"Yes we \#(can)!"</span>#</span><br><span class="line"><span class="built_in">print</span>(raw3) <span class="comment">// Yes we can do that too!</span></span><br></pre></td></tr></table></figure><h3 id="Substrings"><a href="#Substrings" class="headerlink" title="Substrings"></a>Substrings</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fullName = <span class="string">"Peter Xu"</span></span><br><span class="line"><span class="keyword">let</span> spaceIdx = fullName.firstIndex(of: <span class="string">" "</span>)!</span><br><span class="line"><span class="keyword">let</span> firstName = fullName[fullName.startIndex..&lt;spaceIdx] <span class="comment">// "Peter"</span></span><br><span class="line"><span class="keyword">let</span> firstName = fullName[..&lt;spaceIdx] <span class="comment">// "Peter"</span></span><br><span class="line"><span class="keyword">let</span> lastName = fullName[fullName.index(after: spaceIdx)...]</span><br></pre></td></tr></table></figure><h3 id="Characters"><a href="#Characters" class="headerlink" title="Characters"></a>Characters</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> singleChar: <span class="type">Character</span> = <span class="string">"x"</span></span><br><span class="line">singleChar.isASCII <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> emojiChar: <span class="type">Character</span> = <span class="string">"ğŸ¤£"</span></span><br><span class="line">emojiChar.isASCII <span class="comment">// false</span></span><br><span class="line"><span class="keyword">let</span> space: <span class="type">Character</span> = <span class="string">" "</span></span><br><span class="line">space.isWhitespace <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> hexDigital: <span class="type">Character</span> = <span class="string">"d"</span></span><br><span class="line">hexDigital.isHexDigit <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> thaiNine: <span class="type">Character</span> = <span class="string">"à¹™"</span></span><br><span class="line">thaiNine.wholeNumberValue <span class="comment">// 9</span></span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Swift Basics</title>
      <link href="/cactus-light/2019/11/04/Swift-Basics/"/>
      <url>/cactus-light/2019/11/04/Swift-Basics/</url>
      <content type="html"><![CDATA[<h2 id="åŸºç¡€è¿ç®—"><a href="#åŸºç¡€è¿ç®—" class="headerlink" title="åŸºç¡€è¿ç®—"></a>åŸºç¡€è¿ç®—</h2><p>å’Œå…¶å®ƒç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œswiftæ”¯æŒåŠ  (+)ã€å‡ (-)ã€ä¹˜ (*)ã€é™¤ (/)ã€å–æ¨¡ (%)ã€ç§»ä½ç­‰å¤šç§åŸºç¡€è¿ç®—ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="number">2</span> + <span class="number">6</span> <span class="comment">// ok</span></span><br><span class="line"><span class="number">2</span>+<span class="number">6</span> <span class="comment">// ok</span></span><br><span class="line"><span class="number">2</span> +<span class="number">6</span> <span class="comment">// error</span></span><br><span class="line"><span class="number">2</span>+ <span class="number">6</span> <span class="comment">// error</span></span><br><span class="line"><span class="number">2</span> - <span class="number">6</span></span><br><span class="line"><span class="number">2</span> * <span class="number">6</span></span><br><span class="line"><span class="number">6</span> / <span class="number">2</span></span><br><span class="line"><span class="number">6.0</span> / <span class="number">2.0</span></span><br><span class="line"><span class="number">28</span> % <span class="number">10</span></span><br><span class="line">(<span class="number">28.0</span>).truncatingRemainder(dividingBy: <span class="number">10.0</span>) <span class="comment">// æµ®ç‚¹æ•°å–æ¨¡</span></span><br><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">3</span> <span class="comment">// 8</span></span><br><span class="line"><span class="number">32</span> &gt;&gt; <span class="number">2</span> <span class="comment">// 8</span></span><br><span class="line">sin(<span class="number">45</span> * <span class="type">Double</span>.pi / <span class="number">180</span>)</span><br><span class="line">cos(<span class="number">135</span> * <span class="type">Double</span>.pi / <span class="number">180</span>)</span><br><span class="line">(<span class="number">2.0</span>).squareRoot()</span><br><span class="line"><span class="built_in">max</span>(<span class="number">5</span>, <span class="number">10</span>) <span class="comment">// 10</span></span><br><span class="line"><span class="built_in">min</span>(-<span class="number">5</span>, -<span class="number">10</span>) <span class="comment">// -10</span></span><br></pre></td></tr></table></figure><h2 id="let-VS-var"><a href="#let-VS-var" class="headerlink" title="let VS var"></a>let VS var</h2><p><strong>let</strong> ç”¨æ¥å£°æ˜å¸¸é‡ï¼Œ<strong>var</strong> ç”¨æ¥å£°æ˜å˜é‡ã€‚å£°æ˜å¸¸é‡æˆ–å˜é‡çš„æ—¶å€™å¯ä»¥ä¸æŒ‡å®šæ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šè¿›è¡Œæ¨æ–­ã€‚ä½†æ˜¯ä¸€æ—¦ç¡®å®šç±»å‹ä»¥åï¼Œä¾¿åªèƒ½èµ‹äºˆç›¸åŒç±»å‹çš„å˜é‡å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> number: <span class="type">Int</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> pi: <span class="type">Double</span> = <span class="number">3.14</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">"Peter"</span> <span class="comment">// name is a string</span></span><br><span class="line">name = <span class="number">15</span> <span class="comment">// error</span></span><br><span class="line">name = <span class="string">"Linda"</span> <span class="comment">// ok</span></span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="åŸºæœ¬ç±»å‹å’Œæ“ä½œç¬¦"><a href="#åŸºæœ¬ç±»å‹å’Œæ“ä½œç¬¦" class="headerlink" title="åŸºæœ¬ç±»å‹å’Œæ“ä½œç¬¦"></a>åŸºæœ¬ç±»å‹å’Œæ“ä½œç¬¦</h2><p>swift ä¸­åŸºæœ¬æ•°æ®ç±»å‹æœ‰ Int8, UInt8, Int16, UInt16, Int32, UInt32, Int64, UInt64, Float, Double. å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¯ä»¥ç›´æ¥ä½¿ç”¨ <strong>Int</strong> å’Œ <strong>Double</strong>.</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a: <span class="type">Int16</span> = <span class="number">12</span></span><br><span class="line"><span class="keyword">let</span> b: <span class="type">UInt8</span> = <span class="number">255</span></span><br><span class="line"><span class="keyword">let</span> <span class="built_in">c</span>: <span class="type">Int32</span> = -<span class="number">10000</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="type">Int</span>(a) + <span class="type">Int</span>(b) + <span class="type">Int</span>(<span class="built_in">c</span>) <span class="comment">// result is an Int</span></span><br></pre></td></tr></table></figure><p>swift ä¸­è¡¨ç¤ºå•ä¸ªå­—ç¬¦å’Œå­—ç¬¦ä¸²æ—¶éƒ½æ˜¯ä½¿ç”¨å¼•å·ï¼Œå½“æœªæ˜ç¡®æŒ‡å®šç±»å‹æ—¶é»˜è®¤æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ‰€ä»¥å¦‚æœæœŸæœ›è¡¨ç¤ºå•ä¸ªå­—ç¬¦ï¼Œè¯·ä¸€å®šæŒ‡å®šç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> charA: <span class="type">Character</span> = <span class="string">"a"</span></span><br><span class="line"><span class="keyword">let</span> strA: <span class="type">String</span> = <span class="string">"a"</span></span><br><span class="line"><span class="keyword">let</span> strB = <span class="string">"b"</span> <span class="comment">// so if you want to make a Char, you must explicit its type</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">"Jay"</span></span><br><span class="line"><span class="keyword">var</span> greeting = <span class="string">"My name is <span class="subst">\(name)</span>"</span> <span class="comment">// "My name is Jay"</span></span><br><span class="line"><span class="comment">// å¤šè¡Œå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">let</span> bigStr = <span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">                This is </span></span><br><span class="line"><span class="string">                a Multiple lines</span></span><br><span class="line"><span class="string">                string.</span></span><br><span class="line"><span class="string">             "</span><span class="string">""</span></span><br></pre></td></tr></table></figure><p>Tuple ç±»å‹ç”¨æ¥è¡¨ç¤ºå…·æœ‰å¤šä¸ªå­—æ®µçš„æ•°æ®å…ƒç»„ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> coordinates: (<span class="type">Int</span>, <span class="type">Int</span>) = (<span class="number">2</span>, <span class="number">3</span>) <span class="comment">// coordinates çš„ç±»å‹ä¸º (Int, Int)</span></span><br><span class="line"><span class="keyword">let</span> location = (<span class="number">2.1</span>, <span class="number">3.5</span>, <span class="number">1</span>) <span class="comment">// location ç±»å‹æ¨æ–­ä¸º (Double, Double, Int)</span></span><br><span class="line"><span class="keyword">let</span> x1 = coordinates.<span class="number">0</span> <span class="comment">// ä½¿ç”¨ä¸‹æ ‡è®¿é—® Tuple ä¸­çš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">let</span> y1 = coordinates.<span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> location3D = (x: <span class="number">2</span>, y: <span class="number">3</span>, z: <span class="number">4</span>) </span><br><span class="line"><span class="keyword">let</span> x2 = location3D.x <span class="comment">// ä½¿ç”¨å…ƒç´ åè®¿é—® Tuple ä¸­å…ƒç´ </span></span><br><span class="line"><span class="keyword">let</span> y2 = location3D.y</span><br><span class="line"><span class="keyword">let</span> z2 = location3D.z</span><br><span class="line"><span class="keyword">let</span> (x3, y3, z3) = location3D</span><br></pre></td></tr></table></figure><h2 id="Type-alias"><a href="#Type-alias" class="headerlink" title="Type alias"></a>Type alias</h2><p><strong>typealias</strong> æ˜¯ swift ä¸­ç”¨æ¥ç»™ç±»å‹æŒ‡å®šåˆ«åçš„å…³é”®å­—ï¼Œç›¸å½“äº C è¯­è¨€ä¸­çš„ typedef.</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Animal</span> = <span class="type">String</span></span><br><span class="line"><span class="keyword">let</span> myPet: <span class="type">Animal</span> = <span class="string">"Dog"</span></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Coordinates</span> = (<span class="type">Int</span>, <span class="type">Int</span>)</span><br><span class="line"><span class="keyword">let</span> xy: <span class="type">Coordinates</span> = (<span class="number">2</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><h2 id="Basic-Control-Flow"><a href="#Basic-Control-Flow" class="headerlink" title="Basic Control Flow"></a>Basic Control Flow</h2><h3 id="Bool-ç±»å‹"><a href="#Bool-ç±»å‹" class="headerlink" title="Bool ç±»å‹"></a>Bool ç±»å‹</h3><p>swift ä¸­ Bool ç±»å‹çš„ä¸¤ç§å–å€¼æ˜¯ <strong>true</strong> å’Œ <strong>false</strong>.</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> yes: <span class="type">Bool</span> = <span class="literal">true</span></span><br><span class="line"><span class="keyword">let</span> no: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line"><span class="keyword">let</span> and = (<span class="number">2</span> &gt; <span class="number">1</span>) &amp;&amp; (<span class="string">"Hello"</span> == <span class="string">"World"</span>)</span><br><span class="line"><span class="keyword">let</span> or = (<span class="number">2</span> &gt; <span class="number">1</span>) || (<span class="string">"Hello"</span> == <span class="string">"World"</span>)</span><br><span class="line"><span class="keyword">let</span> not = !(<span class="number">2</span> &gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">var</span> switchState = <span class="literal">true</span></span><br><span class="line">switchState.toggle() <span class="comment">// switchState = false</span></span><br><span class="line">switchState.toggle() <span class="comment">// switchState = true</span></span><br></pre></td></tr></table></figure><h3 id="if-è¯­å¥"><a href="#if-è¯­å¥" class="headerlink" title="if è¯­å¥"></a>if è¯­å¥</h3><p>swift ä¸­ if è¯­å¥åé¢çš„æ¡ä»¶ä¸éœ€è¦ä½¿ç”¨<strong>æ‹¬å·()</strong>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> condition1 &#123;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> condition2 &#123;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="while-è¯­å¥"><a href="#while-è¯­å¥" class="headerlink" title="while è¯­å¥"></a>while è¯­å¥</h3><p>å’Œ if è¯­å¥ç±»ä¼¼ï¼Œwhile è¯­å¥åé¢çš„æ¡ä»¶ä¹Ÿä¸éœ€è¦ä½¿ç”¨æ‹¬å·ã€‚repeat-while è¯­å¥ç±»ä¼¼äºå…¶å®ƒè¯­è¨€ä¸­çš„ do-while, å¾ªç¯ä½“ä¸­çš„ä»£ç è‡³å°‘ä¼šè¢«æ‰§è¡Œä¸€æ¬¡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> condition &#123;</span><br><span class="line">    loop code</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">repeat</span> &#123;</span><br><span class="line">    loop code</span><br><span class="line">&#125; <span class="keyword">while</span> condition</span><br></pre></td></tr></table></figure><h3 id="for-è¯­å¥"><a href="#for-è¯­å¥" class="headerlink" title="for è¯­å¥"></a>for è¯­å¥</h3><p>swift ä¸æ”¯æŒ C Style çš„ for è¯­å¥ã€‚è€Œä¸”åœ¨ for è¯­å¥çš„æ¡ä»¶é‡Œé¢å¯ä»¥ä½¿ç”¨ where å…³é”®å­—å¯¹å¾ªç¯çš„å¯¹è±¡è¿›è¡Œç­›é€‰ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> constant <span class="keyword">in</span> range &#123;</span><br><span class="line">    loop code</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg1:</span></span><br><span class="line"><span class="keyword">let</span> <span class="built_in">count</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>...<span class="number">10</span> &#123; <span class="comment">// æ­¤å¤„ i ä¸éœ€è¦ä½¿ç”¨ let æˆ– var </span></span><br><span class="line">    sum += i</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg2:</span></span><br><span class="line"><span class="keyword">let</span> step = <span class="number">5</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">10</span> &#123; <span class="comment">// å¦‚æœä¸éœ€è¦è®¿é—® i çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ _ ä»£æ›¿</span></span><br><span class="line">    sum += step</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg3:</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>...<span class="number">10</span> <span class="keyword">where</span> i % <span class="number">2</span> == <span class="number">0</span> &#123; <span class="comment">// å¯ä»¥ä½¿ç”¨ where æ¥æŒ‡å®šé™„åŠ æ¡ä»¶, åªæœ‰ where æ¡ä»¶ä¸º true æ—¶ï¼Œå¾ªç¯ä½“æ‰ä¼šæ‰§è¡Œ</span></span><br><span class="line">    sum += i</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg4:</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">8</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> row % <span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">continue</span> <span class="comment">// ä½¿ç”¨ continue è·³å‡ºæœ¬æ¬¡å¾ªç¯</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> column <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">8</span> &#123;</span><br><span class="line">        sum += row * column</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg5:</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span></span><br><span class="line">rowLoop: <span class="keyword">for</span> row <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">8</span> &#123;</span><br><span class="line">    columnLoop: <span class="keyword">for</span> column <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="number">8</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> row == column &#123;</span><br><span class="line">            <span class="keyword">continue</span> rowLoop <span class="comment">// é€šè¿‡æ·»åŠ  labelï¼Œè·³å‡ºæŒ‡å®š level å¾ªç¯</span></span><br><span class="line">        &#125;</span><br><span class="line">        sum += row * column</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="switch-è¯­å¥"><a href="#switch-è¯­å¥" class="headerlink" title="switch è¯­å¥"></a>switch è¯­å¥</h3><p>swift ä¸­çš„ switch è¯­å¥éå¸¸çµæ´»ï¼Œå¯ä»¥åŒ¹é…å¤šç§ caseï¼Œè€Œä¸” breakä¸æ˜¯å¿…éœ€çš„ï¼Œé™¤é case ä¸‹é¢æ²¡æœ‰ä»»ä½•éœ€è¦æ‰§è¡Œçš„ code æ—¶ï¼Œéœ€è¦ä½¿ç”¨ breakã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// eg1:</span></span><br><span class="line"><span class="keyword">let</span> animal = <span class="string">"Dog"</span></span><br><span class="line"><span class="keyword">switch</span> animal &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"Dog"</span>, <span class="string">"Cat"</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"It is a house animal"</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"It is not a house animal"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg2:</span></span><br><span class="line"><span class="keyword">let</span> hourOfDay = <span class="number">12</span></span><br><span class="line"><span class="keyword">var</span> timeOfDay = <span class="string">""</span></span><br><span class="line"><span class="keyword">switch</span> hourOfDay &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Early morning"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Morning"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Afternoon"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Evening"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Later Evening"</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Invalid time"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(timeOfDay)</span><br><span class="line"><span class="comment">// eg3:</span></span><br><span class="line"><span class="keyword">let</span> hourOfDay = <span class="number">12</span></span><br><span class="line"><span class="keyword">var</span> timeOfDay = <span class="string">""</span></span><br><span class="line"><span class="keyword">switch</span> hourOfDay &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>...<span class="number">5</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Early morning"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>...<span class="number">11</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Morning"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">12</span>...<span class="number">16</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Afternoon"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">17</span>...<span class="number">19</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Evening"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">20</span>...<span class="number">23</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Later Evening"</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        timeOfDay = <span class="string">"Invalid time"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(timeOfDay)</span><br><span class="line"><span class="comment">// eg4:</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">10</span></span><br><span class="line"><span class="keyword">switch</span> num &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> x <span class="keyword">where</span> x % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Even"</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Odd"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg5:</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">10</span></span><br><span class="line"><span class="keyword">switch</span> num &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">_</span> <span class="keyword">where</span> num % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Even"</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Odd"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg6:</span></span><br><span class="line"><span class="keyword">let</span> coordinates = (x: <span class="number">3</span>, y: <span class="number">2</span>, z: <span class="number">5</span>)</span><br><span class="line"><span class="keyword">switch</span> coordinates &#123;</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Origin"</span>)</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">_</span>, <span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"X-axis"</span>)</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">0</span>, <span class="number">_</span>, <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Y-axis"</span>)</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">0</span>, <span class="number">0</span>, <span class="number">_</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Z-axis"</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Somewhere"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg7:</span></span><br><span class="line"><span class="keyword">let</span> coordinates = (x: <span class="number">3</span>, y: <span class="number">2</span>, z: <span class="number">5</span>)</span><br><span class="line"><span class="keyword">switch</span> coordinates &#123;</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Origin"</span>)</span><br><span class="line">    <span class="keyword">case</span> (<span class="keyword">let</span> x, <span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"X-axis at x = <span class="subst">\(x)</span>"</span>)</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">0</span>, <span class="keyword">let</span> y, <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Y-axis at y = <span class="subst">\(y)</span>"</span>)</span><br><span class="line">    <span class="keyword">case</span> (<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">let</span> z):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Z-axis at z = <span class="subst">\(z)</span>"</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span>(x, y, z):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Somewhere at (<span class="subst">\(x)</span>, <span class="subst">\(y)</span>, <span class="subst">\(z)</span>)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// eg8</span></span><br><span class="line"><span class="keyword">let</span> coordinates = (x: <span class="number">3</span>, y: <span class="number">2</span>, z: <span class="number">5</span>)</span><br><span class="line"><span class="keyword">switch</span> coordinates &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> (x, y, <span class="number">_</span>) <span class="keyword">where</span> y == x:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Y-X Line"</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> (x, y, <span class="number">_</span>) <span class="keyword">where</span> y == x * x:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Y-X^2 Line"</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><p>swift ä¸­ä½¿ç”¨ <strong>func</strong> å…³é”®å­—æ¥æ ‡è¯†ä¸€ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªå‡½æ•°çš„åŸºæœ¬ç»„æˆåŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">functionName</span><span class="params">(para1: <span class="keyword">Type</span>, para2: <span class="keyword">Type</span>, ...)</span></span> -&gt; returnType &#123;</span><br><span class="line">    <span class="comment">// function body</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ä¾‹å­ä»£è¡¨äº† swift ä¸­å‡½æ•°çš„åŸºæœ¬å‘½åè§„åˆ™å’Œè°ƒç”¨æ–¹æ³•ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// eg1:</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printMyName</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"My name is Peter"</span>)</span><br><span class="line">&#125;</span><br><span class="line">printMyName()</span><br><span class="line"><span class="comment">// eg2:</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printMultipleOf</span><span class="params">(multiplier: Int, andValue: Int)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(multiplier)</span> * <span class="subst">\(andValue)</span> = <span class="subst">\(multiplier * andValue)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line">printMultipleOf(multiplier: <span class="number">5</span>, andValue: <span class="number">10</span>)</span><br><span class="line"><span class="comment">// eg3:</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printMultipleOf</span><span class="params">(multiplier: Int, and value: Int)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(multiplier)</span> * <span class="subst">\(value)</span> = <span class="subst">\(multiplier * value)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line">printMultipleOf(multiplier: <span class="number">4</span>, and: <span class="number">2</span>)</span><br><span class="line"><span class="comment">// eg4:</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printMultipleOf</span><span class="params">(<span class="number">_</span> multiplier: Int, and value: Int)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(multiplier)</span> * <span class="subst">\(value)</span> = <span class="subst">\(multiplier * value)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line">printMultipleOf(<span class="number">4</span>, and: <span class="number">2</span>)</span><br><span class="line"><span class="comment">// eg5:</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printMultipleOf</span><span class="params">(<span class="number">_</span> multiplier: Int, <span class="number">_</span> value: Int)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(multiplier)</span> * <span class="subst">\(value)</span> = <span class="subst">\(multiplier * value)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line">printMultipleOf(<span class="number">4</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">// eg6:</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printMultipleOf</span><span class="params">(<span class="number">_</span> multiplier: Int, <span class="number">_</span> value: Int = <span class="number">1</span>)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(multiplier)</span> * <span class="subst">\(value)</span> = <span class="subst">\(multiplier * value)</span>"</span>)</span><br><span class="line">&#125;</span><br><span class="line">printMultipleOf(<span class="number">4</span>)</span><br><span class="line"><span class="comment">// eg7: return value</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">multiply</span><span class="params">(<span class="number">_</span> number: Int, by multiplier: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> number * multiplier </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result = multiply(<span class="number">4</span>, by: <span class="number">2</span>)</span><br><span class="line"><span class="comment">// eg8: return tuple</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">multiplyAndDivide</span><span class="params">(<span class="number">_</span> number: Int, by factor: Int)</span></span> -&gt; (product: <span class="type">Int</span>, quotient: <span class="type">Int</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (number * factor, number / factor)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result = multiplyAndDivide(<span class="number">4</span>, by: <span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> product = result.product</span><br><span class="line"><span class="keyword">let</span> quotient = result.quotient</span><br></pre></td></tr></table></figure><p>ç”±äºå‡½æ•°ä¸­çš„å‚æ•°é‡‡ç”¨å€¼ä¼ é€’çš„æ–¹å¼ï¼Œå› æ­¤ï¼Œå¦‚æœè¦ä¿®æ”¹å‡½æ•°çš„å‚æ•°çš„å€¼ï¼Œéœ€è¦ä½¿ç”¨ <strong>inout</strong> å…³é”®å­—å¯¹å‚æ•°è¿›è¡Œæ ‡è®°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">incrementAndPrint</span><span class="params">(<span class="number">_</span> value: <span class="keyword">inout</span> Int)</span></span> &#123;</span><br><span class="line">    value += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> value = <span class="number">5</span>;</span><br><span class="line">incrementAndPrint(&amp;value)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ /// å¯ä»¥ç»™å‡½æ•°æ·»åŠ æ³¨é‡Šï¼Œåœ¨ç¼–è¾‘å™¨ä¸­è¿›è¡Œè¾“å…¥çš„æ—¶å€™ï¼Œæ³¨é‡Šçš„å†…å®¹ä¼šä½œä¸ºæç¤ºã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// Calculate the average of three values</span></span><br><span class="line"><span class="comment">/// - Parameters:</span></span><br><span class="line"><span class="comment">/// - a: The first value</span></span><br><span class="line"><span class="comment">/// - b: The second value</span></span><br><span class="line"><span class="comment">/// - c: The third value</span></span><br><span class="line"><span class="comment">/// - Returns: The average of the three values</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calculateAverage</span><span class="params">(of a: Double, and b: Double, and <span class="built_in">c</span>: Double)</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> total = a + b + <span class="built_in">c</span></span><br><span class="line">    <span class="keyword">let</span> average = total / <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> average</span><br><span class="line">&#125;</span><br><span class="line">calculateAverage(of:<span class="number">1</span>, and: <span class="number">3</span>, and: <span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>å‚è€ƒ: Swift Apprentice</p>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Generics in Swift</title>
      <link href="/cactus-light/2016/11/28/Generics-in-Swift/"/>
      <url>/cactus-light/2016/11/28/Generics-in-Swift/</url>
      <content type="html"><![CDATA[<p><strong>æ³›å‹ (Generics)</strong> æ˜¯ Swift ä¸­æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œè®¸å¤š Swift çš„æ ‡å‡†åº“ä¹Ÿéƒ½æ˜¯åŸºäºæ³›å‹çš„ä»£ç æ„å»ºçš„ã€‚ä½¿ç”¨æ³›å‹å¯ä»¥è®©ä½ æ ¹æ®è‡ªå®šä¹‰çš„éœ€æ±‚ï¼Œç¼–å†™å‡ºé€‚ç”¨äºä»»æ„ç±»å‹ã€çµæ´»å¯é‡ç”¨çš„å‡½æ•°å’Œç±»å‹ã€‚ä¾‹å¦‚ Swift ä¸­çš„ Array å’Œ Dictionary éƒ½æ˜¯æ³›å‹é›†åˆï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª Int æ•°ç»„ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ª String æ•°ç»„ï¼Œè¿˜å¯ä»¥åˆ›å»ºå…¶å®ƒç±»å‹çš„æ•°ç»„ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä»»æ„æŒ‡å®šç±»å‹çš„å­—å…¸ï¼Œæœ¬æ–‡çš„ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š</p><ul><li>æ³›å‹è§£å†³çš„é—®é¢˜ (The problems generic solve)</li><li>æ³›å‹å‡½æ•° (Generic functions)</li><li>æ³›å‹ç±»å‹ (Generic types)</li><li>æ‰©å±•æ³›å‹ç±»å‹ (Extending a generic type)</li><li>ç±»å‹çº¦æŸ (Type constrains)</li><li>å…³è”ç±»å‹ (Associated type)</li><li>Where è¯­å¥ (Generic where clauses)</li></ul><a id="more"></a><h2 id="The-problem-generics-solve"><a href="#The-problem-generics-solve" class="headerlink" title="The problem generics solve"></a>The problem generics solve</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ ‡å‡†çš„éæ³›å‹å‡½æ•° swapTwoIntsï¼Œç”¨æ¥äº¤æ¢ä¸¤ä¸ª Int å€¼ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoInts</span><span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> Int, <span class="number">_</span> b: <span class="keyword">inout</span> Int)</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> temp = a</span><br><span class="line">  a = b</span><br><span class="line">  b = temp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä½¿ç”¨è¾“å…¥è¾“å‡ºå‚æ•° (inout) æ¥äº¤æ¢ a å’Œ b çš„å€¼ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> someInt = <span class="number">3</span></span><br><span class="line"><span class="keyword">var</span> anotherInt = <span class="number">107</span></span><br><span class="line">swapTwoInts(&amp;someInt, &amp;anotherInt)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"someInt = <span class="subst">\(someInt)</span>, anotherInt = <span class="subst">\(anotherInt)</span>"</span>) <span class="comment">// someInt = 107, anotherInt = 3</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼ŒswapTwoInts å‡½æ•°æŒºæœ‰ç”¨ï¼Œä½†æ˜¯ç¼ºç‚¹ä¹ŸåŒæ ·æ˜æ˜¾ï¼Œå°±æ˜¯å®ƒåªèƒ½äº¤æ¢ Int çš„å€¼ï¼Œå¦‚æœæƒ³è¦äº¤æ¢ä¸¤ä¸ª Double æˆ–è€… String çš„å€¼ï¼Œä½ è¿˜å¿…é¡»é‡å†™ä¸€ä¸ªç±»ä¼¼çš„å‡½æ•°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoDoubles</span><span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> Double, <span class="number">_</span> b: <span class="keyword">inout</span> Double)</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> temp = a</span><br><span class="line">  a = b</span><br><span class="line">  b = temp</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoStrings</span><span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> String, <span class="number">_</span> b: <span class="keyword">inout</span> String)</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> temp = a</span><br><span class="line">  a = b</span><br><span class="line">  b = temp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œä¸Šé¢çš„å‡½æ•°é™¤äº†å‚æ•°ç±»å‹ä»¥å¤–ï¼Œå®ç°è¿‡ç¨‹å®Œå…¨ç›¸åŒã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸éœ€è¦ä¸€ä¸ªæ›´å®ç”¨æ›´çµæ´»çš„å‡½æ•°æ¥äº¤æ¢ä¸¤ä¸ªä»»æ„ç±»å‹çš„å€¼ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨æ³›å‹ä»£ç ã€‚</p><h2 id="Generic-functions"><a href="#Generic-functions" class="headerlink" title="Generic functions"></a>Generic functions</h2><p>æ³›å‹å‡½æ•°å¯é€‚ç”¨äºä»»æ„ç±»å‹ï¼Œä¸‹é¢çš„ swapTwoValues å‡½æ•°å°±æ˜¯ä¸Šé¢3ä¸ªå‡½æ•°çš„æ³›å‹ç‰ˆæœ¬ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoValues</span>&lt;T&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> T, <span class="number">_</span> b: <span class="keyword">inout</span> T)</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> temp = a</span><br><span class="line">  a = b </span><br><span class="line">  b = temp</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>swapTwoValuesçš„å‡½æ•°ä¸»ä½“å’Œä¹‹å‰çš„å‡½æ•°å®Œå…¨ç›¸åŒï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯åœ¨å‡½æ•°å£°æ˜çš„æ—¶å€™ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoInts</span><span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> Int, <span class="number">_</span> b: <span class="keyword">inout</span> Int)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swapTwoValues</span>&lt;T&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> T, <span class="number">_</span> b: <span class="keyword">inout</span> T)</span></span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ³›å‹å‡½æ•°çš„å£°æ˜ä½¿ç”¨äº†å ä½ç±»å‹å (è¿™é‡Œæ˜¯ T) æ¥ä»£æ›¿å®é™…ç±»å‹å (ä¾‹å¦‚ Intã€Doubleã€String)ã€‚å ä½ç±»å‹ç¬¦ T å¹¶æ²¡æœ‰æŒ‡å‡ºå…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œä½†å®ƒçº¦æŸäº† a å’Œ b å¿…é¡»æ˜¯åŒä¸€ç±»å‹ã€‚åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™ä¼šæ ¹æ®å®é™…ä¼ å…¥çš„ç±»å‹å†³å®š T çš„ç±»å‹ã€‚ç°åœ¨å‡½æ•° swapTwoValues å’Œå‰é¢çš„å‡½æ•°ä¸€æ ·è°ƒç”¨ï¼Œåªæ˜¯è¿™ä¸ªå‡½æ•°å¯ä»¥æ¥å—ä¸¤ä¸ªä»»æ„ç±»å‹çš„å‚æ•°ï¼Œåªæ˜¯è¿™ä¸¤ä¸ªå‚æ•°ç±»å‹å¿…é¡»ç›¸åŒã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> someInt = <span class="number">3</span></span><br><span class="line"><span class="keyword">var</span> anotherInt = <span class="number">107</span></span><br><span class="line">swapTwoValues(&amp;someInt, &amp;anotherInt)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"someInt = <span class="subst">\(someInt)</span>, anotherInt = <span class="subst">\(anotherInt)</span>"</span>) <span class="comment">// someInt = 107, anotherInt = 3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> someStr = <span class="string">"hello"</span></span><br><span class="line"><span class="keyword">var</span> anotherStr = <span class="string">"world"</span></span><br><span class="line">swapTwoValues(&amp;someStr, &amp;anotherStr) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">"someStr = <span class="subst">\(someStr)</span>, anotherStr = <span class="subst">\(anotherStr)</span>"</span>) <span class="comment">// someStr = world, anotherStr = hello</span></span><br></pre></td></tr></table></figure><h2 id="Generic-types"><a href="#Generic-types" class="headerlink" title="Generic types"></a>Generic types</h2><p>é™¤äº†æ³›å‹å‡½æ•°ï¼ŒSwift è¿˜å…è®¸å®šä¹‰æ³›å‹ç±»å‹ï¼Œè¿™äº›è‡ªå®šä¹‰çš„ç»“æ„ä½“ã€ç±»ã€æšä¸¾å¯ä»¥é€‚ç”¨äºä»»ä½•ç±»å‹ï¼Œç±»ä¼¼äº Array å’Œ Dictionaryã€‚ä¸‹é¢çš„ä¾‹å­æ˜¯ç¼–å†™ä¸€ä¸ªåä¸º Stack çš„æ³›å‹é›†åˆç±»å‹ï¼Œé¦–å…ˆå±•ç¤ºä¸€ä¸ªéæ³›å‹çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IntStack</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> items = [<span class="type">Int</span>]()</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">push</span><span class="params">(<span class="number">_</span> item: Int)</span></span> &#123;</span><br><span class="line">    items.append(item)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">pop</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items.removeLast()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç»“æ„ä½“å¯ä»¥è¿›è¡Œå…¥æ ˆå’Œå‡ºæ ˆçš„æ“ä½œï¼Œä½†æ˜¯åªé€‚ç”¨äº Int ç±»å‹ï¼Œå¯¹åº”çš„æ³›å‹ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stack</span>&lt;<span class="title">Element</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> items = [<span class="type">Element</span>]()</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">push</span><span class="params">(<span class="number">_</span> item: Element)</span></span> &#123;</span><br><span class="line">    items.append(item)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">pop</span><span class="params">()</span></span> -&gt; <span class="type">Element</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items.removeLast()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Stack åŸºæœ¬ä¸Šå’Œ IntStack ç›¸åŒï¼Œåªæ˜¯ç”¨å ä½ç±»å‹ Element ä»£æ›¿äº†å®é™…ç±»å‹ Intï¼Œè¿™ä¸ªç±»å‹å‚æ•°åŒ…è£¹åœ¨ç´§éšç»“æ„ä½“åçš„ä¸€å¯¹å°–æ‹¬å·é‡Œã€‚Element ä¸ºå¾…æä¾›çš„ç±»å‹å®šä¹‰äº†ä¸€ä¸ªå ä½ç¬¦ï¼Œè¿™ç§å ä½ç¬¦å¯ä»¥åœ¨ç»“æ„ä½“ä¸­éœ€è¦ç±»å‹ä¿¡æ¯çš„æ—¶å€™ä½¿ç”¨ã€‚ä½¿ç”¨æ³›å‹ç‰ˆæœ¬çš„ Stack å°±å¯ä»¥åˆ›å»º Swift ä¸­ä»»æ„æœ‰æ•ˆç±»å‹çš„æ ˆï¼Œå°±åƒ Array å’Œ Dictionary é‚£æ ·ã€‚åœ¨ Stack å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨å°–æ‹¬å·ä¸­å†™å‡º Stack ä¸­çš„æ•°æ®ç±»å‹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> stackOfStrings = <span class="type">Stack</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">stackOfStrings.push(<span class="string">"uno"</span>)</span><br><span class="line">stackOfStrings.push(<span class="string">"dos"</span>)</span><br><span class="line">stackOfStrings.push(<span class="string">"tres"</span>)</span><br><span class="line"><span class="keyword">let</span> fromTheTop = stackOfStrings.pop()</span><br></pre></td></tr></table></figure><h2 id="Extending-a-generic-type"><a href="#Extending-a-generic-type" class="headerlink" title="Extending a generic type"></a>Extending a generic type</h2><p>å½“æ‰©å±•ä¸€ä¸ªæ³›å‹ç±»å‹çš„æ—¶å€™å¹¶ä¸éœ€è¦åœ¨æ‰©å±•çš„å®šä¹‰ä¸­æä¾›ç±»å‹å‚æ•°åˆ—è¡¨ï¼ŒåŸå§‹ç±»å‹å®šä¹‰ä¸­å£°æ˜çš„ç±»å‹å‚æ•°åˆ—è¡¨åœ¨æ‰©å±•ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå¹¶ä¸”è¿™äº›æ¥è‡ªåŸå§‹ç±»å‹çš„å‚æ•°åç§°ä¼šè¢«ç”¨ä½œåŸå§‹å®šä¹‰ä¸­ç±»å‹å‚æ•°çš„å¼•ç”¨ã€‚ä¸‹é¢æ‰©å±•æ³›å‹ç±»å‹ Stackï¼Œä¸ºå…¶æ·»åŠ ä¸€ä¸ªåä¸º topItem çš„åªè¯»è®¡ç®—å±æ€§ç”¨æ¥è¿”å›æ ˆé¡¶çš„å…ƒç´ ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Stack</span> </span>&#123; <span class="comment">// å¹¶æ²¡æœ‰ç±»å‹åˆ—è¡¨</span></span><br><span class="line">  <span class="keyword">var</span> topItem: <span class="type">Element</span>? &#123;</span><br><span class="line">    <span class="keyword">return</span> items.isEmpty ? <span class="literal">nil</span> : items[items.<span class="built_in">count</span> - <span class="number">1</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ‰©å±•å¹¶æ²¡æœ‰å®šä¹‰ä¸€ä¸ªç±»å‹å‚æ•°åˆ—è¡¨ï¼ŒåŸæœ‰ Stack ä¸­çš„ç±»å‹å‚æ•°åˆ—è¡¨å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><h2 id="Type-constraints"><a href="#Type-constraints" class="headerlink" title="Type constraints"></a>Type constraints</h2><p>å¯ä»¥ç»™ä¸€ä¸ªç±»å‹å‚æ•°æ·»åŠ çº¦æŸä»¥ä½¿å¾—ç±»å‹ç¬¦åˆç‰¹å®šçš„æ¡ä»¶ã€‚åœ¨ä¸€ä¸ªç±»å‹å‚æ•°ååé¢æ”¾ç½®ä¸€ä¸ªç±»åæˆ–åè®®åï¼Œå¹¶ç”¨å†’å·è¿›è¡Œåˆ†éš”ï¼Œæ¥å®šä¹‰ç±»å‹çº¦æŸï¼Œå®ƒä»¬å°†æˆä¸ºç±»å‹å‚æ•°åˆ—è¡¨çš„ä¸€éƒ¨åˆ†ã€‚å¯¹æ³›å‹å‡½æ•°æ·»åŠ ç±»å‹çº¦æŸçš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">someFunction</span>&lt;T: SomeClass, U: SomeProtocol&gt;<span class="params">(someT: T, someU: U)</span></span> &#123;</span><br><span class="line">  <span class="comment">// æ³›å‹å‡½æ•°çš„å®ç°éƒ¨åˆ†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªç±»å‹å‚æ•°ã€‚ç¬¬ä¸€ä¸ªç±»å‹å‚æ•° æ˜¯Tï¼Œæœ‰ä¸€ä¸ªè¦æ±‚ T å¿…é¡»æ˜¯ SomeClass å­ç±»çš„ç±»å‹çº¦æŸï¼›ç¬¬äºŒä¸ªç±»å‹å‚æ•°æ˜¯Uï¼Œæœ‰ä¸€ä¸ªè¦æ±‚ U å¿…é¡»ç¬¦åˆ SomeProtocol åè®®çš„ç±»å‹çº¦æŸã€‚</p><h2 id="Associated-type"><a href="#Associated-type" class="headerlink" title="Associated type"></a>Associated type</h2><p>å½“å®šä¹‰ä¸€ä¸ªåè®®æ—¶ï¼Œæœ‰çš„æ—¶å€™å£°æ˜ä¸€ä¸ªæˆ–å¤šä¸ªå…³è”ç±»å‹ä½œä¸ºåè®®å®šä¹‰çš„ä¸€éƒ¨åˆ†æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œä¸€ä¸ªå…³è”ç±»å‹ä½œä¸ºåè®®çš„ä¸€éƒ¨åˆ†ï¼Œç»™å®šäº†ç±»å‹çš„ä¸€ä¸ªå ä½åä½œç”¨äºå…³è”ç±»å‹ä¸Šï¼Œå®é™…ç±»å‹åœ¨åè®®è¢«å®ç°å‰æ˜¯ä¸éœ€è¦æŒ‡å®šçš„ã€‚ä½¿ç”¨ typealias æŒ‡å®šå…³è”ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Container</span> </span>&#123;</span><br><span class="line">  associatedtype <span class="type">ItemType</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">append</span><span class="params">(item: ItemType)</span></span></span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">Int</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">  <span class="keyword">subscript</span>(i: <span class="type">Int</span>) -&gt; <span class="type">ItemType</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Container å®šä¹‰äº†ä¸€ä¸ªå®¹å™¨å¿…é¡»æ»¡è¶³çš„3ä¸ªè¦æ±‚ï¼š</p><ul><li>å¿…é¡»å¯ä»¥é€šè¿‡ append æ–¹æ³•æ·»åŠ ä¸€ä¸ªæ–°çš„ item åˆ°å®¹å™¨ä¸­</li><li>å¿…é¡»å¯ä»¥é€šè¿‡ä½¿ç”¨ count å±æ€§è·å–å®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•°</li><li>å¿…é¡»å¯ä»¥é€šè¿‡ç´¢å¼•è·å–å®¹å™¨ä¸­çš„å„ä¸ªå…ƒç´ </li></ul><p>è¿™é‡Œè®©æ—©å…ˆçš„ IntStack ç±»å‹éµå®ˆ Container åè®®ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IntStack</span>: <span class="title">Container</span> </span>&#123;</span><br><span class="line">  <span class="comment">// IntStackçš„åŸå§‹å®ç°</span></span><br><span class="line">  <span class="keyword">var</span> items = [<span class="type">Int</span>]()</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">push</span><span class="params">(<span class="number">_</span> item: Int)</span></span> &#123;</span><br><span class="line">    items.append(item)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">pop</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items.removeLast()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// éµå®ˆContaineråè®®çš„å®ç°</span></span><br><span class="line">  <span class="keyword">typealias</span> <span class="type">ItemType</span> = <span class="type">Int</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">append</span><span class="params">(item: Int)</span></span>&#123;</span><br><span class="line">    <span class="keyword">self</span>.push(item)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items.<span class="built_in">count</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">subscript</span>(i: <span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items[i]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç”Ÿæˆéµå¾ª Container åè®®çš„æ³›å‹ç‰ˆæœ¬çš„ Stack ç±»å‹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stack</span>&lt;<span class="title">T</span>&gt;: <span class="title">Container</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Stackçš„åŸå§‹å®ç°</span></span><br><span class="line">  <span class="keyword">var</span> items = [<span class="type">T</span>]()</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">push</span><span class="params">(<span class="number">_</span> item: T)</span></span> &#123;</span><br><span class="line">    items.append(item)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">pop</span><span class="params">()</span></span> -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items.removeLast()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// éµå®ˆContaineråè®®çš„å®ç°</span></span><br><span class="line">  <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">append</span><span class="params">(item: T)</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.push(item)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items.<span class="built_in">count</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">subscript</span>(i: <span class="type">Int</span>) -&gt; <span class="type">T</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items[i]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Generic-where-clauses"><a href="#Generic-where-clauses" class="headerlink" title="Generic where clauses"></a>Generic where clauses</h2><p>å¯¹å…³è”ç±»å‹å®šä¹‰çº¦æŸæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œä½ å¯ä»¥åœ¨å‚æ•°åˆ—è¡¨ä¸­é€šè¿‡ where è¯­å¥å®šä¹‰å‚æ•°çš„çº¦æŸã€‚ä¸€ä¸ª where è¯­å¥å¯ä»¥ä½¿ä¸€ä¸ªå…³è”ç±»å‹éµå®ˆä¸€ä¸ªç‰¹å®šçš„åè®®ã€‚å¯ä»¥å†™ä¸€ä¸ª where è¯­å¥ï¼Œç´§è·Ÿåœ¨ç±»å‹å‚æ•°åˆ—è¡¨çš„åé¢ï¼Œwhere è¯­å¥åè·Ÿä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹å…³è”ç±»å‹çš„çº¦æŸã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">allItemsMatch</span>&lt;C1: Container, C2: Container&gt;<span class="params">(someContainer: C1, anotherContainer: C2)</span></span> -&gt; <span class="type">Bool</span> <span class="keyword">where</span> <span class="type">C1</span>.<span class="type">ItemType</span> == <span class="type">C2</span>.<span class="type">ItemType</span>, <span class="type">C1</span>.<span class="type">ItemType</span>: <span class="type">Equatable</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> someContainer.<span class="built_in">count</span> != anotherContainer.<span class="built_in">count</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;someContainer.<span class="built_in">count</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> someContainer[i] != anotherContainer[i] &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<em>The Swift Programming Language</em></p>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Enumerations in Swift</title>
      <link href="/cactus-light/2016/11/27/Enumerations-in-Swift/"/>
      <url>/cactus-light/2016/11/27/Enumerations-in-Swift/</url>
      <content type="html"><![CDATA[<p>æšä¸¾ä¸ºä¸€ç»„ç›¸å…³çš„å€¼å®šä¹‰äº†ä¸€ä¸ªå…±åŒçš„ç±»å‹ï¼Œä»¥ä¾¿åœ¨ä»£ç ä¸­ä»¥ç±»å‹å®‰å…¨çš„æ–¹å¼ä½¿ç”¨è¿™äº›å€¼ã€‚åœ¨ C è¯­è¨€ä¸­ï¼Œæšä¸¾ä¼šä¸ºæšä¸¾æˆå‘˜åˆ†é…ä¸€ä¸ªå¯¹åº”çš„æ•´å½¢å€¼ã€‚Swift ä¸­çš„æšä¸¾æ›´åŠ çµæ´»ï¼Œå¯ä»¥ä¸å¿…ä¸ºæ¯ä¸€ä¸ªæˆå‘˜æä¾›å¯¹åº”çš„å€¼ã€‚åœ¨ Swift ä¸­è¿™ä¸ªå€¼è¢«ç§°ä¸º<strong>åŸå§‹å€¼ (Raw Value)</strong>ï¼ŒåŸå§‹å€¼çš„ç±»å‹å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ï¼Œæ•´å½¢å€¼æˆ–æµ®ç‚¹æ•°ã€‚ä¸æšä¸¾æœ‰å…³çš„å†…å®¹ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>åŸºæœ¬è¯­æ³• (Basics)</li><li>åŸå§‹å€¼ (Raw values)</li><li>å…³è”å€¼ (Associated values)</li><li>æ²¡æœ‰æˆå‘˜çš„æšä¸¾ (Case-less enumerations)</li><li>é€’å½’æšä¸¾ (Recursive enumerations)</li></ul><p>ä¸»è¦å‚è€ƒäº† <em>Swift Apprentice</em> å’Œ <em>The Swift Programming Language</em>ã€‚</p><a id="more"></a><h2 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h2><p>å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»å‹å’Œå®šä¹‰ç±»å’Œç»“æ„ä½“ç±»ä¼¼ï¼Œåªæ˜¯ä½¿ç”¨ <strong>enum</strong> å…³é”®å­—ï¼Œç„¶ååœ¨æšä¸¾æˆå‘˜å‰æ ‡ä¸Š <strong>case</strong> å…³é”®å­—ã€‚å‡å¦‚è¦å†™ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°æ¥æ”¶ä¸€ä¸ªç”¨æ¥è¡¨ç¤ºæœˆä»½çš„å­—ç¬¦ä¸²ï¼Œè¾“å‡ºå¯¹åº”çš„å­¦æœŸï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„å®ç°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> months = [<span class="string">"January"</span>, <span class="string">"February"</span>, <span class="string">"March"</span>, <span class="string">"April"</span>, <span class="string">"May"</span>, <span class="string">"June"</span>, <span class="string">"July"</span>, <span class="string">"August"</span>,<span class="string">"September"</span>, <span class="string">"October"</span>, <span class="string">"November"</span>, <span class="string">"December"</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">semester</span><span class="params">(<span class="keyword">for</span> month: String)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> month &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"January"</span>, <span class="string">"February"</span>, <span class="string">"March"</span>, <span class="string">"April"</span>, <span class="string">"May"</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Spring"</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">"August"</span>, <span class="string">"September"</span>, <span class="string">"October"</span>, <span class="string">"November"</span>, <span class="string">"December"</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Autumn"</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Not in the school year"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">semester(<span class="keyword">for</span>: <span class="string">"April"</span>) <span class="comment">// Spring</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å¯ä»¥å®ç°éœ€è¦çš„åŠŸèƒ½ï¼Œä½†æ˜¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™å®¹æ˜“å‡ºç°é”™è¯¯ï¼Œè€Œè¿™ç§é”™è¯¯ä¼šä½¿ç»“æœä¸æ­£ç¡®ã€‚æ‰€ä»¥å°±å¯ä»¥æ”¹ç”¨ä¸€ä¸ªæšä¸¾ç±»å‹æ¥å®ç°ä¸Šé¢çš„å‡½æ•°ï¼Œè¿™æ ·è¾“å…¥çš„æ—¶å€™ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥å’Œè‡ªåŠ¨è¡¥å…¨ï¼Œå¯ä»¥é¿å…é”™è¯¯çš„äº§ç”Ÿã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Month</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> january, february, march, april, may, june, july, august, september, october, november, december</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é‡å†™semesterå‡½æ•°ï¼Œå‚æ•°ç±»å‹ä¸ºMonthè€Œä¸å†æ˜¯String</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">semester</span><span class="params">(<span class="keyword">for</span> month: Month)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> month &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="type">Month</span>.january, <span class="type">Month</span>.february, <span class="type">Month</span>.march, <span class="type">Month</span>.april, <span class="type">Month</span>.may:</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"Spring"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="type">Month</span>.august, <span class="type">Month</span>.september, <span class="type">Month</span>.october, <span class="type">Month</span>.november, <span class="type">Month</span>.december:</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"Autumn"</span></span><br><span class="line">  <span class="keyword">default</span>: </span><br><span class="line">  <span class="keyword">return</span> <span class="string">"Not in the school year"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸º Swift ä¼šæ ¹æ®å‚æ•°ç±»å‹è¿›è¡Œæ¨æ–­ï¼Œæ‰€ä»¥ semester å‡½æ•°è¿˜å¯ä»¥å†™æˆä¸‹é¢çš„æ ·å­ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">semester</span><span class="params">(<span class="keyword">for</span> month: Month)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> month &#123;</span><br><span class="line">    <span class="keyword">case</span> .january, .february, .march, .april, .may:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Spring"</span></span><br><span class="line">    <span class="keyword">case</span> .august, .september, .october, .november, .december:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Autumn"</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Not in the school year"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Switch è¯­å¥è¦æ±‚æ˜¯å®Œå¤‡çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€åˆ—çš„ case ä¸­å¿…é¡»åŒ…æ‹¬æ‰€æœ‰å¯èƒ½çš„æƒ…å†µï¼Œå¯¹äºä¸éœ€è¦å¤„ç†çš„æƒ…å†µï¼Œå¯ä»¥æ”¾åœ¨ default ä¸­ã€‚æ‰€ä»¥å½“ month çš„ç±»å‹æ˜¯ String æ—¶ï¼Œä½ å°±å¿…é¡»è¦ä½¿ç”¨ defaultï¼Œå› ä¸ºä½ ä¸å¯èƒ½åˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„å­—ç¬¦ä¸²ã€‚è€Œä½¿ç”¨ Month ç±»å‹ä»¥åï¼Œå°±å¯ä»¥åœ¨ä¸‹é¢çš„ä»£ç ä¸­å®‰å…¨çš„ç§»é™¤ defaultã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">semester</span><span class="params">(<span class="keyword">for</span> month: Month)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> month &#123;</span><br><span class="line">    <span class="keyword">case</span> .january, .february, .march, .april, .may:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"String"</span></span><br><span class="line">    <span class="keyword">case</span> .june, .july:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Summer"</span></span><br><span class="line">    <span class="keyword">case</span> .august, .september, .october, .november, .december:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Autumn"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Swift çš„æšä¸¾ç±»å‹ä¸­è¿˜å¯ä»¥å®šä¹‰è®¡ç®—å±æ€§å’Œæ–¹æ³•ï¼Œæ–¹æ³•æ—¢å¯ä»¥æ˜¯æˆå‘˜æ–¹æ³•ä¹Ÿå¯ä»¥æ˜¯ç±»å‹æ–¹æ³•ï¼Œä½†æ˜¯ä¸å¯ä»¥å®šä¹‰å­˜å‚¨å±æ€§ã€‚æ¯”å¦‚ä¸Šé¢çš„å‡½æ•°æˆ‘ä»¬å¯ä»¥ä½œä¸ºè®¡ç®—å±æ€§ï¼Œå†™åœ¨ Month å†…éƒ¨ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Month</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> january, february, march, april, may, june, july, august, september, october, november, december</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> semester: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> .january, .february, .march, .april, .may:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"String"</span></span><br><span class="line">      <span class="keyword">case</span> .june, .july:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Summer"</span></span><br><span class="line">      <span class="keyword">case</span> .august, .september, .october, .november, .december:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Autumn"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> may = <span class="type">Month</span>.may</span><br><span class="line">may.semester <span class="comment">// Spring</span></span><br></pre></td></tr></table></figure><h2 id="Raw-values"><a href="#Raw-values" class="headerlink" title="Raw values"></a>Raw values</h2><p>Swift ä¸ä¼šè‡ªåŠ¨ä¸ºæšä¸¾ä¸­çš„æˆå‘˜è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„æ•´å‹å€¼ï¼Œä½†æ˜¯ä»ç„¶å…è®¸æ ¹æ®éœ€è¦ä¸ºå„ä¸ªæˆå‘˜æŒ‡å®šä¸€ä¸ªå€¼è€Œä¸”å€¼çš„ç±»å‹ä¸ä»…ä»…å±€é™äºæ•´å½¢ã€‚å‡å¦‚è¦ä¸º Month ä¸­çš„æˆå‘˜æŒ‡å®šä¸€ä¸ªå¯¹åº”çš„æ•°å­—ä¸ä¹‹å¯¹åº”ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­å¥ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Month</span>: <span class="title">Int</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> january = <span class="number">1</span>, february = <span class="number">2</span>, march = <span class="number">3</span>, april = <span class="number">4</span>, may = <span class="number">5</span>, june = <span class="number">6</span>, july = <span class="number">7</span>, august = <span class="number">8</span>, september = <span class="number">9</span>, october = <span class="number">10</span>, november = <span class="number">11</span>, december = <span class="number">12</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ C è¯­è¨€ç±»ä¼¼ï¼Œå¹¶ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªæˆå‘˜éƒ½æŒ‡å®šä¸€ä¸ªå€¼ï¼Œåé¢çš„å€¼ä¼šæ ¹æ®å‰é¢çš„å€¼é€’å¢ã€‚æ‰€ä»¥ä¸Šé¢çš„ä»£ç ä¸ä¸‹é¢çš„ç­‰ä»·ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Month</span>: <span class="title">Int</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> january = <span class="number">1</span>, february, march, april, may, june, july, august, september, october, november, december</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‹¥è¦è®¿é—®æˆå‘˜å¯¹åº”çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ <strong>rawValue</strong> å±æ€§ï¼Œæ¯”å¦‚ä¸‹é¢çš„å‡½æ•°å¯ä»¥ç”¨æ¥è®¡ç®—æœ¬å¹´åº¦è¿˜å‰©ä¸‹å‡ ä¸ªæœˆï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">monthUntilWinterBreak</span><span class="params">(from month: Month)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="type">Month</span>.december.rawValue - month.rawValue</span><br><span class="line">&#125;</span><br><span class="line">monthUntilWinterBreak(from: .april) <span class="comment">// 8</span></span><br></pre></td></tr></table></figure><p>æšä¸¾ä¸­çš„æˆå‘˜è¿˜å¯ä»¥ä½¿ç”¨ rawValue è¿›è¡Œåˆå§‹åŒ–ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fifthMonth = <span class="type">Month</span>(rawValue: <span class="number">5</span>)! <span class="comment">// ä½¿ç”¨ rawValue åˆå§‹åŒ–è¿”å›çš„æ˜¯ä¸€ä¸ªå¯é€‰å€¼</span></span><br><span class="line">monthUntilWinterBreak(from: fifthMonth) <span class="comment">// 7</span></span><br></pre></td></tr></table></figure><h3 id="String-raw-values"><a href="#String-raw-values" class="headerlink" title="String raw values"></a>String raw values</h3><p>æšä¸¾ç±»å‹çš„ rawValue è¿˜å¯ä»¥æŒ‡å®šä¸º Stringï¼Œå‡å¦‚æ²¡æœ‰ä¸ºæˆå‘˜æŒ‡å®šç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œé»˜è®¤ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸æˆå‘˜çš„åå­—ç›¸åŒã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Icon</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> music</span><br><span class="line">  <span class="keyword">case</span> sports</span><br><span class="line">  <span class="keyword">case</span> weather</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">Icon</span>.music.rawValue <span class="comment">// "music"</span></span><br></pre></td></tr></table></figure><h3 id="Unordered-raw-values"><a href="#Unordered-raw-values" class="headerlink" title="Unordered raw values"></a>Unordered raw values</h3><p>rawValue ä¸è¦æ±‚æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥æ ¹æ®éœ€è¦å®šä¹‰ rawValue çš„å€¼ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Coin</span>: <span class="title">Int</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> penny = <span class="number">1</span></span><br><span class="line">  <span class="keyword">case</span> nickel = <span class="number">5</span></span><br><span class="line">  <span class="keyword">case</span> dime = <span class="number">10</span></span><br><span class="line">  <span class="keyword">case</span> quarter = <span class="number">25</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> coin = <span class="type">Coin</span>.quarter</span><br><span class="line">coin.rawValue <span class="comment">// 25</span></span><br></pre></td></tr></table></figure><h2 id="Associated-values"><a href="#Associated-values" class="headerlink" title="Associated values"></a>Associated values</h2><p>é™¤äº†å¯ä»¥ä¸ºæšä¸¾æˆå‘˜å®šä¹‰åŸå§‹å€¼ï¼Œè¿˜å¯ä»¥å®šä¹‰å…³è”å€¼ã€‚è¿™æ ·å°±å¯ä»¥ä¸ºæˆå‘˜å­˜å‚¨é¢å¤–çš„è‡ªå®šä¹‰ä¿¡æ¯ï¼Œå¹¶ä¸”æ¯æ¬¡åœ¨ä»£ç ä¸­ä½¿ç”¨è¯¥æšä¸¾æˆå‘˜æ—¶ï¼Œè¿˜å¯ä»¥ä¿®æ”¹è¿™ä¸ªå…³è”å€¼ã€‚å…³è”å€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œè€Œä¸”å„ä¸ªæˆå‘˜ä¹‹é—´çš„å…³è”å€¼ç±»å‹å¯ä»¥äº’ä¸ç›¸åŒã€‚å‡å¦‚ä¸€ä¸ªåº“å­˜è·Ÿè¸ªç³»ç»Ÿéœ€è¦æ”¯æŒä¸¤ç§ä¸åŒç±»å‹çš„æ¡å½¢ç æ¥è·Ÿè¸ªå•†å“ï¼Œæœ‰äº›å•†å“ä¸Šä½¿ç”¨æ•°å­—æ ‡è®°çš„ä¸€ç»´æ¡å½¢ç ï¼Œæœ‰äº›å•†å“ä½¿ç”¨æ ‡æœ‰ QR ç æ ¼å¼çš„äºŒç»´ç ã€‚æ¯ä¸ªä¸€ç»´æ¡å½¢ç éƒ½ç”±4ä¸ªå­—æ®µç»„æˆï¼Œåˆ†åˆ«è¡¨ç¤ºæ•°å­—ç³»ç»Ÿã€å‚å•†ä»£ç ã€äº§å“ä»£ç å’Œæ£€æŸ¥ä½ã€‚æ‰€ä»¥æšä¸¾ç±»å‹å¯ä»¥å®šä¹‰ä¸ºå¦‚ä¸‹æ ¼å¼ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Barcode</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> upc(<span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>, <span class="type">Int</span>) <span class="comment">// upcçš„å…³è”å€¼ç±»å‹ä¸ºåŒ…å«4ä¸ªIntçš„å…ƒç»„</span></span><br><span class="line">  <span class="keyword">case</span> qrCode(<span class="type">String</span>) <span class="comment">// qrCodeçš„å…³è”å€¼ç±»å‹ä¸ºString</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å®šä¹‰æ²¡æœ‰æä¾›ä»»ä½•å…³è”å€¼ï¼Œå®ƒåªæ˜¯å®šä¹‰äº†æšä¸¾ä¸­å„ä¸ªæˆå‘˜çš„å…³è”å€¼çš„ç±»å‹ã€‚ç„¶åå¯ä»¥ä½¿ç”¨ä»»æ„ä¸€ç§æ¡å½¢ç ç±»å‹åˆ›å»ºæ–°çš„æ¡ç ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> productBarcode = <span class="type">Barcode</span>.upc(<span class="number">8</span>, <span class="number">85909</span>, <span class="number">51226</span>, <span class="number">3</span>) <span class="comment">// åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œè®¾ç½®å…¶ç±»å‹å’Œå…³è”å€¼</span></span><br><span class="line">productBarcode = .qrCode(<span class="string">"ABCDEFG"</span>) <span class="comment">// åŒä¸€ä¸ªå•†å“è¿˜å¯ä»¥åˆ†é…ä¸€ä¸ªä¸åŒç±»å‹çš„äºŒç»´ç </span></span><br></pre></td></tr></table></figure><p>åŸå§‹çš„ Barcode.upc åŠå…¶å…³è”å€¼è¢«æ–°çš„ Barcode.qrCode åŠå…¶å…³è”å€¼æ›¿ä»£ã€‚Barcode ç±»å‹çš„å˜é‡æˆ–å¸¸é‡å¯ä»¥å­˜å‚¨ä¸€ä¸ª .upc æˆ–è€… .qrCode ä½†æ˜¯åŒä¸€æ—¶é—´åªèƒ½å­˜å‚¨ä¸¤ä¸ªå€¼ä¸­çš„ä¸€ä¸ªã€‚å¯ä»¥ä½¿ç”¨ switch è¯­å¥æ¥æ£€æŸ¥ä¸åŒçš„æ¡ç ç±»å‹ï¼Œè¿™æ—¶å…³è”å€¼ä¹Ÿå¯ä»¥ä½¿ç”¨ let æˆ– var æå–å‡ºæ¥ä½¿ç”¨ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> productBarcode &#123;</span><br><span class="line">  <span class="keyword">case</span> .upc(<span class="keyword">let</span> numberSystem, <span class="keyword">let</span> manufacturer, <span class="keyword">let</span> product, <span class="keyword">let</span> check):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"UPC: <span class="subst">\(numberSystem)</span>, <span class="subst">\(manufacturer)</span>, <span class="subst">\(product)</span>, <span class="subst">\(check)</span>"</span>)</span><br><span class="line">  <span class="keyword">case</span> .qrCode(<span class="keyword">let</span> productCode):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"QR code: <span class="subst">\(productCode)</span>"</span>)</span><br><span class="line">&#125; <span class="comment">// æ‰“å° "QR code: ABCDEFG"</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€ä¸ªæšä¸¾æˆå‘˜çš„æ‰€æœ‰å…³è”å€¼éƒ½è¢«æå–ä¸ºå¸¸é‡æˆ–è€…å˜é‡ï¼Œé‚£å°±å¯ä»¥åªåœ¨æˆå‘˜åç§°å‰æ ‡æ³¨ä¸€ä¸ª let æˆ–è€… varã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> productBarcode &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">let</span> .upc(numberSystem, manufacturer, product, check):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"UPC: <span class="subst">\(numberSystem)</span>, <span class="subst">\(manufacturer)</span>, <span class="subst">\(product)</span>, <span class="subst">\(check)</span>"</span>)</span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">let</span> .qrCode(productCode):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"QR code: <span class="subst">\(productCode)</span>"</span>)</span><br><span class="line">&#125; <span class="comment">// æ‰“å° "QR code: ABCDEFG"</span></span><br></pre></td></tr></table></figure><h2 id="Case-less-enumerations"><a href="#Case-less-enumerations" class="headerlink" title="Case-less enumerations"></a>Case-less enumerations</h2><p>åœ¨å°†ç»“æ„ä½“çš„æ—¶å€™æ›¾ç»è¯´è¿‡å¯ä»¥é€šè¿‡å°†æŸä¸€ç±»çš„æ–¹æ³•å®šä¹‰ä¸ºç±»å‹æ–¹æ³•æ”¾åœ¨ç»“æ„ä½“ä¸­ï¼Œäº§ç”Ÿç±»ä¼¼äºå‘½åç©ºé—´çš„ä½œç”¨ã€‚æ¯”å¦‚è®¡ç®—é˜¶ä¹˜çš„æ–¹æ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Math</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">factorial</span><span class="params">(of number: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span>...number).<span class="built_in">reduce</span>(<span class="number">1</span>, *)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> factorial = <span class="type">Math</span>.factorial(of: <span class="number">6</span>) <span class="comment">// 720</span></span><br><span class="line"><span class="keyword">let</span> math = <span class="type">Math</span>()</span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªé—®é¢˜å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†å°±æ˜¯ç»“æ„ä½“ Math æ˜¯å¯ä»¥å®ä¾‹åŒ–çš„ï¼Œä½†æ˜¯ Math ä¸­ä»…æœ‰ä¸€ä¸ªç±»å‹æ–¹æ³•ï¼Œæ‰€ä»¥å®ä¾‹åŒ–æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ›´å¥½çš„å®ç°æ˜¯å°† Math ç”±ç»“æ„ä½“ç±»å‹æ”¹ä¸ºæšä¸¾ç±»å‹ï¼Œè¿™æ ·åœ¨æ²¡æœ‰ä»»ä½•æˆå‘˜å˜é‡çš„æƒ…å†µä¸‹å¯¹æšä¸¾ç±»å‹è¿›è¡Œå®ä¾‹åŒ–ä¼šäº§ç”Ÿé”™è¯¯ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Math</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">factorial</span><span class="params">(of number: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span>...number).<span class="built_in">reduce</span>(<span class="number">1</span>, *)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> factorial = <span class="type">Math</span>.factorial(of: <span class="number">6</span>) <span class="comment">// 720</span></span><br><span class="line"><span class="keyword">let</span> math = <span class="type">Math</span>() <span class="comment">// error</span></span><br></pre></td></tr></table></figure><h2 id="Recursive-enumerations"><a href="#Recursive-enumerations" class="headerlink" title="Recursive enumerations"></a>Recursive enumerations</h2><p>é€’å½’æšä¸¾æ˜¯ä¸€ç§æšä¸¾ç±»å‹ï¼Œå®ƒæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæšä¸¾æˆå‘˜ä½¿ç”¨è¯¥æšä¸¾ç±»å‹çš„å®ä¾‹ä½œä¸ºå…³è”å€¼ï¼Œä½¿ç”¨é€’å½’æšä¸¾æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ’å…¥ä¸€ä¸ªé—´æ¥å±‚ï¼Œå¯ä»¥åœ¨æšä¸¾æˆå‘˜å‰åŠ ä¸Š <strong>indirect</strong> æ¥è¡¨ç¤ºè¯¥æˆå‘˜å¯é€’å½’ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæšä¸¾ç±»å‹å­˜å‚¨äº†ç®€å•çš„ç®—æœ¯è¡¨è¾¾å¼ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ArithmeticExpression</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> number(<span class="type">Int</span>)</span><br><span class="line">  <span class="keyword">indirect</span> <span class="keyword">case</span> addition(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">  <span class="keyword">indirect</span> <span class="keyword">case</span> multiplication(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨æšä¸¾ç±»å‹å¼€å¤´åŠ ä¸Š indirect å…³é”®å­—æ¥è¡¨ç¤ºå®ƒçš„æ‰€æœ‰æˆå‘˜éƒ½æ˜¯å¯é€’å½’çš„ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">indirect</span> <span class="class"><span class="keyword">enum</span> <span class="title">ArithmeticExpression</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> number(<span class="type">Int</span>)</span><br><span class="line">  <span class="keyword">case</span> addition(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">  <span class="keyword">case</span> multiplication(<span class="type">ArithmeticExpression</span>, <span class="type">ArithmeticExpression</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å®šä¹‰çš„æšä¸¾ç±»å‹å¯ä»¥å­˜å‚¨3ç§è¡¨è¾¾å¼ï¼šçº¯æ•°å­—ã€ä¸¤ä¸ªè¡¨è¾¾å¼æ±‚å’Œã€ä¸¤ä¸ªè¡¨è¾¾å¼æ±‚ç§¯ã€‚æšä¸¾æˆå‘˜ addition å’Œ multiplication çš„å…³è”å€¼ä¹Ÿæ˜¯ç®—æœ¯è¡¨è¾¾å¼ï¼Œè¿™äº›å…³è”å€¼ä½¿å¾—åµŒå¥—è¡¨è¾¾å¼æˆä¸ºå¯èƒ½ã€‚ä¾‹å¦‚è¡¨è¾¾å¼ (5 + 4) * 2ï¼Œä¹˜å·å·¦è¾¹æ˜¯ä¸ªè¡¨è¾¾å¼ï¼Œå³è¾¹æ˜¯çº¯æ•°å­—ã€‚ä¸‹é¢ä½¿ç”¨ ArithmeticExpression è¿™ä¸ªé€’å½’æšä¸¾åˆ›å»ºè¡¨è¾¾å¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> five = <span class="type">ArithmeticExpression</span>.number(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">let</span> four = <span class="type">ArithmeticExpression</span>.number(<span class="number">4</span>)</span><br><span class="line"><span class="keyword">let</span> sum = <span class="type">ArithmeticExpression</span>.addition(five, four)</span><br><span class="line"><span class="keyword">let</span> product = <span class="type">ArithmeticExpression</span>.multiplication(sum, <span class="type">ArithmeticExpression</span>.number(<span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>è¦æ“ä½œå…·æœ‰é€’å½’æ€§è´¨çš„æ•°æ®ç»“æ„ï¼Œä½¿ç”¨é€’å½’å‡½æ•°æ˜¯ä¸€ç§ç›´æˆªäº†å½“çš„æ–¹å¼ï¼Œä¾‹å¦‚ä¸‹é¢ä¸€ä¸ªå¯¹ç®—æœ¯è¡¨è¾¾å¼æ±‚å€¼çš„å‡½æ•°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">evaluate</span><span class="params">(<span class="number">_</span> expression: ArithmeticExpression)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> expression &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .number(value):</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .addition(<span class="keyword">left</span>, <span class="keyword">right</span>):</span><br><span class="line">    <span class="keyword">return</span> evaluate(<span class="keyword">left</span>) + evaluate(<span class="keyword">right</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .multiplication(<span class="keyword">left</span>, <span class="keyword">right</span>):</span><br><span class="line">    <span class="keyword">return</span> evaluate(<span class="keyword">left</span>) * evaluate(<span class="keyword">right</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span> (evaluate(product))</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°é‡åˆ°çº¯æ•°å­—å°±ç›´æ¥è¿”å›æ•°å­—çš„å€¼ï¼Œå¦‚æœé‡åˆ°åŠ æ³•å’Œä¹˜æ³•å°±ä¼šé€’å½’è®¡ç®—å‡ºè¡¨è¾¾å¼çš„å€¼ã€‚</p>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Closures in Swift</title>
      <link href="/cactus-light/2016/11/25/Closures-in-Swift/"/>
      <url>/cactus-light/2016/11/25/Closures-in-Swift/</url>
      <content type="html"><![CDATA[<p>é—­åŒ…æ˜¯ Swift ä¸­çš„é‡è¦è¯­æ³•ï¼Œä¸ Objective-C ä¸­çš„ block ç±»ä¼¼ï¼Œæœ¬æ–‡ä¸»è¦æ€»ç»“ Swift ä¸­é—­åŒ…çš„åŸºæœ¬ç”¨æ³•ã€‚ä¸»è¦å‚è€ƒäº† <em>Swift Apprentice</em> å’Œ <em>The Swift Programming Language</em>. ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š</p><ul><li>åŸºæœ¬è¯­æ³• (Basics)</li><li>ç®€åŒ–è§„åˆ™ (Short syntax)</li><li>æ— è¿”å›å€¼çš„é—­åŒ… (Closures without return value)</li><li>é—­åŒ…çš„å€¼æ•è· (Capturing from enclosing scope)</li><li>é€ƒé€¸é—­åŒ… (Escaping closures)</li><li>è‡ªåŠ¨é—­åŒ… (Auto closures)</li></ul><a id="more"></a><h2 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h2><p><strong>é—­åŒ… (closure)</strong> æ˜¯ä¸€ç§æ²¡æœ‰åå­—çš„å‡½æ•°ï¼Œå°è£…äº†ä¸€æ®µä»£ç å—ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ“ä½œã€‚ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºâ€é—­åŒ…â€æ˜¯å› ä¸ºå®ƒæœ‰ä¸€ä¸ªé‡è¦çš„ç‰¹æ€§ï¼Œå¯ä»¥æ•è·ä½œç”¨åŸŸå†…çš„å˜é‡å¹¶åœ¨é—­åŒ…å†…è¿›è¡Œè®¿é—®ã€‚å› ä¸ºé—­åŒ…æ˜¯ä¸€ä¸ªæ²¡æœ‰åå­—çš„å‡½æ•°ï¼Œé‚£ä¹ˆè¦ä½¿ç”¨ä¸€ä¸ªé—­åŒ…å¯ä»¥é€šè¿‡å°†é—­åŒ…èµ‹ç»™ä¸€ä¸ªå¸¸é‡æˆ–è€…å˜é‡ï¼Œç„¶åä½¿ç”¨å¸¸é‡æˆ–è€…å˜é‡çš„åå­—è¿›è¡Œè®¿é—®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> multiplyClosure: (<span class="type">Int</span>, <span class="type">Int</span>) -&gt; <span class="type">Int</span> <span class="comment">// multiplyClosure æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œæ¥æ”¶ä¸¤ä¸ª Int å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª Int å€¼</span></span><br><span class="line">multiplyClosure = &#123; (a: <span class="type">Int</span>, b: <span class="type">Int</span>) -&gt; <span class="type">Int</span> <span class="keyword">in</span> <span class="comment">// ç»™ multiplyClosure èµ‹å€¼ï¼Œå…³é”®å­— in ç”¨äºåŒºåˆ†ç±»å‹å’Œå®ç°</span></span><br><span class="line">  <span class="keyword">return</span> a * b</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result = multiplyClosure(<span class="number">4</span>, <span class="number">2</span>) <span class="comment">// result = 8</span></span><br></pre></td></tr></table></figure><h2 id="Short-syntax"><a href="#Short-syntax" class="headerlink" title="Short syntax"></a>Short syntax</h2><p>åŒå‡½æ•°ç›¸æ¯”ï¼Œé—­åŒ…åœ¨è®¾è®¡çš„æ—¶å€™å°±è¦æ±‚æ›´åŠ ç®€å•ã€è½»é‡ï¼Œæ‰€ä»¥ä¹Ÿå°±æœ‰å¾ˆå¤šè¯­æ³•ç³–å¯ä»¥æŠŠé—­åŒ…ä¹¦å†™çš„æ›´åŠ ç®€å•ã€‚</p><ul><li>å‡å¦‚é—­åŒ…ä¸­åªåŒ…æ‹¬ä¸€æ¡ return è¯­å¥ï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥ return å…³é”®å­—ï¼Œæ‰€ä»¥ä¸Šé¢çš„ multiplyClosure å¯ä»¥æ”¹ä¸ºï¼š</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">multiplyClosure = &#123; (a: <span class="type">Int</span>, b: <span class="type">Int</span>) -&gt; <span class="type">Int</span> <span class="keyword">in</span></span><br><span class="line">  a * b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡ Swift çš„ç±»å‹æ¨æ–­ï¼Œåœ¨é—­åŒ…çš„å®ç°éƒ¨åˆ†å¯ä»¥çœç•¥é—­åŒ…ä¸­çš„å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹ï¼Œæ‰€ä»¥ multiplyClosure å¯ä»¥æ”¹ä¸ºï¼š</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> multiplyClosure: (<span class="type">Int</span>, <span class="type">Int</span>) -&gt; <span class="type">Int</span></span><br><span class="line">multiplyClosure = &#123; (a, b) <span class="keyword">in</span> <span class="comment">// å› ä¸ºå£°æ˜é—­åŒ…çš„æ—¶å€™å·²ç»æŒ‡å®šäº†å‚æ•°å’Œè¿”å›ç±»å‹ï¼Œæ‰€ä»¥å®ç°éƒ¨åˆ†å¯ä»¥çœç•¥</span></span><br><span class="line">  a * b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Swift ä¼šå°†é—­åŒ…ä¸­çš„å‚æ•°æŒ‡å®šä¸º <strong>$0</strong>, <strong>$1</strong>â€¦åˆ†åˆ«å¯¹åº”é—­åŒ…ä¸­çš„å‚æ•°åˆ—è¡¨ï¼Œæ‰€ä»¥å®ç°çš„æ—¶å€™è¿˜å¯ä»¥çœç•¥é—­åŒ…çš„å‚æ•°åˆ—è¡¨ã€‚</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">multiplyClosure = &#123;</span><br><span class="line">  $<span class="number">0</span> * $<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œé—­åŒ…çš„<strong>å‚æ•°åˆ—è¡¨</strong>ï¼Œ<strong>return å…³é”®å­—</strong>ï¼Œ<strong>in å…³é”®å­—</strong>å…¨éƒ¨éƒ½å¯ä»¥è¢«çœç•¥äº†ã€‚</p><p>è€ƒè™‘ä¸‹é¢çš„å‡½æ•° operateOnNumbers, å‡½æ•°æ¥æ”¶ä¸¤ä¸ª Int å‚æ•°å’Œä¸€ä¸ªé—­åŒ…ï¼Œæ ¹æ®é—­åŒ…æŒ‡å®šçš„æ“ä½œå¯¹ä¸¤ä¸ª Int å‚æ•°è¿›è¡Œè®¡ç®—ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">operateOnNumbers</span><span class="params">(<span class="number">_</span> a: Int, <span class="number">_</span> b: Int, operation: <span class="params">(Int, Int)</span></span></span> -&gt; <span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> result = operation(a, b)</span><br><span class="line">  <span class="built_in">print</span>(result)</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªé—­åŒ…ï¼Œç„¶åå°†é—­åŒ…ä¼ ç»™ operateOnNumbers å‡½æ•°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> addClosure = &#123; (a: <span class="type">Int</span>, b: <span class="type">Int</span>) <span class="keyword">in</span> <span class="comment">// å®šä¹‰é—­åŒ…</span></span><br><span class="line">  a + b</span><br><span class="line">&#125;</span><br><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: addClosure) <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºé—­åŒ…å°±æ˜¯æ²¡æœ‰åå­—çš„å‡½æ•°ï¼Œæ‰€ä»¥ç»™ operateOnNumbers ä¼ ä¸ªå‡½æ•°ä¸€æ ·å¯ä»¥æ­£å¸¸è¿è¡Œï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addFunction</span><span class="params">(<span class="number">_</span> a: Int, <span class="number">_</span> b: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: addFunction) <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><ul><li>ä½œä¸ºå‡½æ•°å‚æ•°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å†…è”é—­åŒ…ï¼Œå°±æ˜¯ç›´æ¥å°†é—­åŒ…ä¼ ç»™å‡½æ•°å‚æ•°ï¼Œè€Œä¸éœ€è¦å°†é—­åŒ…èµ‹ç»™ä¸€ä¸ªå˜é‡ã€‚æ‰€ä»¥ä½¿ç”¨å†…è”é—­åŒ…çš„æ—¶å€™ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥å†™æˆï¼š</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: &#123; (a: <span class="type">Int</span>, b: <span class="type">Int</span>) -&gt; <span class="type">Int</span> <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å†è€ƒè™‘åˆ°ä¸Šé¢å·²ç»è®²è¿‡çš„ä¸€äº›ä¹¦å†™é—­åŒ…çš„è¯­æ³•ç³–ï¼Œç°åœ¨è°ƒç”¨ operateOnNumbers çš„æ—¶å€™ä»ç„¶é€‚ç”¨ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. é—­åŒ…åªæœ‰ä¸€å¥ return è¯­å¥æ—¶ï¼Œå¯ä»¥çœç•¥ return å…³é”®å­—</span></span><br><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: &#123; (a: <span class="type">Int</span>, b:<span class="type">Int</span>) -&gt; <span class="type">Int</span> <span class="keyword">in</span></span><br><span class="line">  a + b</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 2. å·²çŸ¥é—­åŒ…ç±»å‹çš„æƒ…å†µä¸‹ï¼Œçœç•¥å‚æ•°å’Œè¿”å›å€¼ç±»å‹</span></span><br><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: &#123; (a, b) <span class="keyword">in</span></span><br><span class="line">  a + b</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 3. çœç•¥å‚æ•°åˆ—è¡¨</span></span><br><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: &#123;</span><br><span class="line">  $<span class="number">0</span> + $<span class="number">1</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é™¤äº†ä¸Šé¢çš„å‡ ç§å†™æ³•ä»¥å¤–ï¼Œè¿˜å¯ä»¥ç›´æ¥ä¼ ç»™å‡½æ•°ä¸€ä¸ª â€˜+â€™ è¿ç®—ç¬¦ï¼Œå› ä¸º â€˜+â€™ è¿ç®—ç¬¦æœ¬èº«ä¹Ÿæ˜¯å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›å…¶è®¡ç®—ç»“æœã€‚æ‰€ä»¥ï¼Œè¿˜å¯ä»¥å†™æˆä¸‹é¢çš„æ ·å­ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: +)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å†™æ³•å·²ç»éå¸¸ç®€å•æ˜ç™½äº†ï¼Œä½†æ˜¯è¿˜å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚å½“é—­åŒ…æ˜¯å‡½æ•°çš„<strong>æœ€åä¸€ä¸ªå‚æ•°</strong>çš„æ—¶å€™ï¼Œå¯ä»¥å°†é—­åŒ…å†™åœ¨å‡½æ•°çš„åé¢ï¼Œè¿™ç§å†™æ³•ä¹Ÿç§°ä¸º<strong>å°¾éšé—­åŒ… (trailing closure)</strong> .</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. æ™®é€šå†™æ³•</span></span><br><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>, operation: &#123;</span><br><span class="line">  $<span class="number">0</span> + $<span class="number">1</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 2. ä½¿ç”¨å°¾éšé—­åŒ…çš„å†™æ³•</span></span><br><span class="line">operateOnNumbers(<span class="number">4</span>, <span class="number">2</span>) &#123;</span><br><span class="line">  $<span class="number">0</span> + $<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Closures-without-return-value"><a href="#Closures-without-return-value" class="headerlink" title="Closures without return value"></a>Closures without return value</h2><p>ç›®å‰ä¸ºæ­¢ï¼Œä¸Šé¢çš„é—­åŒ…éƒ½æ¥æ”¶äº†è‡³å°‘ä¸€ä¸ªå‚æ•°å¹¶ä¸”æœ‰è¿”å›å€¼ï¼Œä½†æ˜¯å’Œå‡½æ•°ä¸€æ ·ï¼Œå‚æ•°å’Œè¿”å›å€¼å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œé—­åŒ…å¯ä»¥æ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼ï¼Œè€Œåªå®ŒæˆæŸä¸€ç‰¹å®šçš„æ“ä½œã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªé—­åŒ…voidClosureï¼ŒvoidClosureæ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼</span></span><br><span class="line"><span class="keyword">let</span> voidClosure: () -&gt; <span class="type">Void</span> = &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"This is a closure"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨</span></span><br><span class="line">voidClosure()</span><br></pre></td></tr></table></figure><h2 id="Capturing-from-enclosing-scope"><a href="#Capturing-from-enclosing-scope" class="headerlink" title="Capturing from enclosing scope"></a>Capturing from enclosing scope</h2><p>æœ€åï¼Œå›åˆ°é—­åŒ…çš„ç‰¹æ€§ä¸Šæ¥ï¼Œå¼€ç¯‡å°±å¼ºè°ƒäº†ï¼Œé—­åŒ…ä¹‹æ‰€ä»¥å«â€é—­åŒ…â€ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥æ•è·ä½œç”¨åŸŸå†…çš„å€¼ã€‚å³ä½¿å®šä¹‰è¿™äº›å¸¸é‡å’Œå˜é‡çš„åŸä½œç”¨åŸŸå·²ç»ä¸å­˜åœ¨ï¼Œé—­åŒ…ä»ç„¶å¯ä»¥åœ¨é—­åŒ…å‡½æ•°ä½“å†…å¼•ç”¨å’Œä¿®æ”¹è¿™äº›å€¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> counter = <span class="number">0</span></span><br><span class="line"><span class="comment">// incrementCounter æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå› ä¸ºé—­åŒ…å’Œå˜é‡ counter ä½œç”¨åŸŸç›¸åŒï¼Œæ‰€ä»¥å¯ä»¥æ•è·å˜é‡ï¼Œå¹¶åœ¨é—­åŒ…å†…ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">let</span> incrementCounter = &#123;</span><br><span class="line">  counter += <span class="number">1</span> <span class="comment">// é—­åŒ…å†…å¢åŠ counterçš„å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç„¶åå¤šæ¬¡è°ƒç”¨é—­åŒ…</span></span><br><span class="line">incrementCounter() <span class="comment">// 1</span></span><br><span class="line">incrementCounter() <span class="comment">// 2</span></span><br><span class="line">incrementCounter() <span class="comment">// 3</span></span><br><span class="line">incrementCounter() <span class="comment">// 4</span></span><br><span class="line">incrementCounter() <span class="comment">// 5</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­åªæ˜¯ç®€å•æ¼”ç¤ºäº†é—­åŒ…å¯¹å˜é‡çš„æ•è·ï¼Œç°åœ¨å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªé—­åŒ…ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">countingClosure</span><span class="params">()</span></span> -&gt; (() -&gt; <span class="type">Int</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> counter = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> incrementCounter: () -&gt; <span class="type">Int</span> = &#123;</span><br><span class="line">    counter += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å°†é—­åŒ…è¿”å›</span></span><br><span class="line">  <span class="keyword">return</span> incrementCounter</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counter1 = countingClosure()</span><br><span class="line"><span class="keyword">let</span> counter2 = countingClosure()</span><br><span class="line">counter1() <span class="comment">// 1</span></span><br><span class="line">counter2() <span class="comment">// 1</span></span><br><span class="line">counter1() <span class="comment">// 2</span></span><br><span class="line">counter1() <span class="comment">// 3</span></span><br><span class="line">counter2() <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç»“æœè¡¨ç¤ºåœ¨ä¸¤ä¸ªé—­åŒ…å†…éƒ¨å¯¹ counter çš„æ“ä½œæ˜¯è¿ç»­å’Œå„è‡ªç‹¬ç«‹çš„ã€‚</p><h2 id="Closures-are-reference-types"><a href="#Closures-are-reference-types" class="headerlink" title="Closures are reference types"></a>Closures are reference types</h2><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œcounter1 å’Œ counter2 éƒ½è¢«å£°æ˜ä¸ºå¸¸é‡ï¼Œä½†æ˜¯ counter1 å’Œ counter2 ä»ç„¶å¯ä»¥æ”¹å˜é—­åŒ…ä¸­ counter å˜é‡çš„å€¼ï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•°å’Œé—­åŒ…éƒ½æ˜¯<strong>å¼•ç”¨ç±»å‹ (reference type)</strong>, å½“æŠŠä¸€ä¸ªé—­åŒ…èµ‹ç»™ä¸€ä¸ªå˜é‡æˆ–è€…å¸¸é‡çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯å°†å˜é‡æˆ–å¸¸é‡æŒ‡å‘è¿™ä¸ªé—­åŒ…æ‰€åœ¨çš„åœ°å€ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ³¨æ„ä¸Šé¢çš„ä»£ç ï¼Œcounter1ä¸­çš„counterå½“å‰å€¼æ˜¯3</span></span><br><span class="line"><span class="keyword">let</span> counter3 = counter1</span><br><span class="line">counter3() <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><h2 id="Escaping-closures"><a href="#Escaping-closures" class="headerlink" title="Escaping closures"></a>Escaping closures</h2><p>ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°ä¼ åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œä½†æ˜¯è¿™ä¸ªé—­åŒ…åœ¨å‡½æ•°è¿”å›ä¹‹åæ‰è¢«æ‰§è¡Œï¼Œæˆ‘ä»¬ç§°è¯¥é—­åŒ…ä»å‡½æ•°ä¸­é€ƒé€¸ã€‚é»˜è®¤æƒ…å†µä¸‹é—­åŒ…æ˜¯ä¸å…è®¸â€é€ƒé€¸â€å‡ºå‡½æ•°çš„ï¼Œæ ‡è®°ä¸º <strong>@escape</strong> æ‰è¡¨ç¤ºå…è®¸é—­åŒ…åœ¨å‡½æ•°è¿”å›åæ‰§è¡Œã€‚å°†é—­åŒ…æ ‡æ³¨ <strong>@escape</strong> èƒ½ä½¿ç¼–è¯‘å™¨çŸ¥é“è¿™ä¸ªé—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><p>éé€ƒé€¸é—­åŒ…å’Œé€ƒé€¸é—­åŒ…è®²çš„å¹¶ä¸æ˜¯æ‰§è¡Œçš„å…ˆåé¡ºåºï¼Œéé€ƒé€¸é—­åŒ…æŒ‡çš„æ˜¯é—­åŒ…ä¸å¯ä»¥åœ¨å‡½æ•°å¤–å•ç‹¬è°ƒç”¨ï¼Œåªèƒ½åœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ï¼Œå‡½æ•°è°ƒç”¨å®Œæˆåï¼Œè¿™ä¸ªé—­åŒ…å°±ç»“æŸäº†ã€‚</p><p>å°†ä¸€ä¸ªé—­åŒ…æ ‡è®°ä¸ºå…è®¸é€ƒé€¸æ—¶ï¼Œåœ¨é—­åŒ…å†…éƒ¨è®¿é—®<strong>å®ä¾‹å˜é‡</strong>æ—¶è¦ä½¿ç”¨ self, è€Œä¸å…è®¸é—­åŒ…é€ƒé€¸çš„æ—¶å€™ï¼Œè®¿é—®å˜é‡ä¸éœ€è¦ä½¿ç”¨ self.</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªå­˜æ”¾å‡½æ•°çš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> completionHandlers: [() -&gt; <span class="type">Void</span>] = []</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæ¥æ”¶é—­åŒ…å‚æ•°çš„å‡½æ•°ï¼Œé—­åŒ…å…è®¸é€ƒé€¸</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">someFunctionWithEscapingClosure</span><span class="params">(completionHandler: @escaping <span class="params">()</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  completionHandlers.append(completionHandler)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">someFunctionWithNonescapingClosure</span><span class="params">(closure: <span class="params">()</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">  closure()</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x = <span class="number">10</span></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">doSomething</span><span class="params">()</span></span> &#123;</span><br><span class="line">    someFunctionWithEscapingClosure &#123; <span class="keyword">self</span>.x = <span class="number">100</span> &#125;</span><br><span class="line">    someFunctionWithNonescapingClosure &#123; x = <span class="number">200</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance = <span class="type">SomeClass</span>()</span><br><span class="line">instance.doSomething()</span><br><span class="line"><span class="built_in">print</span>(instance.x) <span class="comment">// prints "200"</span></span><br><span class="line"></span><br><span class="line">completionHandlers.first?() <span class="comment">// å»¶è¿Ÿè°ƒç”¨</span></span><br><span class="line"><span class="built_in">print</span>(instance.x) <span class="comment">// prints "100"</span></span><br></pre></td></tr></table></figure><h2 id="Auto-closures"><a href="#Auto-closures" class="headerlink" title="Auto closures"></a>Auto closures</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ <strong>&amp;&amp;</strong> æ˜¯ä¸ªçŸ­è·¯è¿ç®—ç¬¦ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ“ä½œæ•°ï¼Œé¦–å…ˆä¼šè®¡ç®—å·¦è¾¹çš„æ“ä½œæ•°æ˜¯ä¸æ˜¯ true, åªæœ‰å½“å·¦è¾¹æ“ä½œæ•°æ˜¯ true çš„æ—¶å€™ï¼Œæ‰ä¼šè®¡ç®—å³è¾¹çš„æ“ä½œæ•°ã€‚å‡å¦‚å·¦è¾¹æ˜¯ false, æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼å°±æ˜¯ false, æ‰€ä»¥æ— éœ€è®¡ç®—å³è¾¹çš„è¡¨è¾¾å¼ã€‚å‡å¦‚ï¼Œæˆ‘ä»¬è¦å¯¹æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¿›è¡ŒæŸç§åˆ¤æ–­ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> evens = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">if</span> !evens.isEmpty &amp;&amp; evens[<span class="number">0</span>] &gt; <span class="number">10</span> &#123;</span><br><span class="line">  evens[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸»è¦ä¾èµ–äº &amp;&amp; è¿ç®—ç¬¦çš„çŸ­è·¯æœºåˆ¶ï¼Œå¦åˆ™ evens ä¸ºç©ºçš„æ—¶å€™ç¨‹åºå°±ä¼šå´©æºƒã€‚è™½ç„¶å‡ ä¹æ‰€æœ‰è¯­è¨€çš„ &amp;&amp; å’Œ || è¿ç®—ç¬¦éƒ½æœ‰å†…å»ºçš„çŸ­è·¯æœºåˆ¶ï¼Œä½†æ˜¯å¦‚ä½•ç»™è‡ªå®šä¹‰çš„è¿ç®—ç¬¦æ·»åŠ çŸ­è·¯æœºåˆ¶å‘¢ã€‚å‡å¦‚æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç å®ç° &amp;&amp; è¿ç®—ç¬¦ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">and</span><span class="params">(<span class="number">_</span> l: Bool, <span class="number">_</span> r: Bool)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> l <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;</span><br><span class="line">  <span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„ and å¹¶ä¸å…·å¤‡çŸ­è·¯æœºåˆ¶ã€‚å› ä¸ºè¢«ä¼ å…¥çš„å‚æ•° r æ˜¯ Bool ç±»å‹ï¼Œåœ¨ and å†…éƒ¨å·²ç»å¾—åˆ°äº†ç»“æœã€‚æˆ‘ä»¬è¦æƒ³æŠŠè¿™ä¸ªåˆ¤æ–­è¿‡ç¨‹å»¶è¿Ÿï¼Œåªè¦åœ¨å·¦è¾¹è¡¨è¾¾å¼ä¸º true çš„æ—¶å€™æ‰è¿›è¡Œã€‚è¿™å°±å¯ä»¥ä½¿ç”¨é—­åŒ…æ¥æ»¡è¶³éœ€æ±‚ï¼Œå› ä¸ºé—­åŒ…å¯ä»¥æŠŠçœŸæ­£æ‰§è¡Œçš„ä»£ç å°è£…åˆ°ä¸€ä¸ªå˜é‡ä¸­å¹¶å»¶è¿Ÿæ‰§è¡Œã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">and</span><span class="params">(<span class="number">_</span> l: Bool, <span class="number">_</span> r: <span class="params">()</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> l <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;</span><br><span class="line">  <span class="keyword">return</span> r()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·è°ƒç”¨ and çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> and(!evens.isEmpty, &#123;evens[<span class="number">0</span>] &gt; <span class="number">10</span>&#125;) &#123;</span><br><span class="line">  evens[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ &amp;&amp; è¿ç®—ç¬¦ç›¸æ¯”ï¼Œåœ¨ and æ–¹æ³•ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°å˜æˆäº†é—­åŒ…ï¼Œä½†æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„åªæ˜¯ä»£ç ä¸­çš„å†…å®¹ï¼Œä½¿ç”¨é—­åŒ…å¸¦æ¥äº†ä¾¿åˆ©å´ä¹Ÿä½¿ä¹¦å†™å˜å¾—éº»çƒ¦ã€‚è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ <strong>@autoclosure</strong> å…³é”®å­—äº†ï¼Œå®ƒå¯ä»¥æŠŠä¸€ä¸ªè¡¨è¾¾å¼è‡ªåŠ¨å˜æˆé—­åŒ…çš„å½¢å¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">and</span><span class="params">(<span class="number">_</span> l: Bool, @autoclosure <span class="number">_</span> r: <span class="params">()</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> l <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;</span><br><span class="line">  <span class="keyword">return</span> r()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äºæ˜¯ and æ–¹æ³•çš„è°ƒç”¨å°±å¯ä»¥ç®€åŒ–ä¸ºä¸‹é¢çš„æ ·å­ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> and(!evens.isEmpty, evens[<span class="number">0</span>] &gt; <span class="number">10</span>) &#123;</span><br><span class="line">  evens[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº†å¯ä»¥ç”¨äºçŸ­è·¯è¿ç®—ç¬¦ä»¥å¤–ï¼Œ@autoclosure å…³é”®å­—åœ¨ä¸€äº›è°ƒè¯•ã€æ—¥å¿—å‡½æ•°ä¸­ä¹Ÿå¾ˆæœ‰ç”¨å¤„ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ <em>fatalError</em> å’Œ <em>assert</em> å‡½æ•°çš„å®šä¹‰ä¸­ä¹Ÿç”¨åˆ°äº† @autoclosure å…³é”®å­—ã€‚ä»¥ <em>assert</em> å‡½æ•°ä¸ºä¾‹ï¼Œå®ƒåªåœ¨è°ƒè¯•çš„æ—¶å€™æ‰ä¼šè§¦å‘ï¼Œå› æ­¤åœ¨ release æ¨¡å¼ä¸‹ï¼Œé—­åŒ…å†…çš„ä»£ç ä¸ä¼šæ‰§è¡Œï¼Œè¿™æ ·æœ‰åŠ©äºæé«˜ç¨‹åºçš„æ•ˆç‡ã€‚</p><h2 id="Custom-sorting-with-closures"><a href="#Custom-sorting-with-closures" class="headerlink" title="Custom sorting with closures"></a>Custom sorting with closures</h2><p>åœ¨ collection ç±»å‹ä¸­æœ‰ä¸€ä¸ª sorted å‡½æ•°ç”¨äºè¿›è¡Œå¯¹ collection ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œä½¿ç”¨é—­åŒ…ï¼Œå¯ä»¥å®ç°è‡ªå®šä¹‰æ’åºè§„åˆ™ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> names = [<span class="string">"ZZZZZZ"</span>, <span class="string">"BB"</span>, <span class="string">"A"</span>, <span class="string">"CCCC"</span>, <span class="string">"EEEEE"</span>]</span><br><span class="line">names.sorted() <span class="comment">// ["A", "BB", "CCCC", "EEEEE", "ZZZZZZ"]</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤æ˜¯æ ¹æ®å­—æ¯è¡¨çš„é¡ºåºæ’åˆ—çš„ï¼Œç°åœ¨æˆ‘ä»¬å°†å…¶æ”¹æˆæ ¹æ®å­—ç¬¦ä¸²çš„é•¿åº¦è¿›è¡Œæ’åºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// sorted æœ‰ä¸€ä¸ªå‚æ•°æ¥æ”¶ä¸€ä¸ªç”¨äºå®šä¹‰æ’åºè§„åˆ™çš„é—­åŒ…</span></span><br><span class="line">names.sorted &#123;</span><br><span class="line">  $<span class="number">0</span>.characters.<span class="built_in">count</span> &gt; $<span class="number">1</span>.characters.<span class="built_in">count</span> <span class="comment">// æ ¹æ®å­—ç¬¦ä¸²é•¿åº¦æ’åº</span></span><br><span class="line">&#125; <span class="comment">// ["ZZZZZZ", "EEEEE", "CCCC", "BB", "A"]</span></span><br></pre></td></tr></table></figure><h2 id="Iterating-over-collections-with-closures"><a href="#Iterating-over-collections-with-closures" class="headerlink" title="Iterating over collections with closures"></a>Iterating over collections with closures</h2><p>Swift çš„ collection ç±»å‹å®ç°äº†å¾ˆå¤šç®€å•çš„è¯­æ³•ï¼Œè€Œå®ç°è¿‡ç¨‹å¤§å¤šä¾èµ–å‡½æ•°å¼ç¼–ç¨‹ï¼Œå¹¶ä¸”ä½¿ç”¨äº†é—­åŒ…ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„3ä¸ªå‡½æ•°ï¼šfilter, map å’Œ reduce.</p><ul><li>å‡½æ•° filter å…è®¸è‡ªå®šä¹‰è§„åˆ™å¯¹ collection ä¸­çš„å…ƒç´ è¿›è¡Œç­›é€‰ã€‚</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> prices = [<span class="number">1</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">20</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> largePrices = prices.<span class="built_in">filter</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> $<span class="number">0</span> &gt; <span class="number">5</span> <span class="comment">// å¤§äº5çš„å…ƒç´ ä¼šè¢«ç­›é€‰å‡ºæ¥ï¼Œç­›é€‰æ¡ä»¶æ˜¯ä¸€ä¸ªBoolè¡¨è¾¾å¼</span></span><br><span class="line">&#125; <span class="comment">// [10, 8, 20]</span></span><br></pre></td></tr></table></figure><ul><li>å‡½æ•° map å…è®¸å¯¹ collection ä¸­çš„æ‰€æœ‰å…ƒç´ åˆ†åˆ«æ‰§è¡ŒæŸä¸ªæ“ä½œã€‚</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> prices = [<span class="number">1</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">20</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> salePrices = prices.<span class="built_in">map</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> $<span class="number">0</span> - <span class="number">1</span> <span class="comment">// pricesä¸­çš„æ¯ä¸ªå…ƒç´ ä¾æ¬¡å‡å°‘1</span></span><br><span class="line">&#125; <span class="comment">// [0, 9, 7, 19, 2]</span></span><br></pre></td></tr></table></figure><ul><li>å‡½æ•° reduce å¯ä»¥å¯¹ collection ä¸­çš„å…ƒç´ ä¾æ¬¡è¿­ä»£æ‰§è¡ŒæŸä¸ªæ“ä½œã€‚</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> stock = [<span class="number">1.5</span>: <span class="number">5</span>, <span class="number">10</span>: <span class="number">2</span>, <span class="number">4.99</span>: <span class="number">20</span>, <span class="number">2.30</span>: <span class="number">5</span>, <span class="number">8.19</span>: <span class="number">30</span>]</span><br><span class="line"><span class="keyword">let</span> stockSum = stock.<span class="built_in">reduce</span>(<span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> $<span class="number">0</span> + $<span class="number">1</span>.key * <span class="type">Double</span>($<span class="number">1</span>.value)</span><br><span class="line">&#125; <span class="comment">// 384.5</span></span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Optionals in Swift</title>
      <link href="/cactus-light/2016/11/22/Optionals-in-Swift/"/>
      <url>/cactus-light/2016/11/22/Optionals-in-Swift/</url>
      <content type="html"><![CDATA[<p>Swift ä¸­æœ‰ä¸€ç§å®ç”¨ä¹Ÿå¾ˆå®¹æ˜“è¿·æƒ‘çš„ç‰¹æ€§<strong>å¯é€‰ç±»å‹ (Optional)</strong>ï¼Œæ‰€è°“çš„ Optional å°±æ˜¯ä¸€ä¸ªå˜é‡æˆ–è€…å¸¸é‡ï¼Œè¿™ä¸ªå˜é‡æˆ–å¸¸é‡å¯ä»¥æœ‰å€¼ï¼Œä¹Ÿå¯ä»¥ä¸º nilï¼Œåªèƒ½ä¸ºè¿™ä¸¤ç§æƒ…å†µã€‚ç›¸å½“äºæœ‰ä¸€ä¸ªç›’å­ï¼Œç›’å­åªæœ‰ä¸¤ç§çŠ¶æ€ï¼Œç›’å­ä¸­æœ‰ä¸ªç‰©ä½“æˆ–è€…ç›’å­ä¸ºç©ºï¼Œä¸ç®¡ç›’å­ä¸­æœ‰æ²¡æœ‰ç‰©ä½“ï¼Œç›’å­ä¸€ç›´éƒ½å­˜åœ¨ã€‚</p><h2 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h2><p>å£°æ˜ä¸€ä¸ªå¯é€‰ç±»å‹çš„å˜é‡åªéœ€è¦åœ¨ç±»å‹åé¢ä½¿ç”¨<strong>é—®å· (?)</strong>ï¼Œå¦‚æœå£°æ˜äº†ä¸€ä¸ª optional ç±»å‹çš„å˜é‡ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸ºå…¶èµ‹åˆå€¼ï¼Œé‚£ä¹ˆ optional ä¼šè¢«è‡ªåŠ¨è®¾ç½®ä¸º nilã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> result: <span class="type">Int</span>? = <span class="number">30</span> <span class="comment">// resultè¦ä¹ˆåŒ…å«ä¸€ä¸ªIntå€¼ï¼Œè¦ä¹ˆä¸ºnil</span></span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">// Optional(30)</span></span><br><span class="line">result = <span class="literal">nil</span></span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="Unwrapping-optionals"><a href="#Unwrapping-optionals" class="headerlink" title="Unwrapping optionals"></a>Unwrapping optionals</h2><p>å¦‚æœç¡®å®šä¸€ä¸ª optional æœ‰å€¼ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<strong>å¹å· (!)</strong>æ¥è·å–optionalçš„å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>å¯é€‰å€¼çš„è§£åŒ… (unwrapping optionals)</strong>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> result: <span class="type">Int</span>? = <span class="number">30</span></span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">// Optional(30)</span></span><br><span class="line"><span class="comment">// å¦‚æœè¦æ”¹å˜resultçš„å€¼ï¼Œå¿…é¡»å…ˆå°†resultè§£åŒ…</span></span><br><span class="line"><span class="built_in">print</span>(result + <span class="number">1</span>) <span class="comment">// error: value of type 'Int?' not unwrapped</span></span><br></pre></td></tr></table></figure><p>å°†ä¸€ä¸ªå¯é€‰å€¼è¿›è¡Œè§£åŒ…ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯åœ¨ç¡®å®š optional æœ‰å€¼çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¹å· (!) è¿›è¡Œ<strong>å¼ºåˆ¶è§£åŒ… (force unwrapping)</strong>ã€‚æ¯”å¦‚ä¸Šé¢è¦è·å– result çš„å€¼ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç å®ç°ã€‚    </p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> unwrappedResult = result! </span><br><span class="line"><span class="built_in">print</span>(unwrappedResult) <span class="comment">// 30</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœä¸å°å¿ƒå¯¹ä¸€ä¸ªä¸º nil çš„å¯é€‰å€¼è¿›è¡Œå¼ºåˆ¶è§£åŒ…å°±ä¼šå¯¼è‡´é”™è¯¯ï¼Œè€Œä¸”è¿™ç§é”™è¯¯åœ¨ç¼–è¯‘æ—¶æœŸå¹¶ä¸ä¸€å®šèƒ½è¢«å‘ç°ã€‚æ‰€ä»¥å°±æœ‰äº†å¦ä¸€ç§å¯¹å¯é€‰å€¼çš„å¤„ç†æ–¹å¼ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> result != <span class="literal">nil</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"result is <span class="subst">\(result!)</span>"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"result is nil"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ if è¯­å¥é¦–å…ˆæ£€æŸ¥ optional ä¸­æ˜¯å¦åŒ…å«ä¸€ä¸ªå€¼ï¼Œç„¶åå†è¿›è¡Œå¯¹åº”çš„å¤„ç†ã€‚è¿™ç§ä»£ç åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ä¿è¯ç¨‹åºè¿è¡Œçš„å®‰å…¨ï¼Œä½†æ˜¯ä»ç„¶ä¸å®Œç¾ï¼Œå› ä¸ºåœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ—¶åˆ»å¯¹å¯é€‰å€¼è¿›è¡Œæ£€æŸ¥ã€‚</p><h2 id="Optional-binding"><a href="#Optional-binding" class="headerlink" title="Optional binding"></a>Optional binding</h2><p><strong>å¯é€‰å€¼ç»‘å®š (optional binding)</strong>æ˜¯ä¸ºäº†å®‰å…¨çš„è®¿é—® optional ä¸­çš„å€¼è€Œå‡ºç°çš„ã€‚è¿›è¡Œå¯é€‰ç»‘å®šçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ let ä¹Ÿå¯ä»¥ä½¿ç”¨ varã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> unwrappedResult = result &#123; <span class="comment">// æ³¨æ„resultåé¢å¹¶æ²¡æœ‰å¹å·(!)</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"result is <span class="subst">\(unwrappedResult)</span>"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"result is nil"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡å¦‚ result æœ‰å€¼ï¼Œä¸Šé¢çš„ä»£ç ä¼šå°† result è§£åŒ…å¹¶èµ‹ç»™ unwrappedResultï¼Œç„¶ååœ¨éœ€è¦ä½¿ç”¨ result çš„åœ°æ–¹å°±å¯ä»¥ä½¿ç”¨ unwrappedResult ä»£æ›¿ã€‚é€šå¸¸æƒ…å†µä¸‹çš„å†™æ³•æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼Œå¹¶ä¸éœ€è¦ä¸ºè§£åŒ…åçš„ optional ç‰¹æ„å–ä¸ªæ–°çš„å˜é‡åã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> result = result &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"result is <span class="subst">\(result)</span>"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"result is nil"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡å¦‚æœ‰å¤šä¸ªå¯é€‰å€¼ï¼Œè¿˜å¯ä»¥åŒæ—¶è¿›è¡Œå¤šä¸ªå¯é€‰ç»‘å®šæ“ä½œï¼Œåªæœ‰å½“å¤šä¸ª optional éƒ½æœ‰å€¼çš„æ—¶å€™ï¼Œif åé¢çš„ä»£ç æ‰ä¼šè¢«æ‰§è¡Œã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> authorName: <span class="type">String</span>? = <span class="string">"James"</span></span><br><span class="line"><span class="keyword">var</span> authorAge: <span class="type">Int</span>? = <span class="number">30</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> authorName = authorName, <span class="keyword">let</span> authorAge = authorAge &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"The author is <span class="subst">\(authorName)</span> who is <span class="subst">\(authorAge)</span> years old"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"No author or no age"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> æ­¤å¤–ï¼Œåœ¨å¯é€‰ç»‘å®šæ“ä½œçš„åé¢è¿˜å¯ä»¥æ·»åŠ é¢å¤–çš„åˆ¤æ–­æ¡ä»¶ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> authorName: <span class="type">String</span>? = <span class="string">"James"</span></span><br><span class="line"><span class="keyword">var</span> authorAge: <span class="type">Int</span>? = <span class="number">30</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> authorName = authorName, <span class="keyword">let</span> authorAge = authorAge, authorAge &gt;= <span class="number">40</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"The author is <span class="subst">\(authorName)</span> who is <span class="subst">\(authorAge)</span> years old"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">"No author or no age or no age less than 40"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Implicitly-unwrapped-optionals"><a href="#Implicitly-unwrapped-optionals" class="headerlink" title="Implicitly unwrapped optionals"></a>Implicitly unwrapped optionals</h2><p>æœ‰çš„æ—¶å€™ï¼Œä»ç¨‹åºçš„ç»“æ„ä¸Šæ¥è®²ï¼Œä¸€ä¸ªå¯é€‰å€¼åœ¨åˆå§‹åŒ–ä»¥åä¾¿ä¸ä¼šå†ä¸º nilï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¯é€‰å€¼çš„æ—¶å€™å‡å¦‚ä»ç„¶éœ€è¦ä½¿ç”¨å¹å· (!) è¿›è¡Œè§£åŒ…å°±æ˜¾å¾—éå¸¸å¤šä½™ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨<strong>éšå¼è§£åŒ…çš„å¯é€‰å€¼ (implicity unwrapped optionals)</strong>ã€‚éšå¼è§£åŒ…å¯é€‰å€¼åœ¨å£°æ˜æ—¶ä½¿ç”¨å¹å·è€Œéé—®å·ï¼Œä½¿ç”¨çš„æ—¶å€™ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦è¿›è¡Œå¼ºåˆ¶è§£åŒ…ï¼Œå› ä¸ºå…¶å€¼ä¸ä¼šä¸º nilï¼Œä½†æ˜¯å‡å¦‚ä¸å°å¿ƒå°†éšå¼è§£åŒ…çš„å¯é€‰å€¼èµ‹ä¸ºäº† nilï¼Œåœ¨è®¿é—®çš„æ—¶å€™å°±ä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// an optional</span></span><br><span class="line"><span class="keyword">let</span> possibleString: <span class="type">String</span>? = <span class="string">"An optional string"</span></span><br><span class="line"><span class="comment">// access an optional</span></span><br><span class="line"><span class="keyword">let</span> forcedString: <span class="type">String</span> = possibleString! <span class="comment">// éœ€è¦å¹å·</span></span><br><span class="line"><span class="comment">// an implicitly unwrapped optional</span></span><br><span class="line"><span class="keyword">let</span> assumedString: <span class="type">String</span>! = <span class="string">"An implicitly unwrapped optional"</span></span><br><span class="line"><span class="keyword">let</span> implicitString: <span class="type">String</span> = assumedString <span class="comment">// ä¸éœ€è¦å¹å·</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œä»ç„¶å¯ä»¥åƒä½¿ç”¨æ™®é€šå¯é€‰å€¼é‚£æ ·æ¥ä½¿ç”¨éšå¼è§£åŒ…çš„å¯é€‰å€¼ï¼Œæ¯”å¦‚ä½¿ç”¨ if è¯­å¥åˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œä½¿ç”¨å¯é€‰ç»‘å®šç­‰ã€‚</p><h2 id="Nil-coalescing"><a href="#Nil-coalescing" class="headerlink" title="Nil coalescing"></a>Nil coalescing</h2><p>è¿˜æœ‰ä¸€ç§å¤„ç† optional çš„æ–¹å¼ï¼Œå°±æ˜¯è¿™å„¿ä»‹ç»çš„ <strong>nil coalescing</strong>ã€‚è€ƒè™‘åˆ°ä¸€ç§æƒ…å†µï¼Œå‡å¦‚ä½¿ç”¨ optional çš„æ—¶å€™ï¼Œæ— è®ºä½•æ—¶å¯¹ optional è¿›è¡Œè§£åŒ…éƒ½å¸Œæœ›å¾—åˆ°ä¸€ä¸ªç»“æœï¼Œä¸ç®¡å¯é€‰å€¼æ˜¯ä¸æ˜¯ nilï¼Œè¿™ç§æƒ…å†µä¸‹å°±å¯ä»¥è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå½“å¯é€‰å€¼ä¸º nil çš„æ—¶å€™ï¼Œè¡¨è¾¾å¼å°±è¿”å›è¿™ä¸ªè®¾å®šçš„é»˜è®¤å€¼ã€‚è®¾ç½®é»˜è®¤å€¼çš„è¯­æ³•æ˜¯ä½¿ç”¨ä¸¤ä¸ªè¿ç»­çš„é—®å· (??)ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> optionalInt: <span class="type">Int</span>? = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> mustHaveResult = optionalInt ?? <span class="number">0</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„è¡¨è¾¾å¼é¦–å…ˆä¼šåˆ¤æ–­ optionalInt æ˜¯ä¸æ˜¯ nilï¼ŒoptionalInt ä¸ä¸º nilï¼Œå°±è¿”å› optionalçš„å€¼ï¼Œå¦åˆ™è¿”å›é»˜è®¤å€¼0ã€‚ä¸Šé¢çš„è¡¨è¾¾å¼ç­‰åŒäºä¸‹é¢çš„è¯­å¥ï¼Œåªæ˜¯ä¹¦å†™æ›´åŠ ç®€æ´ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> optionalInt: <span class="type">Int</span>? = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> mustHaveResult: <span class="type">Int</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> unwrapped = optionalInt &#123;</span><br><span class="line">  mustHaveResult = unwrapped</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  mustHaveResult = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Nested-optional"><a href="#Nested-optional" class="headerlink" title="Nested optional"></a>Nested optional</h2><p>å¯é€‰å€¼æ˜¯å¯ä»¥è¿›è¡ŒåµŒå¥—çš„ï¼Œä½†æ˜¯å¯è¯»æ€§å¤ªå·®ï¼Œä½¿ç”¨çš„åœ°æ–¹å¹¶ä¸å¤šï¼Œä»…ä½œä¸ºäº†è§£ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> number: <span class="type">Int</span>??? = <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(number) <span class="comment">// Optional(Optional(Optional(10)))</span></span><br><span class="line"><span class="built_in">print</span>(number!) <span class="comment">// Optional(Optional(10))</span></span><br><span class="line"><span class="built_in">print</span>(number!!) <span class="comment">// Optional(10)</span></span><br><span class="line"><span class="built_in">print</span>(number!!!) <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><h2 id="Guard"><a href="#Guard" class="headerlink" title="Guard"></a>Guard</h2><p><strong>guard</strong> è¯­å¥å…¶å®å¹¶ä¸æ˜¯ optional çš„å†…å®¹ï¼Œä½†æ˜¯è€ƒè™‘åˆ° optional ä¸­å¯èƒ½ä¼šç»å¸¸ä½¿ç”¨åˆ° guard è¯­å¥ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œè¿›è¡Œä»‹ç»ã€‚æœ‰çš„æ—¶å€™ï¼Œåœ¨è¿›è¡Œæ¡ä»¶åˆ¤æ–­çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæœŸæœ›åªæœ‰åˆ¤æ–­æ¡ä»¶ä¸ºçœŸçš„æ—¶å€™ï¼Œä»£ç æ‰ä¼šæ‰§è¡Œï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ guard è¯­å¥ã€‚è€ƒè™‘åˆ°æœ‰ä¸‹é¢ä¸€ä¸ªè®¡ç®—å¹³é¢å›¾å½¢æœ‰å‡ æ¡è¾¹çš„å‡½æ•°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calculateNumberOfSides</span><span class="params">(shape: String)</span></span> -&gt; <span class="type">Int</span>? &#123;</span><br><span class="line">  <span class="keyword">switch</span> shape &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"Triangle"</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">"Square"</span>, <span class="string">"Rectangle"</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">"Pentagon"</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">"Hexagon"</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">6</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å‡½æ•°æ ¹æ®è¾“å…¥çš„å›¾å½¢çš„åå­—ï¼Œè¿”å›å›¾å½¢è¾¹çš„æ•°ç›®ï¼Œå‡å¦‚åå­—ä¸æ­£ç¡®åˆ™è¿”å› nilï¼Œæ‰€ä»¥å‡½æ•°çš„è¿”å›å€¼æ˜¯å¯é€‰å€¼ã€‚å¯ä»¥åœ¨ä¸‹é¢çš„ä»£ç ä¸­ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maybePrintSides</span><span class="params">(shape: String)</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> sides = calculateNumberOfSides(shape: shape) <span class="comment">// sides is an optional</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> sides = sides &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"A <span class="subst">\(shape)</span> has <span class="subst">\(sides)</span> sides"</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I don't know the number of sides for <span class="subst">\(shape)</span>"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥æ­£å¸¸çš„è¿è¡Œã€‚ç›¸åŒçš„é€»è¾‘è¿˜å¯ä»¥ä½¿ç”¨ guard è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">maybePrintSides</span><span class="params">(shape: String)</span></span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> sides = calculateNumberOfSides(shape: shape) <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"I don't know the number of sides for <span class="subst">\(shape)</span>"</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="comment">// elseä¸­ä¸€å®šè¦return</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"A <span class="subst">\(shape)</span> has <span class="subst">\(sides)</span> sides"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>guard å…³é”®å­—è·Ÿ if ç±»ä¼¼ï¼Œåé¢å¯ä»¥æ¥åˆ¤æ–­æ¡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯é€‰ç»‘å®šï¼Œç´§æ¥ç€åé¢æ˜¯ else ä»£ç å—å¤„ç†æ¡ä»¶ä¸æ»¡è¶³çš„æƒ…å†µï¼Œå¹¶ä¸”è®°å¾— returnï¼Œç„¶å else ä»£ç å—åé¢æ˜¯å¤„ç†æ¡ä»¶æˆç«‹æ—¶å€™çš„è¯­å¥ã€‚</p>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Structs and Classes in Swift</title>
      <link href="/cactus-light/2016/11/21/Structs-and-Classes-in-Swift/"/>
      <url>/cactus-light/2016/11/21/Structs-and-Classes-in-Swift/</url>
      <content type="html"><![CDATA[<p>åœ¨ Swift ä¸­<strong>ç»“æ„ä½“ (struct)</strong> å’Œ<strong>ç±» (class)</strong> æœ‰å¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œä¹Ÿæœ‰ä¸€äº›ä¸åŒä¹‹å¤„ï¼Œä¸‹é¢è®°å½•å¹¶æ€»ç»“ã€‚å†…å®¹ä¸»è¦å‚è€ƒäº† <em>Swift Apprentice</em>ã€‚</p><h2 id="Struct"><a href="#Struct" class="headerlink" title="Struct"></a>Struct</h2><h3 id="Basics"><a href="#Basics" class="headerlink" title="Basics"></a>Basics</h3><p>Struct ä½œä¸ºä¸€ç§å¸¸è§çš„æ•°æ®ç±»å‹ï¼Œåœ¨è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­éƒ½å­˜åœ¨ã€‚æˆ‘ä»¬ä½¿ç”¨ Struct å°è£…ç‰¹å®šçš„æ•°æ®ç»“æ„ã€‚Swift ä¸­èµ‹äºˆäº† Struct å¾ˆå¤šç‰¹æ€§ï¼Œæ¯”å¦‚ Struct ä¸­é™¤äº†å¯ä»¥å®šä¹‰å±æ€§å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰<strong>æ–¹æ³• (method)</strong> å’Œ<strong>æ„é€ å‡½æ•° (initializer)</strong>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸ºäº†è¡¨ç¤ºåœ¨å¹³é¢åæ ‡ç³»ä¸­çš„ä½ç½®ï¼Œå®šä¹‰ä¸€ä¸ªç»“æ„ä½“ Location, å…¶ä¸­åŒ…æ‹¬ä¸¤ä¸ªå±æ€§ x å’Œ yã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> y: <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å°±å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ï¼Œç„¶åå°±å¯ä»¥å®ä¾‹åŒ–ä»¥åä½¿ç”¨ï¼Œå‡å¦‚ä½ æ²¡æœ‰å®ç°  <strong>init</strong> æ–¹æ³•çš„è¯ï¼Œç»“æ„ä½“å¯ä»¥æ ¹æ®å±æ€§è‡ªåŠ¨äº§ç”Ÿä¸€ä¸ªæ„é€ å™¨:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> location = <span class="type">Location</span>(x: <span class="number">2</span>, y: <span class="number">4</span>)</span><br><span class="line"><span class="comment">// ä½¿ç”¨ç‚¹è¿ç®—ç¬¦è®¿é—®</span></span><br><span class="line"><span class="built_in">print</span>(location.x) <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">print</span>(location.y) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><a id="more"></a><p>ç°åœ¨ä¸º Location å¢åŠ ä¸€ä¸ªæ–¹æ³•ç”¨äºè®¡ç®—è·ç¦»åæ ‡åŸç‚¹çš„è·ç¦»ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> y: <span class="type">Int</span></span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">distanceToOrigin</span><span class="params">()</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="type">Double</span>(<span class="keyword">self</span>.x)</span><br><span class="line">    <span class="keyword">let</span> y = <span class="type">Double</span>(<span class="keyword">self</span>.y)</span><br><span class="line">    <span class="keyword">return</span> sqrt(x * x + y * y)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨ç»“æ„ä½“ä¸­çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">var</span> location = <span class="type">Location</span>(x: <span class="number">3</span>, y: <span class="number">4</span>)</span><br><span class="line"><span class="keyword">let</span> <span class="built_in">distance</span> = location.distanceToOrigin() <span class="comment">// ç‚¹è¿ç®—ç¬¦</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">distance</span>) <span class="comment">// 5.0</span></span><br></pre></td></tr></table></figure><h3 id="Value-type"><a href="#Value-type" class="headerlink" title="Value type"></a>Value type</h3><p>Struct æ˜¯<strong>å€¼ç±»å‹ (value type)</strong>, æ‰€ä»¥ Struct åœ¨ä¼ é€’çš„æ—¶å€™æ‹·è´çš„æ˜¯<strong>å€¼</strong>, è€Œä¸æ˜¯<strong>å¼•ç”¨</strong>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> location1 = <span class="type">Location</span>(x: <span class="number">3</span>, y: <span class="number">4</span>)</span><br><span class="line"><span class="keyword">var</span> location2 = location1</span><br><span class="line">location1.x = <span class="number">4</span> <span class="comment">// æ›´æ”¹ location1</span></span><br><span class="line"><span class="built_in">print</span>(location1.x) <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">print</span>(location2.x) <span class="comment">// 3, location2 çš„å€¼ä¸å˜ï¼Œè¯´æ˜ä¸¤ä¸ªå®ä¾‹åˆ†åˆ«å ç”¨çš„ä¸æ˜¯åŒä¸€å—å†…å­˜</span></span><br></pre></td></tr></table></figure><h3 id="Extensions"><a href="#Extensions" class="headerlink" title="Extensions"></a>Extensions</h3><p>å¯ä»¥é€šè¿‡<strong>æ‰©å±• (extensions)</strong> ç»™ä¸€ä¸ªç»“æ„ä½“è¿½åŠ æ–¹æ³•æˆ–è€…è®¡ç®—å±æ€§ï¼Œä½†æ˜¯ä¸å¯ä»¥è¿½åŠ å­˜å‚¨å±æ€§ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥åœ¨æ‰©å±•ä¸­å®ç°è‡ªå®šä¹‰çš„ <strong>init</strong> æ–¹æ³•ï¼Œåœ¨æ‰©å±•ä¸­å®ç°çš„ <strong>init</strong> æ–¹æ³•å°†ä¸ä¼šä½¿ç»“æ„ä½“æ ¹æ®å±æ€§è‡ªåŠ¨ç”Ÿæˆçš„ <strong>init</strong> å¤±æ•ˆã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Location</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> gradient: <span class="type">Double</span> &#123; <span class="comment">// è¿½åŠ ä¸€ä¸ªè®¡ç®—å±æ€§æ¥è·å–æ–œç‡</span></span><br><span class="line">    <span class="keyword">let</span> y = <span class="type">Double</span>(<span class="keyword">self</span>.y)</span><br><span class="line">    <span class="keyword">let</span> x = <span class="type">Double</span>(<span class="keyword">self</span>.x)</span><br><span class="line">    <span class="keyword">guard</span> x != <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> y / x</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">init</span>() &#123;</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    y = <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> location1 = <span class="type">Location</span>() <span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰çš„ init</span></span><br><span class="line"><span class="keyword">var</span> location2 = <span class="type">Location</span>(x: <span class="number">3</span>, y: <span class="number">4</span>) <span class="comment">// ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„ init</span></span><br></pre></td></tr></table></figure><h3 id="Conform-to-protocols"><a href="#Conform-to-protocols" class="headerlink" title="Conform to protocols"></a>Conform to protocols</h3><p>Struct å¯ä»¥éµå®ˆ<strong>åè®® (protocols)</strong> å¹¶å®ç°åè®®ä¸­å®šä¹‰çš„å±æ€§æˆ–æ–¹æ³•ã€‚ä¸‹é¢éµå®ˆåè®®å¹¶å®ç° <strong>description</strong> çš„è¿‡ç¨‹å¦‚ä¸‹:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Location</span>: <span class="title">CustomStringConvertible</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> x: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> y: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"location at (<span class="subst">\(x)</span>,<span class="subst">\(y)</span>)."</span>  </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">distanceToOrigin</span><span class="params">()</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="type">Double</span>(<span class="keyword">self</span>.x)</span><br><span class="line">    <span class="keyword">let</span> y = <span class="type">Double</span>(<span class="keyword">self</span>.y)</span><br><span class="line">    <span class="keyword">return</span> sqrt(x * x + y * y)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><h3 id="Basics-1"><a href="#Basics-1" class="headerlink" title="Basics"></a>Basics</h3><p>Swiftä¸­çš„ç±»å’Œç»“æ„ä½“ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥å®šä¹‰<strong>å±æ€§</strong>ã€<strong>æ–¹æ³•</strong>ã€<strong>éµå®ˆåè®®</strong>ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç±»è¿˜æ‹¥æœ‰<strong>ç»§æ‰¿ (inheritance)</strong>ã€<strong>é‡å†™ (override)</strong>ã€<strong>å¤šæ€ (polymorphism)</strong> ç­‰ç»“æ„ä½“ä¸å…·æœ‰çš„åŠŸèƒ½ã€‚</p><p>ä¸‹é¢ä»å®ç°ä¸€ä¸ª Person ç±»å¼€å§‹ï¼ŒPerson ç±»ä¸­æœ‰ä¸¤ä¸ªå­˜å‚¨å±æ€§å’Œä¸€ä¸ª <strong>init</strong> æ–¹æ³•ï¼Œæ³¨æ„ï¼Œclass å¹¶ä¸ä¼šæ ¹æ®å±æ€§è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œæ‰€ä»¥å¿…éœ€æ‰‹åŠ¨å®ç° init æ–¹æ³•ï¼Œå‡å¦‚æ²¡æœ‰æä¾›ï¼Œå°±ä¼šäº§ç”Ÿé”™è¯¯ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> firstName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> lastName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.firstName = firstName</span><br><span class="line">    <span class="keyword">self</span>.lastName = lastName</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> john = <span class="type">Person</span>(firstName: <span class="string">"Johnny"</span>, lastName: <span class="string">"Ivy"</span>)</span><br></pre></td></tr></table></figure><h3 id="Reference-type"><a href="#Reference-type" class="headerlink" title="Reference type"></a>Reference type</h3><p>åœ¨ Swift ä¸­ï¼Œç»“æ„ä½“æ˜¯ä¸€ä¸ª<strong>ä¸å¯å˜çš„å€¼ç±»å‹ (immutable value)</strong>, è€Œç±»åˆ™æ˜¯<strong>å¯å˜çš„å¼•ç”¨ç±»å‹ (mutable reference)</strong>ã€‚æ‰€ä»¥å³ä½¿ç±»ä¸­çš„æŸä¸ªæ–¹æ³•æ”¹å˜äº†ç±»çš„å†…å®¹ï¼Œä¹Ÿä¸éœ€è¦åœ¨æ–¹æ³•å‰ä½¿ç”¨ <strong>mutating</strong> å…³é”®å­—ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = <span class="type">Person</span>(firstName: <span class="string">"Bruce"</span>, lastName: <span class="string">"Lee"</span>)</span><br><span class="line"><span class="keyword">var</span> person2 = person1 <span class="comment">// ä¼ é€’å¼•ç”¨</span></span><br><span class="line"><span class="built_in">print</span>(person2.firstName) <span class="comment">// Bruce</span></span><br><span class="line">person1.firstName = <span class="string">"Jack"</span></span><br><span class="line"><span class="built_in">print</span>(person2.firstName) <span class="comment">// Jack</span></span><br></pre></td></tr></table></figure><p>è‹¥è¦æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æŒ‡å‘çš„æ˜¯ä¸æ˜¯åŒä¸€å—å†…å­˜ï¼Œå¯ä»¥ä½¿ç”¨ <strong>â€œ===â€</strong> è¿ç®—ç¬¦ï¼Œå¸¸ç”¨çš„ <strong>â€œ==â€</strong> è¿ç®—ç¬¦åªç”¨äºæ¯”è¾ƒå€¼æ˜¯å¦ç›¸ç­‰ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = <span class="type">Person</span>(firstName: <span class="string">"Bruce"</span>, lastName: <span class="string">"Lee"</span>)</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="type">Person</span>(firstName: <span class="string">"Bruce"</span>, lastName: <span class="string">"Lee"</span>) <span class="comment">// person2å’Œperson1åå­—ç›¸åŒï¼Œæ˜¯åŒä¸€ä¸ªäºº?</span></span><br><span class="line"><span class="keyword">var</span> person3 = person1 <span class="comment">// person3 å’Œ person1 æŒ‡å‘åŒä¸€å—å†…å­˜</span></span><br><span class="line"><span class="built_in">print</span>(person1 === person2) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">print</span>(person1 === person3) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºå¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ‰€ä»¥å³ä½¿å°†ä¸€ä¸ªå¯¹è±¡å£°æ˜ä¸ºå¸¸é‡ï¼Œä¹Ÿå¯ä»¥æ”¹å˜å¯¹è±¡ä¸­å±æ€§çš„å€¼ã€‚å¸¸é‡è¡¨ç¤ºå¯¹è±¡æŒ‡å‘å†…å­˜çš„ä½ç½®ä¸å¯å˜ï¼Œä½†æ˜¯å†…å­˜ä¸­å­˜å‚¨çš„å†…å®¹å¯ä»¥æ”¹å˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = <span class="type">Person</span>(firstName: <span class="string">"Bruce"</span>, lastName: <span class="string">"Lee"</span>) <span class="comment">// personä¸ºå¸¸é‡</span></span><br><span class="line">person.firstName = <span class="string">"Jack"</span> <span class="comment">// æ›´æ”¹ person çš„å±æ€§</span></span><br><span class="line"><span class="built_in">print</span>(person.firstName) <span class="comment">// Jack, å±æ€§çš„å€¼ä»ç„¶è¢«æ”¹å˜äº†</span></span><br></pre></td></tr></table></figure><h3 id="Extensions-1"><a href="#Extensions-1" class="headerlink" title="Extensions"></a>Extensions</h3><p>ä¸ç»“æ„ä½“ç±»ä¼¼ï¼Œç±»ä¹Ÿå¯ä»¥é€šè¿‡ extension æ·»åŠ æ–¹æ³•å’Œè®¡ç®—å±æ€§ã€‚å‡å¦‚è¦æ·»åŠ ä¸€ä¸ªè®¡ç®—å±æ€§ fullName, å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> fullName: <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"<span class="subst">\(firstName)</span> <span class="subst">\(lastName)</span>"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h3><p><strong>ç»§æ‰¿ (inheritance)</strong> å¯ä»¥å®ç°ç±»çš„æ‰©å±•ï¼Œä¸ºå·²å­˜åœ¨çš„ç±»å¢åŠ æ–°çš„å±æ€§å’Œæ–¹æ³•ï¼Œæˆ–è€…å¯¹åŸæœ‰çš„æ–¹æ³•è¿›è¡Œ<strong>é‡å†™ (override)</strong>ã€‚</p><p>å‡å¦‚æœ‰ä¸€ä¸ª Student ç±»ï¼Œå®šä¹‰å¦‚ä¸‹:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Grade</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> letter: <span class="type">String</span></span><br><span class="line">  <span class="keyword">let</span> points: <span class="type">Double</span></span><br><span class="line">  <span class="keyword">let</span> credits: <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> firstName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> lastNameL: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> grades: [<span class="type">Grade</span>] = [] <span class="comment">// è¡¨ç¤ºæˆç»©</span></span><br><span class="line">  <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.firstName = firstName</span><br><span class="line">    <span class="keyword">self</span>.lastName = lastName</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">recordGrade</span><span class="params">(<span class="number">_</span> grade: Grade)</span></span> &#123;</span><br><span class="line">    grades.append(grade)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° Student ä¹Ÿæ˜¯ Person, æ‰€ä»¥å¯ä»¥åœ¨ç°æœ‰çš„ Person ç±»åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•æ¥å‡å°‘ä»£ç å†—ä½™ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Grade</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> letter: <span class="type">String</span></span><br><span class="line">  <span class="keyword">let</span> points: <span class="type">Double</span></span><br><span class="line">  <span class="keyword">let</span> credits: <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> firstName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> lastName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.firstName = firstName</span><br><span class="line">    <span class="keyword">self</span>.lastName = lastName</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>: <span class="title">Person</span> </span>&#123; <span class="comment">// Student ç»§æ‰¿è‡ª Person</span></span><br><span class="line">  <span class="keyword">var</span> grades: [<span class="type">Grade</span>] = []</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">recordGrade</span><span class="params">(<span class="number">_</span> grade: Grade)</span></span> &#123;</span><br><span class="line">    grades.append(grade)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç»§æ‰¿ï¼ŒStudent æ‹¥æœ‰äº† Person çš„å±æ€§ã€æ„é€ å‡½æ•°å’Œå…¶å®ƒçš„æ–¹æ³•ã€‚ç„¶åå°±å¯ä»¥åƒä½¿ç”¨ Person ä¸€æ ·ä½¿ç”¨ Studentã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> john = <span class="type">Person</span>(firstName: <span class="string">"Johnny"</span>, lastName: <span class="string">"Ivy"</span>)</span><br><span class="line"><span class="keyword">let</span> jane = <span class="type">Student</span>(firstName: <span class="string">"Jane"</span>, lastName: <span class="string">"Ivy"</span>)</span><br><span class="line"><span class="built_in">print</span>(john.firstName) <span class="comment">// Johnny</span></span><br><span class="line"><span class="built_in">print</span>(jane.firstName) <span class="comment">// Jane</span></span><br></pre></td></tr></table></figure><p>é™¤äº†ç»§æ‰¿è‡ª Person çš„å±æ€§å’Œæ–¹æ³•å¤–ï¼ŒStudent è¿˜æœ‰è‡ªèº«çš„å±æ€§ <strong>grades</strong> å’Œæ–¹æ³•ï¼Œè€Œç‰¹æœ‰çš„å±æ€§å’Œæ–¹æ³•åªæœ‰ Student çš„å®ä¾‹æ‰å¯ä»¥è®¿é—®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> history = <span class="type">Grade</span>(letter: <span class="string">"B"</span>, points: <span class="number">9.0</span>, credits: <span class="number">3.0</span>)</span><br><span class="line">jane.recordGrade(history)</span><br><span class="line">john.recordGrade(history) <span class="comment">// Error: john is not a student</span></span><br></pre></td></tr></table></figure><p>Swift ä¸­çš„ç±»ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œä¸€ä¸ªå­ç±»æœ€å¤šå…è®¸ç»§æ‰¿è‡ªä¸€ä¸ªçˆ¶ç±»ã€‚</p><h3 id="Polymorphism"><a href="#Polymorphism" class="headerlink" title="Polymorphism"></a>Polymorphism</h3><p><strong>å¤šæ€ (Polymorphism)</strong> æ˜¯è®¸å¤šé¢å‘å¯¹è±¡çš„è¯­è¨€çš„ç‰¹æ€§ï¼Œä½¿ç”¨å¤šæ€å¯ä»¥å†™å‡ºæ›´åŠ æŠ½è±¡å’Œçµæ´»çš„ä»£ç ï¼Œæ¶‰åŠåˆ°å¤šæ€çš„æ—¶å€™ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªé‡è¦çš„æ€§è´¨ï¼š</p><ul><li>çˆ¶ç±»çš„æŒ‡é’ˆå¯ä»¥æŒ‡å‘å­ç±»çš„å¯¹è±¡</li><li>ä¸åŒçš„å¯¹è±¡ä½œç”¨äºåŒä¸€ä¸ªæ–¹æ³•ä¼šäº§ç”Ÿä¸åŒçš„å“åº”</li></ul><p>ä¸‹é¢ä»ç„¶ä½¿ç”¨ä»‹ç» Objective-C ä¸­å¤šæ€çš„æ—¶å€™æ‰€ç”¨çš„ä¾‹å­æ¥è¯´æ˜ Swift ä¸­çš„å¤šæ€ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªåŸºç±» Animal, è®¡ç®—å±æ€§ç”¨äºè·å–åŠ¨ç‰©çš„åå­—ï¼Œæ–¹æ³•ç”¨äºæè¿°åŠ¨ç‰©è¢«æ‰“äº†ä»¥åçš„ååº”</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">beBeaten</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Cat ç»§æ‰¿è‡ª Animal, å¹¶é‡å†™äº† beBeaten() æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>: <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">beBeaten</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Bark and jump to high!"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Dog ç»§æ‰¿è‡ª Animal, å¹¶é‡å†™äº† beBeaten() æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>: <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">beBeaten</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Give a hard bit!"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Frog ç»§æ‰¿è‡ª Animal, å¹¶é‡å†™äº† beBeaten() æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Frog</span>: <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">beBeaten</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Do nothing!"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ª Human ç±», ç”¨äºæ”»å‡» animala, æ³¨æ„ beatAnimal(:) çš„å‚æ•°ç±»å‹æ˜¯ Animal, å¹¶æ²¡æœ‰æŒ‡æ˜å…·ä½“æ˜¯å“ªç§ Animal</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">  <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">beatAnimal</span><span class="params">(animal: Animal)</span></span> &#123;</span><br><span class="line">    animal.beBeaten()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> linda = <span class="type">Human</span>(name: <span class="string">"Linda"</span>)</span><br><span class="line"><span class="keyword">let</span> cat = <span class="type">Cat</span>()</span><br><span class="line"><span class="keyword">let</span> dog = <span class="type">Dog</span>()</span><br><span class="line"><span class="keyword">let</span> frog = <span class="type">Frog</span>()</span><br><span class="line"><span class="comment">// åŒæ ·çš„æ–¹æ³•ï¼Œä½œç”¨äºä¸åŒçš„å¯¹è±¡ï¼Œäº§ç”Ÿä¸åŒçš„å“åº”</span></span><br><span class="line">linda.beatAnimal(animal: cat) <span class="comment">// Bark and jump to high!</span></span><br><span class="line">linda.beatAnimal(animal: dog) <span class="comment">// Give a hard bit!</span></span><br><span class="line">linda.beatAnimal(animal: frog) <span class="comment">// Do nothing!</span></span><br></pre></td></tr></table></figure><h3 id="Preventing-inheritance"><a href="#Preventing-inheritance" class="headerlink" title="Preventing inheritance"></a>Preventing inheritance</h3><p>å‡å¦‚æœ‰æ—¶å€™ï¼Œå­˜åœ¨æŸä¸ªç±»ï¼Œè¿™ä¸ªç±»ä¸å¯ä»¥è¢«ç»§æ‰¿ï¼Œæˆ–è€…æ˜¯è¿™ä¸ªç±»ä¸­çš„æŸäº›æ–¹æ³•ä¸å…è®¸è¢«é‡å†™ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ <strong>final</strong> å…³é”®å­—ï¼Œè¢«æŒ‡å®šä¸º <strong>final</strong> çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿ï¼Œè¢«æŒ‡å®šä¸º <strong>final</strong> çš„æ–¹æ³•ä¸å…è®¸è¢«é‡å†™ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">beBeaten</span><span class="params">()</span></span> -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Human ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">  <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">func</span> <span class="title">beatAnimal</span><span class="params">(animal: Animal)</span></span> &#123;</span><br><span class="line">    animal.beBeaten()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span>: <span class="title">Human</span> </span>&#123; <span class="comment">// Error</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¢«æ ‡è®°ä¸º final çš„æ–¹æ³•æˆ–å±æ€§ä¸å¯ä»¥è¢«é‡å†™</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">  <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">beatAnimal</span><span class="params">(animal: Animal)</span></span> &#123;</span><br><span class="line">    animal.beBeaten()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span>: <span class="title">Human</span> </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">beatAnimal</span><span class="params">(animal: Animal)</span></span> &#123; <span class="comment">// error</span></span><br><span class="line">    animal.beBeaten()</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="Required-and-convenience-initializers"><a href="#Required-and-convenience-initializers" class="headerlink" title="Required and convenience initializers"></a>Required and convenience initializers</h3><p>ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œè¿™æ„å‘³ç€åœ¨å­ç±»ä¸­å¯ä»¥ä»»æ„è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°æ¥å®Œæˆè‡ªèº«çš„åˆå§‹åŒ–ã€‚é€šè¿‡ç»™ <strong>init</strong> æ–¹æ³•æ ‡è®° <strong>required</strong> æˆ–è€… <strong>convenience</strong> å…³é”®å­—å°†å…¶æŒ‡å®šä¸ºæŒ‡å®šæ„é€ å‡½æ•°æˆ–è€…ä¾¿åˆ©æ„é€ å‡½æ•°ã€‚</p><ul><li>æ‰€æœ‰å­ç±»éƒ½å¿…é¡»å®ç°çˆ¶ç±»çš„æ ‡è®°ä¸º <strong>required</strong> çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸”ä¸éœ€è¦ä½¿ç”¨ <strong>override</strong> å…³é”®å­—ã€‚</li><li>ä¸€ä¸ªæŒ‡å®šæ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨ç›´æ¥çˆ¶ç±»çš„æŒ‡å®šæ„é€ å‡½æ•°ã€‚</li><li>æ‰€æœ‰ä¾¿åˆ©æ„é€ å‡½æ•°æœ€ç»ˆéƒ½è¦ç›´æ¥æˆ–é—´æ¥è°ƒç”¨è‡ªèº«çš„æŒ‡å®šæ„é€ å‡½æ•°ã€‚</li></ul><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> firstName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> lastName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">required</span> <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.firstName = firstName</span><br><span class="line">    <span class="keyword">self</span>.lastName = lastName</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I am a person"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">convenience</span> <span class="keyword">init</span>(person: <span class="type">Person</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.<span class="keyword">init</span>(firstName: person.firstName, lastName: person.lastName)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>: <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sports: [<span class="type">String</span>]</span><br><span class="line">  <span class="keyword">required</span> <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123; <span class="comment">// ä¸éœ€è¦ override å…³é”®å­—ï¼Œä½†éœ€è¦ required å…³é”®å­—ä»¥ä¿è¯  Student çš„å­ç±»ä¹Ÿå¿…é¡»å®ç°æ­¤æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">self</span>.sports = []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I am a student"</span>)</span><br><span class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>(firstName: firstName, lastName: lastName)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸¤ä¸ªå®ä¾‹</span></span><br><span class="line"><span class="keyword">var</span> denny = <span class="type">Student</span>(firstName: <span class="string">"Denny"</span>, lastName: <span class="string">"Green"</span>)</span><br><span class="line"><span class="keyword">var</span> ivy = <span class="type">Student</span>(person: denny)</span><br></pre></td></tr></table></figure><h3 id="Retain-cycle-and-weak-references"><a href="#Retain-cycle-and-weak-references" class="headerlink" title="Retain cycle and weak references"></a>Retain cycle and weak references</h3><p>åŒ Objective-C ä¸­ç±»ä¼¼ï¼ŒSwift ä¹Ÿæ˜¯ä½¿ç”¨ ARC æ¥è¿›è¡Œå†…å­˜ç®¡ç†ï¼Œæ‰€ä»¥åŒæ ·å­˜åœ¨å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œè§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨<strong>å¼±å¼•ç”¨ (weak reference)</strong>ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> firstName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> lastName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">init</span>(firstName: <span class="type">String</span>, lastName: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.firstName = firstName</span><br><span class="line">    <span class="keyword">self</span>.lastName = lastName</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>: <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> partner: <span class="type">Student</span>?</span><br><span class="line">  <span class="keyword">deinit</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(firstName)</span> is deinited."</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> denny: <span class="type">Student</span>? = <span class="type">Student</span>(firstName: <span class="string">"Denny"</span>, lastName: <span class="string">"Green"</span>)</span><br><span class="line"><span class="keyword">var</span> jack: <span class="type">Student</span>? = <span class="type">Student</span>(firstName: <span class="string">"Jack"</span>, lastName: <span class="string">"Bush"</span>)</span><br><span class="line">denny?.partner = jack</span><br><span class="line">jack?.partner = denny</span><br><span class="line">denny = <span class="literal">nil</span></span><br><span class="line">jack = <span class="literal">nil</span> <span class="comment">// å³ä½¿ denny å’Œ jack éƒ½å˜æˆ nil, å†…å­˜ä¹Ÿæ²¡è¢«é‡Šæ”¾ï¼Œè¿™å°±æ˜¯å› ä¸ºäº§ç”Ÿäº†å¾ªç¯å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£å†³åŠæ³•æ˜¯å°† partner æ”¹æˆ weak, swift ä¸­çš„å±æ€§é»˜è®¤æ˜¯ strong</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>: <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">weak</span> <span class="keyword">var</span> partner: <span class="type">Student</span>?</span><br><span class="line">  <span class="keyword">deinit</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(firstName)</span> is deinited."</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Properties in Swift</title>
      <link href="/cactus-light/2016/11/20/Properties-in-Swift/"/>
      <url>/cactus-light/2016/11/20/Properties-in-Swift/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘è¯»äº†<em><a href="https://store.raywenderlich.com/products/swift-apprentice" target="_blank" rel="noopener">Swift Apprentice</a></em>, å°†å…¶ä¸­ä¸€äº›å…³äº Property çš„çŸ¥è¯†æ€»ç»“ä¸€ä¸‹ã€‚ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†:</p><ul><li>å­˜å‚¨å±æ€§ (Stored Properties)</li><li>è®¡ç®—å±æ€§ (Computed Properties)</li><li>ç±»å‹å±æ€§ (Typed Properties)</li><li>å±æ€§è§‚å¯Ÿå™¨ (Property Observers)</li><li>å»¶è¿ŸåŠ è½½å±æ€§ (Lazy Properties)</li></ul><a id="more"></a><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç»“æ„ä½“ Car æœ‰ä¸¤ä¸ªå±æ€§ï¼Œå­˜å‚¨äº†ä¸¤ä¸ªå­—ç¬¦ä¸²å¸¸é‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> make: <span class="type">String</span></span><br><span class="line">  <span class="keyword">let</span> color: <span class="type">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å±æ€§ç§°ä¸º<strong>å­˜å‚¨å±æ€§ (Stored Property)</strong>, è¡¨ç¤ºå®ƒä»¬å°†ä¼šä¸ºæ¯ä¸ª Car çš„å®ä¾‹å¼€è¾Ÿå†…å­˜å¹¶ä¸”å­˜å‚¨å€¼ã€‚</p><p>é™¤äº†å­˜å‚¨å±æ€§å¤–è¿˜æœ‰ä¸€ç§<strong>è®¡ç®—å±æ€§ (Computed Property)</strong>, åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™å¹¶ä¸ä¼šä¸ºè®¡ç®—å±æ€§åˆ†é…ç©ºé—´ï¼Œè€Œåªæ˜¯åœ¨éœ€è¦çš„æ—¶å€™ç®€å•çš„è®¡ç®—å®ƒä»¬çš„å€¼ã€‚</p><h2 id="Stored-properties"><a href="#Stored-properties" class="headerlink" title="Stored properties"></a>Stored properties</h2><p>å‡å¦‚ä½ æƒ³åˆ›å»ºä¸€ä¸ªé€šè®¯å½•ï¼Œé‚£ä¹ˆé€šè®¯å½•ä¸­çš„æ¯ä¸€æ¡è”ç³»äººçš„ç»„æˆå¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Contact</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> fullName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> emailAddress: <span class="type">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Contact ä¸­çš„å±æ€§å¹¶æ²¡æœ‰èµ‹ä¸Šåˆå§‹å€¼ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡<strong>æ„é€ å‡½æ•° (initializer)</strong> æ¥å®ä¾‹åŒ–ï¼ŒSwift ä¼šæ ¹æ®ç±»å‹ä¸­çš„å±æ€§ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ„é€ å‡½æ•°ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="type">Contact</span>(fullName: <span class="string">"Grace Murray"</span>, emailAddress: <span class="string">"grace@navy.mil"</span>)</span><br></pre></td></tr></table></figure><p>å®ä¾‹åŒ–å®Œæˆä»¥åï¼Œå°±å¯ä»¥ä½¿ç”¨<strong>ç‚¹è¿ç®—ç¬¦ (dot notation)</strong> æ¥è®¿é—®å®ä¾‹ä¸­çš„å±æ€§:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> name = person.fullName <span class="comment">// Grace Murray</span></span><br><span class="line"><span class="keyword">let</span> email = person.emailAddress <span class="comment">// grace@navy.mil</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå­˜å‚¨å±æ€§çš„ç»“æ„ä½“å®ä¾‹æ˜¯å˜é‡ï¼Œè€Œä¸”å±æ€§ä¹Ÿæ˜¯ä¸ªå˜é‡ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç»™ç»“æ„ä½“çš„å±æ€§èµ‹å€¼ï¼Œ</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Grace got married so she changed her name</span></span><br><span class="line">person.fullName = <span class="string">"Grace Hopper"</span></span><br><span class="line"><span class="keyword">let</span> grade = person.fullName <span class="comment">// Grace Hopper</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€ä¸ªå±æ€§åœ¨å®ä¾‹åŒ–ä»¥åä¸å¸Œæœ›è¢«æ”¹å˜çš„è¯ï¼Œé‚£ä¹ˆå£°æ˜çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ <strong>let</strong> å°†å…¶å£°æ˜ä¸ºå¸¸é‡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Contact</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> fullName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">let</span> emailAddress: <span class="type">String</span> <span class="comment">// emailAddress æ˜¯ä¸ªå¸¸é‡ï¼Œå®ä¾‹åŒ–å®Œæˆåå°±ä¸å¯ä»¥å†ä¿®æ”¹</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="type">Contact</span>(fullName: <span class="string">"Linda"</span>, emailAddress: <span class="string">"sb@baidu.com"</span>) <span class="comment">// å®ä¾‹åŒ–</span></span><br><span class="line">person.emailAddress = <span class="string">"sb@sohu.com"</span> <span class="comment">// error: ä¸å¯ä»¥ä¿®æ”¹ä¸€ä¸ªå¸¸é‡çš„å€¼</span></span><br></pre></td></tr></table></figure><h3 id="Default-values"><a href="#Default-values" class="headerlink" title="Default values"></a>Default values</h3><p>å¦‚æœä¸€ä¸ªå±æ€§çš„å€¼æ˜¯å¯ä»¥é¢„æµ‹çš„ï¼Œè€Œä¸”å¾ˆå°‘å˜åŠ¨çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥ç»™å±æ€§è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ã€‚ä¸‹é¢ä¸º Contact å¢åŠ ä¸€ä¸ªå±æ€§ type ç”¨äºæ ‡è®°è”ç³»äººæ‰€å±çš„åˆ†ç»„ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Contact</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> fullName: <span class="type">String</span></span><br><span class="line">  <span class="keyword">let</span> emailAddress: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> type = <span class="string">"Friend"</span> <span class="comment">// property with default value</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®¾ç½®é»˜è®¤å€¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥å‡å°‘ä»£ç è´Ÿæ‹…ï¼Œç¼ºç‚¹æ˜¯ Swift æ ¹æ®å±æ€§è‡ªåŠ¨ç”Ÿæˆçš„æ„é€ å‡½æ•°ä¸­è¿˜éœ€è¦æŒ‡å®š type çš„å€¼ï¼Œé™¤éä½ å®ç°äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> person = <span class="type">Contact</span>(fullName: <span class="string">"Linda"</span>, emailAddress: <span class="string">"sb@baidu.com"</span>, type: <span class="string">"Friend"</span>)</span><br></pre></td></tr></table></figure><h2 id="Computed-properties"><a href="#Computed-properties" class="headerlink" title="Computed properties"></a>Computed properties</h2><p><strong>å­˜å‚¨å±æ€§</strong>æ—¢å¯ä»¥æ˜¯å¸¸é‡ä¹Ÿå¯ä»¥æ˜¯å˜é‡ï¼Œè€Œ<strong>è®¡ç®—å±æ€§</strong>åªèƒ½æ˜¯å˜é‡ï¼Œè€Œä¸”å¿…é¡»æ˜ç¡®æŒ‡å‡ºå±æ€§çš„ç±»å‹ã€‚</p><p>ä¸‹é¢ä»¥ TV ä¸ºä¾‹è¯´æ˜ï¼Œå…¶ä¸­åŒ…æ‹¬ 3 ä¸ªå±æ€§ height ã€width ã€diagonal åˆ†åˆ«è¡¨ç¤º TV çš„é«˜ã€å®½å’Œå¯¹è§’çº¿é•¿åº¦ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TV</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> height: <span class="type">Double</span></span><br><span class="line">  <span class="keyword">var</span> width: <span class="type">Double</span></span><br><span class="line">  <span class="comment">// diagonal ä¸ºè®¡ç®—å±æ€§ï¼Œå¿…é¡»æŒ‡å®šå…¶ç±»å‹ï¼Œè€Œä¸”åªèƒ½å£°æ˜ä¸ºå˜é‡ (var)</span></span><br><span class="line">  <span class="keyword">var</span> diagonal: <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> result = sqrt(height * height + width * width)</span><br><span class="line">    <span class="keyword">let</span> roundedResult = result.rounded()</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Int</span>(roundedResult)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®¡ç®—å±æ€§ä¸å­˜å‚¨å€¼ï¼Œåªæ˜¯è®¡ç®—ç»“æœåè¿”å›</span></span><br><span class="line"><span class="keyword">var</span> tv = <span class="type">TV</span>(height: <span class="number">53.93</span>, width: <span class="number">95.87</span>)</span><br><span class="line"><span class="keyword">let</span> size = tv.diagonal <span class="comment">// 110</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ diagonal åªæœ‰ä¸€ä¸ª <strong>getter</strong>, è¿˜å¯ä»¥å®ç°ä¸€ä¸ª <strong>setter</strong>, å› ä¸ºè®¡ç®—å±æ€§ä¸å­˜å‚¨å€¼ï¼Œæ‰€ä»¥ <strong>setter</strong> ä¸­ä¸€èˆ¬æ˜¯ä¿®æ”¹ç›¸å…³çš„å­˜å‚¨å±æ€§çš„å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> diagonal: <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">get</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> result = sqrt(height * height + width * width)</span><br><span class="line">    <span class="keyword">let</span> roundedResult = result.rounded()</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Int</span>(roundedResult)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">set</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> ratioWidth = <span class="number">16.0</span></span><br><span class="line">    <span class="keyword">let</span> ratioHeight = <span class="number">9.0</span></span><br><span class="line">    <span class="comment">// ä¿®æ”¹ height å’Œ width</span></span><br><span class="line">    height = <span class="type">Double</span>(newValue) * ratioHeight /</span><br><span class="line">      sqrt(ratioWidth * ratioWidth + ratioHeight * ratioHeight)</span><br><span class="line">    width = height * ratioWidth / ratioHeight</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Type-properties"><a href="#Type-properties" class="headerlink" title="Type properties"></a>Type properties</h2><p>ä¸Šé¢ TV çš„å­˜å‚¨å±æ€§ heightã€width å’Œè®¡ç®—å±æ€§ diagonal éƒ½æ˜¯å±äº TV çš„å®ä¾‹çš„ï¼Œæ‰€ä»¥å¿…é¡»å®ä¾‹åŒ–ä»¥åæ‰èƒ½ä½¿ç”¨ã€‚è€Œç±»å‹å±æ€§æ˜¯å±äºç±»å‹æœ¬èº«çš„ï¼Œé€šè¿‡ç±»å‹åè¿›è¡Œè®¿é—®ã€‚</p><p>å‡å¦‚æœ‰ä¸€ä¸ªå­˜åœ¨å¤šä¸ªå…³å¡çš„æ¸¸æˆï¼Œæ¯ä¸€å…³éƒ½æ˜¯ä¸€ä¸ª Level å®ä¾‹ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¸€äº›å±æ€§ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Level</span> </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> id: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> boss: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> unlocked: <span class="type">Bool</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> level1 = <span class="type">Level</span>(id: <span class="number">1</span>, boss: <span class="string">"Chameleon"</span>, unlocked: <span class="literal">true</span>)</span><br><span class="line"><span class="keyword">let</span> level2 = <span class="type">Level</span>(id: <span class="number">2</span>, boss: <span class="string">"Squid"</span>, unlocked: <span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p>ç°åœ¨ç»™ Level å¢åŠ ä¸€ä¸ªå±æ€§ highsetLevel ç”¨äºæ ‡è®°å·²è§£é”çš„æœ€é«˜å…³å¡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Level</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">var</span> highestLevel = <span class="number">1</span> <span class="comment">// ä½¿ç”¨ static æ ‡è®°ä¸€ä¸ªç±»å‹å±æ€§</span></span><br><span class="line">  <span class="keyword">let</span> id: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> boss: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> unlocked: <span class="type">Bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼ŒhighestLevel æ˜¯ Level ç±»å‹çš„å±æ€§ï¼Œè€Œä¸æ˜¯ Level å®ä¾‹çš„å±æ€§ï¼Œæ‰€ä»¥è®¿é—®çš„æ—¶å€™ä½¿ç”¨ç±»å‹åç›´æ¥è¿›è¡Œè®¿é—®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Error: ä¸èƒ½é€šè¿‡å®ä¾‹è®¿é—®ç±»å‹å±æ€§</span></span><br><span class="line"><span class="keyword">let</span> highestLevel = level2.highestLevel</span><br><span class="line"><span class="comment">// Right: åªèƒ½ä½¿ç”¨ç±»å‹åè®¿é—®ç±»å‹å±æ€§</span></span><br><span class="line"><span class="keyword">let</span> highestLevel = <span class="type">Level</span>.highestLevel</span><br></pre></td></tr></table></figure><h2 id="Property-observers"><a href="#Property-observers" class="headerlink" title="Property observers"></a>Property observers</h2><p>åœ¨å®ç°  Level çš„æ—¶å€™ï¼Œæ­£ç¡®çš„æ“ä½œåº”è¯¥æ˜¯å½“ä¸€ä¸ªæ–°çš„å…³å¡è§£é” (unlocked) çš„æ—¶å€™ï¼Œç”¨äºæ ‡è®°æœ€é«˜å…³å¡çš„ highestLevel å±æ€§ä¹Ÿéšä¹‹æ”¹å˜ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡ Swift çš„<strong>å±æ€§è§‚å¯Ÿå™¨ (Property Observer)</strong> æ¥ç›‘æµ‹å±æ€§çš„å˜åŒ–ã€‚å±æ€§è§‚å¯Ÿå™¨åŒ…æ‹¬ä¸¤ä¸ªæ–¹æ³• <strong>willSet</strong> å’Œ <strong>didSet</strong>, ä¸¤è€…åªæ˜¯è°ƒç”¨çš„æ—¶æœºä¸åŒã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Level</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">var</span> highestLevel = <span class="number">1</span></span><br><span class="line">  <span class="keyword">let</span> id: <span class="type">Int</span></span><br><span class="line">  <span class="keyword">var</span> boss: <span class="type">String</span></span><br><span class="line">  <span class="keyword">var</span> unlocked: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">didSet</span> &#123;</span><br><span class="line">    <span class="comment">// å½“å…³å¡å·²è§£é”ï¼Œå½“å‰æ‰€åœ¨å…³å¡å¤§äºå·²è®°å½•çš„æœ€é«˜å…³å¡æ—¶ï¼Œæ›´æ–°æœ€é«˜å…³å¡çš„å€¼</span></span><br><span class="line">      <span class="keyword">if</span> unlocked &amp;&amp; id &gt; <span class="type">Level</span>.highestLevel &#123;</span><br><span class="line">        <span class="type">Level</span>.highestLevel = id</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå½“è§£é”æ–°çš„å…³å¡æ—¶ï¼Œæœ€é«˜å…³å¡çš„å€¼å°±ä¼šè‡ªåŠ¨æ›´æ–°ã€‚æ³¨æ„ <strong>willSet</strong> å’Œ <strong>didSet</strong> å¹¶ä¸ä¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œåªæœ‰åœ¨å®Œæˆåˆå§‹åŒ–ä»¥åï¼Œå†æ›´æ”¹å±æ€§çš„å€¼ï¼Œæ‰ä¼šè¢«è°ƒç”¨ã€‚</p><h3 id="Limiting-a-variable"><a href="#Limiting-a-variable" class="headerlink" title="Limiting a variable"></a>Limiting a variable</h3><p>å±æ€§è§‚å¯Ÿå™¨è¿˜å¯ä»¥ç”¨æ¥çº¦æŸå±æ€§çš„å€¼ï¼Œå½“è®¾ç½®çš„å€¼ä¸ç¬¦åˆè¦æ±‚æ—¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚didSet ä¸­æœ‰ä¸ª <strong>oldValue</strong> è¡¨ç¤ºæ”¹å˜ä¹‹å‰çš„å€¼ï¼ŒwillSet ä¸­æœ‰ä¸ª <strong>newValue</strong> è¡¨ç¤ºæ–°çš„å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LightBulb</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">let</span> maxCurrent = <span class="number">40</span></span><br><span class="line">  <span class="keyword">var</span> current = <span class="number">0</span> &#123;</span><br><span class="line">    <span class="keyword">didSet</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> current &gt; <span class="type">LightBulb</span>.maxCurrent &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Current too high, falling back to previous setting."</span>)</span><br><span class="line">        current = oldValue</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å½“è®¾ç½®ä¸æ»¡è¶³æ¡ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œç›¸åº”å¤„ç†</span></span><br><span class="line"><span class="keyword">var</span> light = <span class="type">LightBulb</span>()</span><br><span class="line">light.current = <span class="number">50</span></span><br><span class="line"><span class="keyword">var</span> current = light.current <span class="comment">// 0</span></span><br><span class="line">light.current = <span class="number">40</span></span><br><span class="line">current = light.current <span class="comment">// 40</span></span><br></pre></td></tr></table></figure><h2 id="Lazy-properties"><a href="#Lazy-properties" class="headerlink" title="Lazy properties"></a>Lazy properties</h2><p>å¦‚æœæœ‰ä¸€äº›å±æ€§ï¼Œåˆå§‹åŒ–çš„æ—¶å€™å¹¶ä¸éœ€è¦çŸ¥é“å®ƒä»¬çš„å€¼ï¼Œè€Œåªåœ¨éœ€è¦çš„æ—¶å€™æ‰è¿›è¡Œè®¡ç®—ï¼Œå°±å¯ä»¥ä½¿ç”¨ <strong>Lazy Property</strong> ã€‚ä¸‹é¢å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ Circle è¿›è¡Œè¯´æ˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Circle</span> </span>&#123;</span><br><span class="line">  <span class="built_in">lazy</span> <span class="keyword">var</span> pi = &#123;</span><br><span class="line">    <span class="keyword">return</span> ((<span class="number">4.0</span> * atan(<span class="number">1.0</span> / <span class="number">5.0</span>)) - atan(<span class="number">1.0</span> / <span class="number">239.0</span>)) * <span class="number">4.0</span></span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="keyword">var</span> radius = <span class="number">0.0</span></span><br><span class="line">  <span class="keyword">var</span> circumference: <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">get</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> pi * radius * <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰äº†init</span></span><br><span class="line">  <span class="keyword">init</span> (radius: <span class="type">Double</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.radius = radius</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç»“æ„ä½“ Circle ä¸­å®šä¹‰äº†ä¸€ä¸ª Lazy Property, æ³¨æ„ Lazy Property å¿…é¡»æ˜¯ä¸€ä¸ªå˜é‡ <strong>var</strong>, ä¸Šé¢çš„ pi çš„è®¡ç®—æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œæ‰€ä»¥åé¢æœ‰ä¸€å¯¹å°æ‹¬å·ï¼Œå½“è®¿é—® pi çš„å€¼æ—¶ï¼Œé—­åŒ…ä¼šè¢«ç«‹å³è°ƒç”¨ã€‚å®ä¾‹åŒ– Circle çš„æ—¶å€™ï¼Œå°½ç®¡ pi æ˜¯å­˜å‚¨å±æ€§ï¼Œä½†å¹¶ä¸éœ€è¦æä¾› pi çš„å€¼ï¼Œpi çš„å€¼ä¼šåœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶å€™è®¡ç®—å¹¶å­˜å‚¨èµ·æ¥ã€‚ä¸ä¹‹å¯¹æ¯”ï¼Œå±æ€§ circumference æ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œæ¯æ¬¡è®¿é—®å®ƒçš„å€¼éƒ½éœ€è¦è®¡ç®—ã€‚æ³¨æ„ circumference å±æ€§çš„ <strong>getter</strong> å‰æœ‰ä¸€ä¸ª <strong>mutating</strong> å…³é”®å­—ï¼Œå› ä¸ºåœ¨ <strong>getter</strong> ä¸­ä½¿ç”¨äº† pi, åœ¨è·å– circumference çš„æ—¶å€™ä¼šå¯¼è‡´ pi è¢«è®¡ç®—ï¼Œè€ŒåŸæ¥å®ä¾‹åœ¨åˆå§‹åŒ–çš„æ—¶å€™å¹¶æ²¡æœ‰è®¾ç½® pi çš„å€¼ï¼Œæ‰€ä»¥å®ä¾‹å‘ç”Ÿäº†æ”¹å˜ï¼Œä»è€Œéœ€è¦ <strong>mutating</strong> å…³é”®å­—ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> circle = <span class="type">Circle</span>(radius: <span class="number">5</span>) <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ª Circle, æ­¤æ—¶ pi è¿˜æ²¡æœ‰è¢«è®¡ç®—</span></span><br><span class="line"><span class="keyword">let</span> circumference = circle.circumference <span class="comment">// 31.42, æ­¤æ—¶ pi ä¹Ÿæœ‰äº†å€¼</span></span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Swift </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swift </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>iOSä¸­ä½¿ç”¨å¤–éƒ¨å­—ä½“</title>
      <link href="/cactus-light/2016/11/04/iOS%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%A4%96%E9%83%A8%E5%AD%97%E4%BD%93/"/>
      <url>/cactus-light/2016/11/04/iOS%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%A4%96%E9%83%A8%E5%AD%97%E4%BD%93/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ iOS é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†å¤–éƒ¨å­—ä½“ï¼Œæ‰€ä»¥ç®€å•è®°å½•ä¸€ä¸‹ã€‚ä½¿ç”¨å¤–éƒ¨é™æ€å­—ä½“åŸºæœ¬ä¸Šåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p>1.å°†è¦ä½¿ç”¨çš„ ttf æˆ– otf å­—ä½“æ–‡ä»¶å¯¼å…¥åˆ°é¡¹ç›®ä¸­</p><p>2.åœ¨ info.plist æ–‡ä»¶ä¸­ä½¿ç”¨ <strong>Fonts provided by application</strong> é…ç½®å­—ä½“çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/tips/iOS%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%A4%96%E9%83%A8%E5%AD%97%E4%BD%93_01.jpg" alt=""></p><p>3.åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ä»¥ä¸‹ä»£ç è®¾ç½®å­—ä½“ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ xib æˆ–è€… storyboard ä¸­é€‰æ‹©å¯¼å…¥çš„å­—ä½“</p><a id="more"></a><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.label.font = [<span class="built_in">UIFont</span> fontWithName:<span class="string">@"Ubuntu-B"</span> size:<span class="number">16</span>];</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ‰“å°æ‰€æœ‰å¯ä»¥çš„å­—ä½“çš„ä¿¡æ¯ï¼š</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">NSString</span> *fontFamilyName <span class="keyword">in</span> [<span class="built_in">UIFont</span> familyNames]) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"family: %@"</span>,fontFamilyName);</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *fontName <span class="keyword">in</span> [<span class="built_in">UIFont</span> fontNamesForFamilyName:fontFamilyName]) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"fontName: %@"</span>, fontName);        </span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"---------"</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>4.å‡å¦‚ä»¥ä¸Šè®¾ç½®å®Œæˆä»¥åï¼Œä»ç„¶æ²¡æœ‰é¢„æœŸçš„æ•ˆæœï¼Œé‚£ä¹ˆè¯·åœ¨ <strong>Build Phases</strong> çš„ <strong>Copy Bundle Resources</strong>ä¸­æ·»åŠ å¯¼å…¥çš„å­—ä½“</p><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/tips/iOS%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%A4%96%E9%83%A8%E5%AD%97%E4%BD%93_02.jpg" alt=""></p>]]></content>
      
      <categories>
          
          <category> çŸ¥è¯†å°é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tips </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Autolayoutæ€»ç»“</title>
      <link href="/cactus-light/2016/03/10/Autolayout%E6%80%BB%E7%BB%93/"/>
      <url>/cactus-light/2016/03/10/Autolayout%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<h2 id="Autolayout"><a href="#Autolayout" class="headerlink" title="Autolayout"></a>Autolayout</h2><p>æœ€è¿‘ä¸¤å¤©çœ‹äº†å‡ ç¯‡åšå®¢ï¼ŒæŸ¥äº†ç›¸å…³çš„æ–‡æ¡£ï¼Œè®¤çœŸç ”ç©¶äº†ä¸€ä¸‹ Autolayoutã€‚å¾ˆéš¾æƒ³è±¡æˆ‘è‡ªå­¦ iOS è¿™ä¹ˆä¹…ä¸€ç›´éƒ½æ²¡æœ‰ç³»ç»Ÿåœ°ç ”ç©¶ Autolayoutã€‚å› æ­¤å†³å®šå†™ä¸ªæ€»ç»“ã€‚éšç€è‹¹æœçš„äº§å“çº¿çš„æ‰©å±•ï¼Œå±å¹•å°ºå¯¸è¶Šæ¥è¶Šå¤šï¼ŒAutolayout çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³ä¸åŒå°ºå¯¸çš„å±å¹•çš„é€‚é…é—®é¢˜ï¼Œè¿˜æœ‰åæ¥çš„ sizeclass æŠ€æœ¯ï¼Œæœ‰å…³ sizeclass çš„ä½¿ç”¨å°†åœ¨å¦å¤–çš„æ–‡ç« ä¸­è¿›è¡Œæè¿°ã€‚Autolayout çš„å®ç°æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œè‹¹æœæœ€åˆçš„ APIï¼Œä¹‹åçš„ VFLï¼Œstoryboard ä»¥åŠç¬¬ä¸‰æ–¹çš„ Masonryã€‚    </p><a id="more"></a>    <p>åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆç»™ Autolayout ä¸€ä¸ªæ€»ç»“ï¼Œè¿™ä¸ªæ€»ç»“å°†è´¯ç©¿å…¨æ–‡ã€‚</p><ul><li>Autolayout é‡Œæœ‰ä¸¤ä¸ªè¯ï¼Œ<strong>çº¦æŸ</strong>å’Œ<strong>å‚ç…§</strong></li><li>è¦æƒ³æ˜¾ç¤ºä¸€ä¸ªæ§ä»¶ï¼Œéœ€è¦çŸ¥é“ä¸¤ä¸ªä¸œè¥¿ï¼Œ<strong>ä½ç½®</strong>å’Œ<strong>å°ºå¯¸</strong>ï¼Œå¯¹åº”äºä»¥å‰ frame çš„ origin å’Œ size</li><li>æ·»åŠ çš„çº¦æŸä¸å®œè¿‡å¤šï¼Œå½“çº¦æŸè¶³ä»¥ç¡®å®šæ§ä»¶çš„<strong>ä½ç½®</strong>å’Œ<strong>å°ºå¯¸</strong>ï¼Œå°±è¶³å¤Ÿäº†</li><li><strong>çº¦æŸ</strong>å°±æ˜¯å¯¹æ§ä»¶çš„å¤§å°æˆ–ä½ç½®è¿›è¡Œçº¦æŸï¼Œ<strong>å‚ç…§</strong>å°±æ˜¯ä»¥æŸä¸ªæ§ä»¶çš„ä½ç½®è¿›è¡Œçº¦æŸï¼Œä¸¤è€…å¹¶æ²¡æœ‰æ˜ç¡®çš„åŒºåˆ«ï¼Œå®ƒä»¬éƒ½å¯ä»¥å¯¹æ§ä»¶çš„<strong>ä½ç½®</strong>å’Œ<strong>å°ºå¯¸</strong>èµ·åˆ°ä½œç”¨</li><li>æ‰€æœ‰æ§ä»¶ï¼Œéƒ½ç¦»ä¸å¼€<strong>ä½ç½®</strong>å’Œ<strong>å°ºå¯¸</strong>ï¼ŒAutolayout å°±æ˜¯å¹²è¿™ä¸ªçš„ï¼Œåé¢çš„ä¾‹å­ä»¥UIViewä¸ºä¾‹</li></ul><h2 id="ä»£ç å®ç°Autolayout"><a href="#ä»£ç å®ç°Autolayout" class="headerlink" title="ä»£ç å®ç°Autolayout"></a>ä»£ç å®ç°Autolayout</h2><ul><li><p>å…ˆä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹å­¦ä¹ é€šè¿‡ Autolayout ä»£ç æ¥å®Œæˆä¸€ä¸ªæ§ä»¶çš„<strong>ä½ç½®</strong>å’Œ<strong>å°ºå¯¸</strong></p></li><li><p>æˆ‘è¦åœ¨ç•Œé¢çš„å·¦ä¸‹æ–¹æ”¾ç½®ä¸€ä¸ªå®½é«˜å„ä¸º50çš„çº¢è‰² Viewï¼Œå®ƒè·ç¦»å±å¹•å·¦è¾¹ç¼˜å’Œä¸‹è¾¹ç¼˜è·ç¦»éƒ½æ˜¯20</p></li><li><p>åœ¨æ­¤ä¹‹å‰å…ˆä»‹ç»ä¸€ä¸ªæ–¹æ³•</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  è¿™ä¸ªæ˜¯ç³»ç»Ÿé»˜è®¤æ·»åŠ çº¦æŸçš„æ–¹æ³•ï¼Œå®ƒæ˜¯NSLayoutConstraintçš„ç±»æ–¹æ³•</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  @param view1      ä¼ å…¥æƒ³è¦æ·»åŠ çº¦æŸçš„æ§ä»¶</span></span><br><span class="line"><span class="comment">*  @param attr1      ä¼ å…¥æƒ³è¦æ·»åŠ çº¦æŸçš„æ–¹å‘ï¼Œè¿™ä¸ªæšä¸¾å€¼æœ‰å¾ˆå¤šï¼Œå¯ä»¥è‡ªå·±çœ‹çœ‹</span></span><br><span class="line"><span class="comment">*  @param relation   ä¼ å…¥ä¸çº¦æŸå€¼çš„å…³ç³»ï¼Œå¤§äºï¼Œç­‰äºè¿˜æ˜¯å°äº</span></span><br><span class="line"><span class="comment">*  @param view2      ä¼ å…¥è¢«å‚ç…§å¯¹è±¡</span></span><br><span class="line"><span class="comment">*  @param attr2      ä¼ å…¥è¢«å‚ç…§å¯¹è±¡æ‰€è¢«å‚ç…§çš„æ–¹å‘ï¼Œå¦‚é¡¶éƒ¨ï¼Œå·¦è¾¹ï¼Œå³è¾¹ç­‰ç­‰</span></span><br><span class="line"><span class="comment">*  @param multiplier ä¼ å…¥æƒ³è¦çš„é—´è·å€æ•°å…³ç³»</span></span><br><span class="line"><span class="comment">*  @param c          ä¼ å…¥æœ€ç»ˆçš„å·®å€¼</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  @return NSLayoutConstraintå¯¹è±¡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">+(<span class="keyword">instancetype</span>)constraintWithItem:(<span class="keyword">id</span>)view1 attribute:(<span class="built_in">NSLayoutAttribute</span>)attr1 relatedBy:(<span class="built_in">NSLayoutRelation</span>)relation toItem:(<span class="keyword">id</span>)view2 attribute:(<span class="built_in">NSLayoutAttribute</span>)attr2 multiplier:(<span class="built_in">CGFloat</span>)multiplier constant:(<span class="built_in">CGFloat</span>)c</span><br><span class="line"><span class="comment">//ä¸€éƒ¨åˆ†NSLayoutAttributeçš„æšä¸¾å€¼</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeLeft</span> = <span class="number">1</span>,<span class="comment">//æ§ä»¶å·¦è¾¹</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeRight</span>,<span class="comment">//æ§ä»¶å³è¾¹</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeTop</span>,<span class="comment">//æ§ä»¶ä¸Šè¾¹</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeBottom</span>,<span class="comment">//æ§ä»¶ä¸‹è¾¹</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeLeading</span>,<span class="comment">//æ§ä»¶å·¦è¾¹</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeTrailing</span>,<span class="comment">//æ§ä»¶å³è¾¹</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeWidth</span>,<span class="comment">//æ§ä»¶çš„å®½</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeHeight</span>,<span class="comment">//æ§ä»¶çš„é«˜</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeCenterX</span>,<span class="comment">//ç«–ç›´æ–¹å‘çš„ä¸­ç‚¹</span></span><br><span class="line"><span class="built_in">NSLayoutAttributeCenterY</span>,<span class="comment">//æ°´å¹³æ–¹å‘çš„ä¸­ç‚¹</span></span><br><span class="line"><span class="comment">//ä¸‹é¢çœ‹å…·ä½“çš„ç”¨æ³•</span></span><br><span class="line"><span class="comment">//åˆ›å»ºredView</span></span><br><span class="line"><span class="built_in">UIView</span> *redView = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">redView.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">redView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:redView];    </span><br><span class="line"><span class="comment">//1.åˆ›å»ºredViewçš„ç¬¬ä¸€ä¸ªçº¦æŸï¼Œç›¸å¯¹self.viewçš„å·¦è¾¹ç¼˜é—´è·ä¸º20</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *redLeftC = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:redView attribute:<span class="built_in">NSLayoutAttributeLeft</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.view attribute:<span class="built_in">NSLayoutAttributeLeft</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">20.0</span>f];</span><br><span class="line"><span class="comment">//åªæœ‰åœ¨æ²¡æœ‰å‚ç…§æ§ä»¶çš„æ—¶å€™ï¼Œçº¦æŸæ‰åŠ åˆ°è‡ªå·±èº«ä¸Šï¼Œå¦åˆ™åŠ åˆ°çˆ¶æ§ä»¶ä¸Š</span></span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:redLeftC];</span><br><span class="line"><span class="comment">//2.åˆ›å»ºredViewçš„ç¬¬äºŒä¸ªçº¦æŸï¼Œç›¸å¯¹self.viewçš„åº•è¾¹ç¼˜é—´è·ä¸º20</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *redBottomC = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:redView attribute:<span class="built_in">NSLayoutAttributeBottom</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.view attribute:<span class="built_in">NSLayoutAttributeBottom</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">-20.0</span>f];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:redBottomC];</span><br><span class="line"><span class="comment">//åˆ›å»ºredViewçš„ç¬¬ä¸‰ä¸ªçº¦æŸï¼Œè®¾ç½®è‡ªèº«çš„å®½ï¼Œå®½å¯ä»¥å‚ç…§å…¶å®ƒæ§ä»¶è¿›è¡Œè®¾ç½®ï¼Œæ¯”å¦‚self.viewçš„ä¸€åŠ</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeWidth relatedBy:NSLayoutRelationEqual toItem:self.view attribute:NSLayoutAttributeWidth multiplier:0.5f constant:0.0f];</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//3.è¿™é‡Œç›´æ¥è®¾ç½®å®½ä¸º50</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *redWidthC = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:redView attribute:<span class="built_in">NSLayoutAttributeWidth</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="literal">nil</span> attribute:<span class="built_in">NSLayoutAttributeNotAnAttribute</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">50.0</span>f];</span><br><span class="line"><span class="comment">//ç”±äºæ²¡æœ‰å‚ç…§ç‰©ï¼Œçº¦æŸåŠ åˆ°è‡ªå·±èº«ä¸Š</span></span><br><span class="line">[redView addConstraint:redWidthC];</span><br><span class="line"><span class="comment">//4.åˆ›å»ºæœ€åä¸€ä¸ªçº¦æŸï¼Œè‡ªèº«çš„é«˜</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *redHeightC = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:redView attribute:<span class="built_in">NSLayoutAttributeHeight</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="literal">nil</span> attribute:<span class="built_in">NSLayoutAttributeNotAnAttribute</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">50.0</span>f];</span><br><span class="line"><span class="comment">//ç”±äºæ²¡æœ‰å‚ç…§ç‰©ï¼Œçº¦æŸåŠ åˆ°è‡ªå·±èº«ä¸Š</span></span><br><span class="line">[redView addConstraint:redHeightC];</span><br><span class="line"><span class="comment">//è¿™æ—¶å€™ï¼ŒredViewçš„ä½ç½®å’Œå°ºå¯¸éƒ½å¯ä»¥ç¡®å®šäº†ï¼Œå¦‚ä¸‹å›¾</span></span><br></pre></td></tr></table></figure><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/cocoa/Autolayout%E6%80%BB%E7%BB%93_01.jpg" width="320" height="568" align="center"></p></li><li><p>ç°åœ¨ç»§ç»­å¢åŠ éœ€æ±‚ï¼Œæˆ‘ä»¬åœ¨çº¢è‰²æ–¹å—å³è¾¹ç¦»å®ƒ20é—´è·ï¼Œç¦» self.view åº•éƒ¨ä¹Ÿ20ä¸ªé—´è·ï¼Œæ”¾ç½®ä¸€ä¸ªå®½é«˜ç›¸ç­‰çš„è“è‰²æ–¹å—</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…ˆåˆ›å»ºä¸€ä¸ªè“è‰²çš„è§†å›¾</span></span><br><span class="line"><span class="built_in">UIView</span> *blueView = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">blueView.backgroundColor = [<span class="built_in">UIColor</span> blueColor];</span><br><span class="line">blueView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:blueView];</span><br><span class="line"><span class="comment">//1.åˆ›å»ºç¬¬ä¸€ä¸ªçº¦æŸï¼Œå·¦è¾¹é—´è·ï¼Œç”±äºæ˜¯æƒ³è¦ä¸çº¢è‰²æœ‰20çš„é—´è·ï¼Œé‚£ä¹ˆå‚æ•°"toItem"å°±åº”è¯¥å¡«redView</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *blueLeft = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:blueView attribute:<span class="built_in">NSLayoutAttributeLeft</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:redView attribute:<span class="built_in">NSLayoutAttributeRight</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">20.0</span>f];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:blueLeft];</span><br><span class="line"><span class="comment">//2.åˆ›å»ºç¬¬äºŒä¸ªçº¦æŸï¼Œåº•è¾¹çº¦æŸï¼Œç”±äºæ˜¯æƒ³ä¸åº•è¾¹æœ‰20çš„é—´è·ï¼Œæ¯”self.viewçš„åæ ‡å°ï¼Œæ‰€ä»¥ä¸º-20</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *blueBottom = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:blueView attribute:<span class="built_in">NSLayoutAttributeBottom</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.view attribute:<span class="built_in">NSLayoutAttributeBottom</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">-20.0</span>f];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:blueBottom];</span><br><span class="line"><span class="comment">//3.åˆ›å»ºç¬¬ä¸‰ä¸ªçº¦æŸï¼Œç¡®å®šè“è‰²è§†å›¾çš„å®½</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *blueWidth = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:blueView attribute:<span class="built_in">NSLayoutAttributeWidth</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:redView attribute:<span class="built_in">NSLayoutAttributeWidth</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">0.0</span>f];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:blueWidth];</span><br><span class="line"><span class="comment">//4.åˆ›å»ºç¬¬å››ä¸ªçº¦æŸï¼Œç¡®å®šè“è‰²è§†å›¾çš„é«˜</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *blueHeight = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:blueView attribute:<span class="built_in">NSLayoutAttributeHeight</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:redView attribute:<span class="built_in">NSLayoutAttributeHeight</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">0.0</span>f];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:blueHeight];</span><br></pre></td></tr></table></figure><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/cocoa/Autolayout%E6%80%BB%E7%BB%93_02.jpg" width="320" height="568" align="center"></p></li><li><p>å…¶å® Autolayout çš„æ€æƒ³è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œåˆšå¼€å§‹ä½¿ç”¨çš„æ—¶å€™ä¸è¦æƒ³ç€ä¸€æ°”å‘µæˆï¼Œå¯ä»¥ä¸€ä¸ªæ§ä»¶ä¸€ä¸ªæ§ä»¶çš„å®ç°ä¾èµ–ï¼Œåˆ†åˆ«æ»¡è¶³å…¶ä½ç½®å’Œå°ºå¯¸çš„éœ€æ±‚ï¼Œå¦‚æœå‡ ä¸ªæ§ä»¶ä¸€èµ·å¼„å¾—è¯ï¼Œéœ€è¦æ€è·¯éå¸¸æ¸…æ™°ï¼Œå¾€å¾€å¤§å®¶çŠ¯é”™æ˜¯å› ä¸ºçº¦æŸåŠ å¤šäº†ï¼Œè€Œä¸æ˜¯åŠ å°‘äº†</p></li><li><p>å°±å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå¾ˆå¤šäººåœ¨è®¾ç½®äº†ä¸çº¢è‰²ç­‰é«˜ç­‰å®½ä»¥åï¼Œè¿˜åŒæ—¶è®¾ç½®é¡¶éƒ¨å’Œåº•éƒ¨å¯¹é½ï¼Œè¿™æ ·é«˜åº¦å°±é‡å¤è®¾ç½®äº†ã€‚å› ä¸ºä¸Šä¸‹åŒæ—¶å¯¹é½ä¸ä»…ç»™äºˆäº†å‚ç›´ä½ç½®ï¼Œä¹Ÿç»™äºˆäº†é«˜åº¦ï¼Œæ‰€ä»¥æ€è·¯å¿…é¡»æ¸…æ™°ã€‚</p></li></ul><h2 id="AutolayoutåŠ¨ç”»"><a href="#AutolayoutåŠ¨ç”»" class="headerlink" title="AutolayoutåŠ¨ç”»"></a>AutolayoutåŠ¨ç”»</h2><ul><li><p>æœ€ååœ¨åŸæ¥çš„ä¾‹å­ä¸Šåšä¸ªå°åŠ¨ç”»ï¼Œè®©å¤§å®¶äº†è§£ Autolayout æ˜¯æ€ä¹ˆåšåŠ¨ç”»çš„</p></li><li><p>éœ€æ±‚ï¼šå°†åœ¨è“è‰²æ–¹å—çš„å³è¾¹å†åŠ ä¸ªåŒæ ·å¤§å°çš„é»„è‰²æ–¹å—ï¼Œç„¶åè¦æ±‚ç‚¹å‡»å±å¹•ï¼Œè“è‰²çš„æ–¹å—è¢«ç§»é™¤ï¼Œé»„è‰²æ–¹å—å–ä»£è“è‰²æ–¹å—çš„ä½ç½®</p></li><li><p>è¿™ä¸ªä¾‹å­ä¸»è¦æ¶‰åŠåˆ° Autolayout çš„å¦ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š<strong>ä¼˜å…ˆçº§(priority)</strong></p></li><li><p>å¥½äº†ï¼Œä¸‹é¢æ·»åŠ é»„è‰²çš„æ–¹å—</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…ˆæ·»åŠ é»„è‰²View</span></span><br><span class="line"><span class="built_in">UIView</span> *yellowView = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">yellowView.backgroundColor = [<span class="built_in">UIColor</span> yellowColor];</span><br><span class="line">yellowView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:yellowView];</span><br><span class="line"><span class="comment">//1.åˆ›å»ºç¬¬ä¸€ä¸ªçº¦æŸï¼Œå·¦è¾¹é—´è·</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *yellowLeft = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:yellowView attribute:<span class="built_in">NSLayoutAttributeLeft</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:blueView attribute:<span class="built_in">NSLayoutAttributeRight</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">20.0</span>f];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:yellowLeft];</span><br><span class="line"><span class="comment">//2.åˆ›å»ºç¬¬äºŒä¸ªçº¦æŸï¼Œåº•éƒ¨é—´è·</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *yellowBottom = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:yellowView attribute:<span class="built_in">NSLayoutAttributeBottom</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.view attribute:<span class="built_in">NSLayoutAttributeBottom</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">-20.0</span>f];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:yellowBottom];</span><br><span class="line"><span class="comment">//3.åˆ›å»ºç¬¬ä¸‰ä¸ªçº¦æŸï¼Œå®½åº¦</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *yellowWidth = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:yellowView attribute:<span class="built_in">NSLayoutAttributeWidth</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="literal">nil</span> attribute:<span class="built_in">NSLayoutAttributeNotAnAttribute</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">50.0</span>f];</span><br><span class="line">[yellowView addConstraint:yellowWidth];</span><br><span class="line"><span class="comment">//4.åˆ›å»ºç¬¬å››ä¸ªçº¦æŸï¼Œé«˜åº¦</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *yellowHeight = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:yellowView attribute:<span class="built_in">NSLayoutAttributeHeight</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="literal">nil</span> attribute:<span class="built_in">NSLayoutAttributeNotAnAttribute</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">50.0</span>f];</span><br><span class="line">[yellowView addConstraint:yellowHeight];</span><br></pre></td></tr></table></figure><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/cocoa/Autolayout%E6%80%BB%E7%BB%93_03.jpg" width="320" height="568" align="center"></p></li><li><p>æ¥ä¸‹æ¥ç»™é»„è‰²æ·»åŠ ä¸€ä¸ªçº¦æŸï¼Œè¿™ä¸ªçº¦æŸæ¶‰åŠåˆ°ä¼˜å…ˆçº§ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.yellowViewåˆ›å»ºå¦ä¸€ä¸ªå·¦è¾¹çº¦æŸ</span></span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *yellowAnotherLeft = [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:yellowView attribute:<span class="built_in">NSLayoutAttributeLeft</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:redView attribute:<span class="built_in">NSLayoutAttributeRight</span> multiplier:<span class="number">1.0</span>f constant:<span class="number">20.</span>f];</span><br><span class="line"><span class="comment">//2.è®¾ç½®ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="built_in">UILayoutPriority</span> priority = <span class="number">250</span>;</span><br><span class="line">yellowAnotherLeft.priority = priority;</span><br><span class="line"><span class="comment">//3.çº¦æŸæ·»åŠ åˆ°çˆ¶è§†å›¾ä¸Š</span></span><br><span class="line">[<span class="keyword">self</span>.view addConstraint:yellowAnotherLeft];</span><br></pre></td></tr></table></figure></li><li><p>çº¦æŸçš„ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯0~1000ï¼Œæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œåœ¨ä¸è®¾ç½®çš„æƒ…å†µä¸‹é»˜è®¤å€¼æ˜¯1000</p></li><li><p>è¿™è¯´æ˜ï¼Œæœ€åæ·»åŠ çš„çº¦æŸçš„ä¼˜å…ˆçº§æ˜¯ä½çš„ï¼Œè¿™ä¸ªçº¦æŸåªæœ‰åœ¨å®ƒçš„å†²çªçº¦æŸè¢«æŠ¹æ‰ä»¥åï¼Œå®ƒæ‰èƒ½å®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æŠŠè“è‰² view ç§»é™¤ä»¥åï¼Œé»„è‰² viewç›¸å¯¹äºè“è‰² view å·¦é—´è·20è¿™ä¸ªçº¦æŸå°±ä¸æˆç«‹äº†ï¼Œé‚£ä¹ˆé»„è‰² view ä¼šè‡ªåŠ¨åœ°å˜ä¸ºä¸çº¢è‰² view çš„é—´è·ä¸º20</p><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/cocoa/Autolayout%E6%80%BB%E7%BB%93_04.jpg" width="320" height="568" align="center"></p></li></ul><ul><li><p>æœ€ååŠ å‡ è¡Œä»£ç æ¥å®ç°è¿™ä¸ªåŠ¨ç”»å§</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event&#123;</span><br><span class="line"><span class="comment">//1.å…ˆæŠŠè“è‰²ä»çˆ¶è§†å›¾ä¸Šç§»é™¤</span></span><br><span class="line">    [<span class="keyword">self</span>.blueView removeFromSuperview];</span><br><span class="line">    <span class="comment">//2.é‡æ–°å¸ƒå±€é¡µé¢</span></span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">1.0</span> animations:^&#123;</span><br><span class="line">        [<span class="keyword">self</span>.view layoutIfNeeded];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="VFLå®ç°Autolayout"><a href="#VFLå®ç°Autolayout" class="headerlink" title="VFLå®ç°Autolayout"></a>VFLå®ç°Autolayout</h2><ul><li><p>ä¹‹å‰ä»‹ç»äº†ä½¿ç”¨è‹¹æœåŸå§‹ API å®ç° Autolayoutï¼Œç°åœ¨ä»‹ç»ä½¿ç”¨ VFL (Visual Format Language) æ¥å®ç° Autolayout</p></li><li><p>VFL çš„æ€æƒ³ä¸å…¶å®ƒçš„å®ç°æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œå®ƒæ›´ä¸ºå®è§‚åŒ–ï¼Œå®ƒå°†çº¦æŸåˆ†æˆäº†ä¸¤å—ï¼š<strong>æ°´å¹³æ–¹å‘ (H:) </strong>å’Œ<strong>å‚ç›´æ–¹å‘ (V:)</strong></p></li><li><p>ä¹Ÿå°±æ˜¯è¯´åœ¨åˆ›å»ºçº¦æŸçš„æ—¶å€™ï¼Œå¾—æŠŠæ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘ç”¨å­—ç¬¦ä¸²ä¸€å¹¶è¡¨ç¤ºå‡ºæ¥è€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„æ·»åŠ </p></li><li><p>ä¸‹é¢çœ‹ VFL çš„ APIï¼Œå®ƒçš„ API çŸ­äº†ä¸€äº›ï¼Œä½†æ˜¯è¦ç­¹é½å‚æ•°æ˜¯ä»¶å¾ˆéº»çƒ¦çš„äº‹æƒ…</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  VFLåˆ›å»ºçº¦æŸçš„API</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  @param format  ä¼ å…¥æŸç§æ ¼å¼æ„æˆçš„å­—ç¬¦ä¸²ï¼Œç”¨ä»¥è¡¨è¾¾æƒ³è¦æ·»åŠ çš„çº¦æŸï¼Œå¦‚@"H:|-margin-[redView(50)]"ï¼Œæ°´å¹³æ–¹å‘ä¸Šï¼ŒredViewä¸çˆ¶æ§ä»¶å·¦è¾¹ç¼˜ä¿æŒâ€œmarginâ€é—´è·ï¼ŒredViewçš„å®½ä¸º50</span></span><br><span class="line"><span class="comment">*  @param opts    å¯¹é½æ–¹å¼ï¼Œæ˜¯ä¸ªæšä¸¾å€¼</span></span><br><span class="line"><span class="comment">*  @param metrics ä¸€èˆ¬ä¼ å…¥ä»¥é—´è·ä¸ºKEYçš„å­—å…¸ï¼Œå¦‚ï¼š @&#123; @"margin":@20&#125;ï¼ŒKEYè¦ä¸formatå‚æ•°é‡Œæ‰€å¡«å†™çš„â€œmarginâ€ç›¸åŒ</span></span><br><span class="line"><span class="comment">*  @param views   ä¼ å…¥çº¦æŸä¸­æåˆ°çš„Viewï¼Œä¹Ÿæ˜¯è¦ä¼ å…¥å­—å…¸ï¼Œä½†æ˜¯KEYä¸€å®šè¦å’Œformatå‚æ•°é‡Œæ‰€å¡«å†™çš„Viewåå­—ç›¸åŒï¼Œå¦‚ï¼šä¸Šé¢å¡«çš„æ˜¯redViewï¼Œæ‰€ä»¥KEYæ˜¯@â€œredViewâ€</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  @return è¿”å›çº¦æŸçš„æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span>(<span class="built_in">NSArray</span> *)constraintsWithVisualFormat:(<span class="built_in">NSString</span> *)format options:(<span class="built_in">NSLayoutFormatOptions</span>)opts metrics:(<span class="built_in">NSDictionary</span> *)metrics views:(<span class="built_in">NSDictionary</span> *)views;</span><br><span class="line"><span class="comment">//éƒ¨åˆ†NSLayoutFormatOptionsçš„æšä¸¾é€‰é¡¹</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllLeft = (1 &lt;&lt; NSLayoutAttributeLeft),//å·¦è¾¹ç¼˜å¯¹é½</span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllRight = (1 &lt;&lt; NSLayoutAttributeRight),//å³è¾¹ç¼˜å¯¹é½    </span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllTop = (1 &lt;&lt; NSLayoutAttributeTop),//ä¸Šè¾¹ç¼˜å¯¹é½</span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllBottom = (1 &lt;&lt; NSLayoutAttributeBottom),//ä¸‹è¾¹ç¼˜å¯¹é½</span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllLeading = (1 &lt;&lt; NSLayoutAttributeLeading),//å·¦è¾¹ç¼˜å¯¹é½</span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllTrailing = (1 &lt;&lt; NSLayoutAttributeTrailing),//å³è¾¹ç¼˜å¯¹é½</span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllCenterX = (1 &lt;&lt; NSLayoutAttributeCenterX),//å‚ç›´æ–¹å‘ä¸­å¿ƒå¯¹é½</span></span><br><span class="line"><span class="comment">NSLayoutFormatAlignAllCenterY = (1 &lt;&lt; NSLayoutAttributeCenterY),//æ°´å¹³æ–¹å‘ä¸­å¿ƒå¯¹é½</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li><li><p>é‡Œé¢æœ€é‡è¦çš„å°±æ˜¯ <strong>format</strong> å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°çš„éš¾ç‚¹åœ¨äºå…¶ä¹¦å†™æ ¼å¼</p></li><li><p>é€šè¿‡ä¾‹å­æ¥çœ‹ API çš„ä½¿ç”¨ï¼Œç°åœ¨è¦åœ¨ç•Œé¢ä¸Šæ·»åŠ ä¸€ä¸ªçº¢è‰²çš„æ–¹å—ï¼Œé«˜100ï¼Œå®½50ï¼Œä¸çˆ¶è§†å›¾é¡¶éƒ¨è¾¹ç¼˜å’Œå·¦è¾¹ç¼˜è·ç¦»ä¸º20</p></li><li><p>æ¥çœ‹çœ‹ä»£ç æ˜¯æ€ä¹ˆå®ç°çš„</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">UIView</span> *redView = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">redView.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">redView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:redView];</span><br><span class="line"><span class="comment">//æ¥ä¸‹æ¥å¼€å§‹å†™APIæ‰€éœ€è¦çš„å‚æ•°äº†</span></span><br><span class="line"><span class="comment">//formatå‚æ•°</span></span><br><span class="line"><span class="comment">//Hvflä¸Vvflåˆ†åˆ«æ˜¯æ°´å¹³æ–¹å‘ä¸å‚ç›´æ–¹å‘çš„çº¦æŸï¼Œç­‰ä¸‹ä¹‹åä¼šæœ‰è§£æ</span></span><br><span class="line"><span class="built_in">NSString</span> *Hvfl = <span class="string">@"H:|-margin-[redView(50)]"</span>;</span><br><span class="line"><span class="built_in">NSString</span> *Vvfl = <span class="string">@"V:|-margin-[redView(100)]"</span>;</span><br><span class="line"><span class="comment">//è®¾ç½®marginçš„æ•°å€¼</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *metrics = @&#123; <span class="string">@"margin"</span>:@<span class="number">20</span>&#125;;</span><br><span class="line"><span class="comment">//æŠŠè¦æ·»åŠ çº¦æŸçš„Viewè½¬æˆå­—å…¸</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *views = <span class="built_in">NSDictionaryOfVariableBindings</span>(redView);<span class="comment">//è¿™ä¸ªæ–¹æ³•ä¼šè‡ªåŠ¨æŠŠä¼ å…¥çš„å‚æ•°ä»¥å­—å…¸çš„å½¢å¼è¿”å›ï¼Œå­—å…¸çš„KEYå°±æ˜¯å…¶æœ¬èº«çš„åå­—</span></span><br><span class="line"><span class="comment">//å¦‚@&#123;@"redView"ï¼šredView&#125;</span></span><br><span class="line"><span class="comment">//æ·»åŠ å¯¹é½æ–¹å¼ï¼Œ</span></span><br><span class="line"><span class="built_in">NSLayoutFormatOptions</span> ops = <span class="built_in">NSLayoutFormatAlignAllLeft</span> | <span class="built_in">NSLayoutFormatAlignAllTop</span>;<span class="comment">//å·¦è¾¹ä¸é¡¶éƒ¨</span></span><br><span class="line"><span class="comment">//å‚æ•°å·²ç»è®¾ç½®å®Œäº†ï¼Œæ¥æ”¶è¿”å›çš„æ•°ç»„ï¼Œç”¨ä»¥self.viewæ·»åŠ </span></span><br><span class="line"><span class="built_in">NSArray</span> *Hconstraints = [<span class="built_in">NSLayoutConstraint</span> constraintsWithVisualFormat:Hvfl options:ops metrics:metrics views:views];</span><br><span class="line"><span class="built_in">NSArray</span> *Vconstraints = [<span class="built_in">NSLayoutConstraint</span> constraintsWithVisualFormat:Vvfl options:ops metrics:metrics views:views];</span><br><span class="line"><span class="comment">//self.viewåˆ†åˆ«æ·»åŠ æ°´å¹³ä¸å‚ç›´æ–¹å‘çš„çº¦æŸ</span></span><br><span class="line">[<span class="keyword">self</span>.view addConstraints:Hconstraints];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraints:Vconstraints];</span><br><span class="line"><span class="comment">//è¿è¡Œç»“æœå¦‚ä¸‹å›¾</span></span><br></pre></td></tr></table></figure><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/cocoa/Autolayout%E6%80%BB%E7%BB%93_05.jpg" width="320" height="568" align="center"></p></li><li><p>å¦‚å›¾ï¼Œéœ€æ±‚å·²ç»å®ç°äº†ï¼Œä¸‹é¢è§£é‡Šä¸€ä¸‹<strong>format</strong>é‡Œé¢å¥‡æ€ªçš„è¯­æ³•</p><ul><li>æ¯ä¸ªå‰é¢éƒ½è¦åŠ  <strong>@â€H:â€</strong> æˆ–è€… <strong>@â€V:â€</strong>ï¼Œåˆ†åˆ«è¡¨ç¤ºæ°´å¹³å’Œå‚ç›´æ–¹å‘</li><li><strong>@â€|â€</strong>ä»£è¡¨ç€è¾¹ç•Œï¼Œå¾ˆå½¢è±¡</li><li><strong>@â€-â€œ</strong>ç”¨æ¥è¡¨ç¤ºé—´éš™ï¼Œä¸€èˆ¬ä»¥è¿™æ ·çš„å½¢å¼å‡ºç°<strong>@â€-20-â€œ</strong>ï¼Œè¿™ä»£è¡¨20çš„é—´è·ï¼Œä¹Ÿå¯ä»¥å¡«å†™è¡¨ç¤ºï¼Œå¦‚ <strong>@â€-margin-â€œ</strong>ï¼Œä¹‹åè®¾ç½®æ›¿æ¢å‚æ•° <strong>metrics**</strong></li><li><strong>@â€[]â€</strong>ä¸­æ‹¬å·é‡Œæ”¾çš„æ˜¯è¦æ·»åŠ çº¦æŸçš„ Viewï¼Œå¦‚ä¸Šè¾¹ä¾‹å­çš„ <strong>redView</strong>ï¼Œè¦æƒ³è®¾ç½®å®½åº¦å’Œé«˜åº¦å°±è¿™æ · <strong>[redView(50)]</strong>ï¼Œæ°´å¹³æ–¹å‘ä¸Š <strong>(H:)</strong> è¡¨ç¤ºçš„æ•°å­—æ˜¯å®½ï¼Œå‚ç›´æ–¹å‘ä¸Š <strong>(V:)</strong> è¡¨ç¤ºçš„æ•°å­—æ˜¯é«˜</li></ul></li><li><p>åŸºæœ¬çš„ç”¨æ³•å°±æ˜¯è¿™æ ·ï¼Œæ›´å¤šçš„ä¸œè¥¿è¦åœ¨ä»£ç ä¸­ä½“ä¼šï¼Œç°åœ¨åšä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­å’Œä»¥å‰ä½¿ç”¨è‹¹æœåŸå§‹ APIå®ç°çš„ä¾‹å­ä¸€æ ·ï¼Œå°±æ˜¯åœ¨è·ç¦» self.view çš„åº•éƒ¨20é—´è·çš„åœ°æ–¹æ”¾ç½®3ä¸ªæ–¹å—ï¼Œçº¢ã€è“ã€é»„åˆ†åˆ«é—´è·20ï¼Œå®½é«˜ç›¸åŒï¼Œéƒ½ä¸º50</p></li><li><p>æ¥ä¸‹æ¥çœ‹ä»£ç </p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//translatesAutoresizingMaskIntoConstraintså±æ€§è®¾ç½®ä¸ºNOï¼Œé˜²æ­¢è‹¹æœæŠŠé»˜è®¤è®¾ç½®çš„Autoresizingå±æ€§è½¬æˆAutolayoutï¼Œé€ æˆé”™è¯¯</span></span><br><span class="line"><span class="comment">//ä¾æ¬¡åˆ›å»ºä¸‰ä¸ªView</span></span><br><span class="line"><span class="built_in">UIView</span> *redView = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">    redView.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">    redView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:redView];</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">UIView</span> *blueView = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">    blueView.backgroundColor = [<span class="built_in">UIColor</span> blueColor];</span><br><span class="line">    blueView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:blueView];</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">UIView</span> *yellowView = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">    yellowView.backgroundColor = [<span class="built_in">UIColor</span> yellowColor];</span><br><span class="line">    yellowView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:yellowView];</span><br><span class="line"><span class="comment">//viewæ·»åŠ å®Œäº†ï¼Œå¼€å§‹åˆ›å»ºçº¦æŸ</span></span><br><span class="line"><span class="comment">//1.åˆ›å»ºæ°´å¹³æ–¹å‘çº¦æŸ</span></span><br><span class="line"><span class="built_in">NSString</span> *Hvfl = <span class="string">@"H:|-margin-[redView(50)]-margin-[blueView(==redView)]-margin-[yellowView(==redView)]"</span>;</span><br><span class="line"><span class="comment">//å¤§å®¶è®¤çœŸä½“ä¼šä¸€ä¸‹ä¸Šé¢è¿™ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">//å¦‚æœç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼Œè¾¹ç¼˜-é—´è·-çº¢è‰²viewï¼ˆå®½50ï¼‰-é—´è·-è“è‰²Viewï¼ˆå®½ç­‰äºçº¢è‰²Viewçš„å®½ï¼‰-é—´è·-é»„è‰²Viewï¼ˆå®½ç­‰äºçº¢è‰²Viewçš„å®½ï¼‰</span></span><br><span class="line"><span class="comment">//è®¾ç½®é—´è·è¦æ›¿æ¢çš„æ•°å€¼ï¼Œç”¨å­—å…¸å½¢å¼</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *metrics = @&#123; <span class="string">@"margin"</span>:@<span class="number">20</span>&#125;;</span><br><span class="line"><span class="comment">//æŠŠè¦æ·»åŠ çº¦æŸçš„Viewéƒ½è½¬æˆå­—å…¸å½¢å¼</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *views = <span class="built_in">NSDictionaryOfVariableBindings</span>(redView,blueView,yellowView);</span><br><span class="line"><span class="comment">//è®¾ç½®å¯¹é½æ–¹å¼ï¼Œé¡¶éƒ¨ä¸åº•éƒ¨éƒ½ä¸çº¢è‰²Viewå¯¹é½</span></span><br><span class="line"><span class="built_in">NSLayoutFormatOptions</span> ops = <span class="built_in">NSLayoutFormatAlignAllTop</span>|<span class="built_in">NSLayoutFormatAlignAllBottom</span>;</span><br><span class="line"><span class="comment">//åˆ›å»ºæ°´å¹³æ–¹å‘çº¦æŸ</span></span><br><span class="line"><span class="built_in">NSArray</span> *Hconstraints = [<span class="built_in">NSLayoutConstraint</span> constraintsWithVisualFormat:Hvfl options:ops metrics:metrics views:views];</span><br><span class="line"><span class="comment">//è¿™é‡Œä¾ç„¶è¦è®¾ç½®çº¢è‰²viewçš„é«˜ï¼Œå› ä¸ºæ°´å¹³æ–¹å‘çš„çº¦æŸæ²¡æœ‰è®¾ç½®çº¢è‰²Viewçš„é«˜ï¼Œå…¶ä»–Viewä»…ä»…æ˜¯ä¸å®ƒé¡¶éƒ¨åº•éƒ¨å¯¹é½ï¼Œä½†æ˜¯é«˜ä¾ç„¶æœªçŸ¥</span></span><br><span class="line"><span class="built_in">NSString</span> *Vvfl = <span class="string">@"V:[redView(50)]-margin-|"</span>;</span><br><span class="line"><span class="comment">//åˆ›å»ºå‚ç›´æ–¹å‘çº¦æŸ</span></span><br><span class="line"><span class="built_in">NSArray</span> *Vconstraints = [<span class="built_in">NSLayoutConstraint</span> constraintsWithVisualFormat:Vvfl options:ops metrics:metrics views:views];</span><br><span class="line"><span class="comment">//çˆ¶æ§ä»¶æ·»åŠ çº¦æŸ</span></span><br><span class="line">[<span class="keyword">self</span>.view addConstraints:Hconstraints];</span><br><span class="line">[<span class="keyword">self</span>.view addConstraints:Vconstraints];</span><br><span class="line"><span class="comment">//æœ€ç»ˆæ•ˆæœå›¾å¦‚ä¸‹:</span></span><br></pre></td></tr></table></figure><p><img src="https://foolpermi-blog-1254115483.cos.ap-chengdu.myqcloud.com/images/cocoa/Autolayout%E6%80%BB%E7%BB%93_06.jpg" width="320" height="568" align="center"></p></li></ul><h2 id="Masonryå®ç°Autolayout"><a href="#Masonryå®ç°Autolayout" class="headerlink" title="Masonryå®ç°Autolayout"></a>Masonryå®ç°Autolayout</h2><p>Masonry æ˜¯ iOS å’Œ OS X å¹³å°ä¸Šéå¸¸ä¼˜ç§€çš„ç¬¬ä¸‰æ–¹ Autolayout æ¡†æ¶ï¼Œé‡‡ç”¨æ›´ä¼˜é›…çš„é“¾å¼è¯­æ³•å¯¹åŸç”Ÿ API è¿›è¡Œå°è£…ï¼Œç®€æ´æ˜äº†å¹¶å…·æœ‰å¾ˆé«˜çš„å¯è¯»æ€§ã€‚</p><p>å…ˆçœ‹ä¸€æ®µ sample code æ¥è®¤è¯† Masonry:</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">UIEdgeInsets</span> padding = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">make.edges.equalTo(superview).with.insets(padding);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹ block é‡Œé¢çš„é‚£å¥è¯:<em>make edges equalTo superview with insets</em>,é€šè¿‡ç±»ä¼¼äºè‡ªç„¶è¯­è¨€çš„å‡ è¡Œä»£ç å°±æŠŠ view1 çº¦æŸå¥½äº†ï¼Œé€šä¿—æ˜“æ‡‚ã€‚</p><p>å…ˆçœ‹çœ‹ Masonry æ”¯æŒå“ªäº›å±æ€§</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *left; <span class="comment">//å·¦ä¾§</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *right; <span class="comment">//å³ä¾§</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *top; <span class="comment">//ä¸Šä¾§</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *bottom; <span class="comment">//ä¸‹ä¾§</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *leading; <span class="comment">//é¦–éƒ¨</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *trailing; <span class="comment">//å°¾éƒ¨</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *width; <span class="comment">//å®½</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *height; <span class="comment">//é«˜</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *centerX; <span class="comment">//æ¨ªå‘ä¸­ç‚¹</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *centerY; <span class="comment">//çºµå‘ä¸­ç‚¹</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) MASConstraint *baseline; <span class="comment">//æ–‡æœ¬åŸºçº¿</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ leading ä¸ leftã€trailing ä¸ right åœ¨æ­£å¸¸æƒ…å†µä¸‹æ˜¯ç­‰ä»·çš„ï¼Œé™¤äº†ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæ¯”å¦‚é˜¿æ‹‰ä¼¯æ–‡ï¼Œæ­£å¸¸ä½¿ç”¨æƒ…å†µä¸‹åŸºæœ¬ä¸Šå¯ä»¥ä¸ç†ä¸ç”¨ï¼Œç”¨ left å’Œ right å°±å¥½äº†ã€‚ä¸‹é¢é€šè¿‡ä¸€äº›ç®€å•çš„å®ä¾‹æ¥å­¦ä¹ å¦‚ä½•æ„‰å¿«çš„ä½¿ç”¨ Masonry:</p><p><strong>1.å±…ä¸­æ˜¾ç¤ºä¸€ä¸ª view</strong></p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad&#123;</span><br><span class="line">  [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">  <span class="built_in">UIView</span> *sv = [[<span class="built_in">UIView</span> alloc]init];</span><br><span class="line">  sv.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">  [<span class="keyword">self</span>.view addSubview:sv];</span><br><span class="line">  [sv mas_makeConstraints:^(MASConstraintMaker *make)&#123;</span><br><span class="line">    make.center.equalTo(<span class="keyword">self</span>.view);</span><br><span class="line">    make.size.mas_equalTo(<span class="built_in">CGSizeMake</span>(<span class="number">300</span>,<span class="number">300</span>));</span><br><span class="line">  &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p>1.<a href="http://www.jianshu.com/p/d7a4790090f1" target="_blank" rel="noopener">iOS Autolayoutä¹‹AppleåŸç”Ÿä»£ç å®ç°</a> </p><p>2.<a href="http://www.jianshu.com/p/757cc57fd9ea" target="_blank" rel="noopener">iOS Autolayoutä¹‹VFL</a> </p><p>3.<a href="http://adad184.com/2014/09/28/use-masonry-to-quick-solve-autolayout/" target="_blank" rel="noopener">Masonryä»‹ç»ä¸ä½¿ç”¨</a></p>]]></content>
      
      <categories>
          
          <category> Cocoa </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cocoa </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Objective-Cçš„è™šæ–¹æ³•</title>
      <link href="/cactus-light/2015/12/28/Objective-C%E7%9A%84%E8%99%9A%E6%96%B9%E6%B3%95/"/>
      <url>/cactus-light/2015/12/28/Objective-C%E7%9A%84%E8%99%9A%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>OC çš„æ–¹æ³•éƒ½æ˜¯è™šæ–¹æ³•:<br>1.çˆ¶ç±»çš„æŒ‡é’ˆå¯ä»¥æŒ‡å‘å­ç±»çš„å¯¹è±¡<br>2.è°ƒç”¨æ–¹æ³•æ—¶ä¸çœ‹æŒ‡é’ˆçœ‹å¯¹è±¡    </p><a id="more"></a><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//çˆ¶ç±»ï¼Œæœ‰ä¸€ä¸ªæ–¹æ³•jump</span></span><br><span class="line"><span class="comment">//Father.h</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Father</span> : <span class="title">NSObject</span></span></span><br><span class="line">- (<span class="keyword">void</span>)jump;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Father.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Father.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Father</span></span></span><br><span class="line">-(<span class="keyword">void</span>)jump</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Father can jump 1.2m."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å­ç±»ï¼Œé‡å†™äº†jumpæ–¹æ³•</span></span><br><span class="line"><span class="comment">//Son.h</span></span><br><span class="line"><span class="meta">#import<span class="meta-string">"Father.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Son</span> : <span class="title">Father</span></span></span><br><span class="line"><span class="comment">//é‡å†™ï¼Œæ— éœ€å£°æ˜</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Son.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Son.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Son</span></span></span><br><span class="line">-(<span class="keyword">void</span>)jump</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Son can jump 1.8m."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//main.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Father.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Son.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc,<span class="keyword">const</span> <span class="keyword">char</span>* argv[])</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">@autoreleasepool</span>&#123;</span><br><span class="line">    Son* son = [[Son alloc]init];</span><br><span class="line">    Father* father = son;<span class="comment">//çˆ¶ç±»çš„æŒ‡é’ˆæŒ‡å‘å­ç±»çš„å¯¹è±¡</span></span><br><span class="line">    [father jump];<span class="comment">//è°ƒç”¨çˆ¶ç±»çš„jumpè¿˜æ˜¯å­ç±»çš„jump?</span></span><br><span class="line">    <span class="comment">//è°ƒç”¨çš„ä»ç„¶æ˜¯å­ç±»çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//è°ƒç”¨æ–¹æ³•æ—¶ä¸çœ‹æŒ‡é’ˆï¼Œçœ‹å¯¹è±¡</span></span><br><span class="line">    <span class="comment">//å¯¹è±¡çš„åœ°å€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>ï¼›</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„æ–¹æ³•å«åšè™šæ–¹æ³•ï¼Œå¯ä»¥æè¿°ä¸åŒäº‹ç‰©è¢«ç›¸åŒäº‹ä»¶è§¦å‘ï¼Œäº§ç”Ÿä¸åŒçš„å“åº”ï¼ˆç»“æœï¼‰ã€‚ä¸‹é¢å†™ä¸€ä¸ªæ®´æ‰“å°åŠ¨ç‰©çš„ç¨‹åºã€‚</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//çˆ¶ç±»ï¼ŒAnimalï¼Œæœ‰ä¸€ä¸ªbeBeatenæ–¹æ³•ï¼Œæè¿°è¢«æ‰“æ—¶çš„å“åº”</span></span><br><span class="line"><span class="comment">//Animal.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Animal</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)beBeaten;<span class="comment">//è¢«æ‰“æ—¶çš„å“åº”</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Animal.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Animal.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Animal</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)beBeaten</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> ;<span class="comment">//è™šæ–¹æ³•ï¼Œå¯ä»¥ä»€ä¹ˆéƒ½ä¸åšï¼Œæ¯ä¸ªå­ç±»éƒ½ä¼šé‡å†™è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Cat.h</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Animal.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Cat</span> : <span class="title">Animal</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Cat.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Cat.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Cat</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)beBeaten</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Bark and jump to high!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Dog.h</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Animal.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Dog</span> : <span class="title">Animal</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Dog.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Dog.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Dog</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)beBeaten</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Give a hard bit!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Frog.h</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Animal.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Frog</span> : <span class="title">Animal</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Frog.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Frog.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Frog</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)beBeaten</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Do nothing!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Humanç±»ï¼Œæœ‰ä¸€ä¸ªæ–¹æ³•beat</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Fountion.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Animal.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Human</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)beatAnimal:(Animal*)animal;<span class="comment">//çˆ¶ç±»çš„æŒ‡é’ˆå¯ä»¥æŒ‡å‘ä»»æ„ä¸€ä¸ªå­ç±»çš„åœ°å€ï¼Œå¦åˆ™ï¼Œæ®´æ‰“ä¸åŒçš„åŠ¨ç‰©ï¼Œå°±éœ€è¦åˆ›å»ºä¸åŒçš„åŠ¨ç‰©å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Human.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Human.h"</span></span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Human</span></span></span><br><span class="line"><span class="comment">//åªéœ€è¦å†™ä¸€ä¸ªæ–¹æ³•ï¼Œå°½ç®¡åŠ¨ç‰©ä¸åŒï¼Œè¿™å°±æ˜¯çˆ¶ç±»å¯ä»¥æŒ‡å‘å­ç±»çš„å¥½å¤„</span></span><br><span class="line">-(<span class="keyword">void</span>)beatAnimal:(Animal*)animal</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Human beat the %@"</span>,[animal <span class="keyword">class</span>]);</span><br><span class="line">  [animal beBeaten];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//main.m</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Dog.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Cat.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Frog.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"Human.h"</span></span></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc,<span class="keyword">const</span> <span class="keyword">char</span>* argv[])</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">@autoreleasepool</span>&#123;</span><br><span class="line">    Frog* frog = [[Frog alloc]init];</span><br><span class="line">    Dog* dog = [[Dog alloc]init];</span><br><span class="line">    Cat* cat = [[Cat alloc]init];</span><br><span class="line">    Human* Linda = [[Human alloc]init]; <span class="comment">//who is Linda?</span></span><br><span class="line">    [Linda beatAnimal:frog]; <span class="comment">//ä¸åŒçš„äº‹ç‰©è¢«ç›¸åŒçš„äº‹ä»¶è§¦å‘ï¼Œäº§ç”Ÿä¸åŒçš„å“åº”</span></span><br><span class="line">    [Linda beatAnimal:cat];</span><br><span class="line">    [Linda beatAnimal:dog];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Objective-C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> objc </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Objective-Cçš„å†…å­˜ç®¡ç†</title>
      <link href="/cactus-light/2015/12/26/Objective-C%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"/>
      <url>/cactus-light/2015/12/26/Objective-C%E7%9A%84%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/</url>
      <content type="html"><![CDATA[<p>é¦–å…ˆè°¢è°¢ <a href="http://blog.csdn.net/lonelyroamer/article/details/7666851" target="_blank" rel="noopener">LonelyRoamer</a>   ï¼Œå®ƒçš„æ–‡ç« è®©æˆ‘æ˜ç™½ä¸€äº›äº‹æƒ…ã€‚æ•´ç†å¦‚ä¸‹ï¼Œåˆ†äº«ç»™å¤§å®¶ï¼š </p><h2 id="ä¸€ã€å†…å­˜ç®¡ç†çš„é»„é‡‘æ³•åˆ™"><a href="#ä¸€ã€å†…å­˜ç®¡ç†çš„é»„é‡‘æ³•åˆ™" class="headerlink" title="ä¸€ã€å†…å­˜ç®¡ç†çš„é»„é‡‘æ³•åˆ™:"></a>ä¸€ã€å†…å­˜ç®¡ç†çš„é»„é‡‘æ³•åˆ™:</h2><p>å¦‚æœä¸€ä¸ªå¯¹è±¡ä½¿ç”¨äº†  allocã€copyã€mutableCopyã€retainã€newï¼Œé‚£ä½ å°±å¿…é¡»ä½¿ç”¨ç›¸åº”çš„ release æˆ– autorelease.<br><a id="more"></a></p><h2 id="äºŒã€å†…å­˜ç®¡ç†ç±»å‹åˆ†ç±»"><a href="#äºŒã€å†…å­˜ç®¡ç†ç±»å‹åˆ†ç±»" class="headerlink" title="äºŒã€å†…å­˜ç®¡ç†ç±»å‹åˆ†ç±»"></a>äºŒã€å†…å­˜ç®¡ç†ç±»å‹åˆ†ç±»</h2><p>åŸºæœ¬ç±»å‹å’Œ C è¯­è¨€ç±»å‹ï¼šå¦‚ intã€shortã€charã€structã€enumã€unionç­‰ç±»å‹.<br>Objective-C ç±»å‹ï¼šä»»ä½•ç»§æ‰¿äº NSObject çš„å¯¹è±¡éƒ½å±äº Objective-C çš„ç±»å‹ã€‚<br>æˆ‘ä»¬è®²çš„å†…å­˜ç®¡ç†å®é™…ä¸Šæ˜¯å¯¹ Objective-C ç±»å‹çš„å†…å­˜ç®¡ç†ï¼Œå®ƒå¯¹åŸºæœ¬æ•°æ®ç±»å‹å’Œ C è¯­è¨€çš„ç±»å‹å¹¶ä¸ç®¡ç”¨ã€‚ </p><h2 id="ä¸‰ã€C-å’Œ-C-å†…å­˜ç®¡ç†çš„ä¸è¶³"><a href="#ä¸‰ã€C-å’Œ-C-å†…å­˜ç®¡ç†çš„ä¸è¶³" class="headerlink" title="ä¸‰ã€C å’Œ C++ å†…å­˜ç®¡ç†çš„ä¸è¶³"></a>ä¸‰ã€C å’Œ C++ å†…å­˜ç®¡ç†çš„ä¸è¶³</h2><p>å½“æœ‰å¤šä¸ªæŒ‡é’ˆåŒæ—¶æŒ‡å‘åŒä¸€å—å†…å­˜çš„æ—¶å€™ï¼Œä»»ä½•ä¸€ä¸ªè°ƒç”¨äº† free æ–¹æ³•é‡Šæ”¾äº†å†…å­˜ï¼Œè€Œå…¶ä½™æŒ‡é’ˆåœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ç»§ç»­ä½¿ç”¨è¿™å—å†…å­˜å°±ä¼šå‡ºç°é—®é¢˜ï¼Œä½•æ—¶ç”±è°å»é‡Šæ”¾è¿™å—å†…å­˜ï¼Œå°±æ˜¯ C å’Œ C++ åœ¨å†…å­˜ç®¡ç†ä¸Šçš„æ··ä¹±ã€‚ </p><h2 id="å››ã€Objective-C-å¯¹è±¡åœ¨å†…å­˜ä¸­çš„ç»“æ„"><a href="#å››ã€Objective-C-å¯¹è±¡åœ¨å†…å­˜ä¸­çš„ç»“æ„" class="headerlink" title="å››ã€Objective-C å¯¹è±¡åœ¨å†…å­˜ä¸­çš„ç»“æ„"></a>å››ã€Objective-C å¯¹è±¡åœ¨å†…å­˜ä¸­çš„ç»“æ„</h2><p>æ‰€æœ‰çš„ Objective-C ç±»å‹å¯¹è±¡çš„ç»“æ„å¦‚ä¸‹ï¼Œè¿™ä¸ªå¯¹è±¡çš„å†…å­˜åœ¨åŒ…å«è‡ªå·±çš„å˜é‡å’Œæ–¹æ³•çš„åŸºç¡€ä¸Šè¿˜åŒ…å«ä¸€ä¸ªåä¸º retainCount çš„å¼•ç”¨è®¡æ•°å™¨ç”¨æ¥è¡¨ç¤ºå½“å‰å¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼Œå¦‚æœå¼•ç”¨æ¬¡æ•°ä¸º0ï¼Œå°±ä¼šè°ƒ dealloc é‡Šæ”¾è¿™å—å†…å­˜ã€‚</p><p><strong>MRCè§„åˆ™ï¼š</strong></p><ul><li>Objective-C ç±»ä¸­å®ç°äº†å¼•ç”¨è®¡æ•°å™¨ï¼Œå¯¹è±¡çŸ¥é“è‡ªå·±å½“å‰è¢«å¼•ç”¨çš„æ¬¡æ•°</li><li>ä¸€ä¸ªå¯¹è±¡è¢«åˆå§‹ alloc ä»¥å retainCount  ä¸º1</li><li>å¦‚æœéœ€è¦å¼•ç”¨å¯¹è±¡ï¼Œå¯ä»¥ç»™å¯¹è±¡å‘é€ä¸€ä¸ª retain æ¶ˆæ¯ï¼Œè¿™æ ·å¯¹è±¡çš„ retainCount å°±åŠ 1</li><li>å½“ä¸éœ€è¦å¼•ç”¨å¯¹è±¡äº†ï¼Œå¯ä»¥ç»™å¯¹è±¡å‘é€ release æ¶ˆæ¯ï¼Œè¿™æ ·å¯¹è±¡ retainCount å°±å‡1</li><li>å½“ retainCount å‡åˆ°0ï¼Œè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„ dealloc å‡½æ•°ï¼Œå¯¹è±¡å°±ä¼šé‡Šæ”¾å†…å­˜</li><li>è®¡æ•°å™¨ä¸º0çš„å¯¹è±¡ä¸èƒ½å†ä½¿ç”¨ release å’Œå…¶ä»–æ–¹æ³•</li></ul><h2 id="äº”ã€ä¸¾ä¾‹è¯´æ˜"><a href="#äº”ã€ä¸¾ä¾‹è¯´æ˜" class="headerlink" title="äº”ã€ä¸¾ä¾‹è¯´æ˜"></a>äº”ã€ä¸¾ä¾‹è¯´æ˜</h2><p>æ¯”å¦‚æœ‰ä¸€ä¸ªå¼•æ“ç±» Engine, æœ‰ä¸€ä¸ªç±» Car, Car é‡Œé¢æœ‰ä¸€ä¸ª Engine çš„å®ä¾‹å˜é‡ï¼Œä¸€ä¸ª setter å’Œä¸€ä¸ª getter æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"Car.h"</span>  </span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Car</span></span></span><br><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  _engine = engine;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (Engine*) engine &#123;</span><br><span class="line">  <span class="keyword">return</span> _engine; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>) dealloc &#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Car is dealloc"</span>);</span><br><span class="line">  [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢å†™çš„æ˜¯ä¸€ä¸ªç®€å•çš„ç±»ï¼Œä½†æ˜¯è¿™æ ·å†™æ˜¯æœ‰é—®é¢˜ï¼Œéœ€è¦ä¸€æ­¥æ­¥çš„æ”¹è¿›ã€‚<br><strong>ç¬¬ä¸€æ­¥æ”¹è¿›ï¼š</strong><br>å…ˆä½¿ç”¨å®ƒçœ‹é—®é¢˜çš„æ‰€åœ¨ï¼Œåœ¨ main æ–¹æ³•é‡Œé¢å¦‚ä¸‹ä½¿ç”¨ï¼š<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…ˆåˆ›å»ºä¸€ä¸ªå¼•æ“</span></span><br><span class="line">Engine* engine1 = [[Engine alloc]init];</span><br><span class="line">[engine setID: <span class="number">1</span>]ï¼›</span><br><span class="line"><span class="comment">//å†åˆ›å»ºä¸€ä¸ªæ±½è½¦ï¼Œè®¾ç½®æ±½è½¦çš„å¼•æ“</span></span><br><span class="line">Car* car = [[Car alloc]init];<span class="comment">//retainCount=1</span></span><br><span class="line">[car setEngine: engine];</span><br><span class="line"><span class="comment">/*åˆ†æï¼šåœ¨è¿™é‡Œï¼Œç°åœ¨æœ‰ä¸¤ä¸ªå¼•ç”¨æŒ‡å‘è¿™ä¸ªEngineå¯¹è±¡ï¼Œengine1å’ŒCarä¸­çš„_engineï¼Œå¯æ˜¯è¿™ä¸ªEngineå¯¹è±¡çš„å¼•ç”¨è®¡æ•°è¿˜ä¸º1ï¼Œå› ä¸ºåœ¨setteræ–¹æ³•ä¸­ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨retainã€‚é‚£ä¹ˆä¸ç®¡æ˜¯é‚£ä¸ªå¼•ç”¨è°ƒç”¨releaseï¼Œé‚£ä¹ˆå¦å¤–ä¸€ä¸ªå¼•ç”¨éƒ½å°†æŒ‡å‘ä¸€å—é‡Šæ”¾æ‰çš„å†…å­˜ï¼Œé‚£ä¹ˆè‚¯å®šä¼šå‘ç”Ÿé”™è¯¯ï¼Œæ‰€ä»¥éœ€è¦åœ¨setteræ–¹æ³•ä¸­æ”¹è¿›ã€‚*/</span></span><br></pre></td></tr></table></figure></p><p><strong>ç¬¬äºŒæ­¥æ”¹è¿›ï¼š</strong><br>setter æ–¹æ³•æ”¹è¿›<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  _engine = [engine <span class="keyword">retain</span>];<span class="comment">//å¤šä¸€ä¸ªå¼•ç”¨ï¼ŒretainCount+1 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å†åœ¨ main ä¸­ä½¿ç”¨å®ƒ:<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…ˆåˆ›å»ºä¸€ä¸ªå¼•æ“</span></span><br><span class="line">Engine* engine1 = [[Engine alloc]init];</span><br><span class="line">[engine1 setID: <span class="number">1</span>];</span><br><span class="line"><span class="comment">//å†åˆ›å»ºä¸€ä¸ªæ±½è½¦ï¼Œè®¾ç½®æ±½è½¦çš„å¼•æ“</span></span><br><span class="line">Car* car = [[Car alloc]init];<span class="comment">//retainCount=1</span></span><br><span class="line">[car setEngine: engine1];<span class="comment">//retainCount=2ï¼Œå› ä¸ºsetterä¸­ä½¿ç”¨äº†retain</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡è®¾è¿˜æœ‰ä¸€ä¸ªå¼•æ“</span></span><br><span class="line">Engine* engine2 = [[Engine alloc]init];</span><br><span class="line">[engine2 setID: <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™ä¸ªæ±½è½¦è¦æ¢å¼•æ“ï¼Œè‡ªç„¶åˆè¦è°ƒç”¨setteræ–¹æ³•</span></span><br><span class="line">[car setEngine: engine2];</span><br><span class="line"><span class="comment">/*åˆ†æï¼šè¿™é‡Œæ¢äº†ä¸€ä¸ªå¼•æ“ï¼Œé‚£ä¹ˆå®ƒçš„engineå°±ä¸å†æŒ‡å‘engine1çš„é‚£ä¸ªå¯¹è±¡çš„å†…å­˜äº†ï¼Œè€Œæ˜¯æ¢æˆäº†engine2ï¼Œä¹Ÿå°±æ˜¯è¯´engine1çš„é‚£å—å¯¹è±¡æŒ‡å‘çš„å†…å­˜çš„å¼•ç”¨åªæœ‰ä¸€ä¸ªã€‚å¯æ˜¯å®ƒçš„retainCountæ˜¯ä¸¤ä¸ªï¼Œè¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼Œæ‰€ä»¥ä»éœ€è¦æ”¹è¿›*/</span></span><br></pre></td></tr></table></figure></p><p><strong>ç¬¬ä¸‰æ­¥æ”¹è¿›ï¼š</strong><br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  [_engine release];<span class="comment">//åœ¨è®¾ç½®ä¹‹å‰ï¼Œå…ˆreleaseï¼Œé‚£ä¹ˆåœ¨è®¾ç½®çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨å°†å‰é¢çš„ä¸€ä¸ªå¼•ç”¨releaseæ‰</span></span><br><span class="line">  _engine = [engine <span class="keyword">retain</span>];<span class="comment">//å¤šä¸€ä¸ªå¼•ç”¨ï¼ŒretainCount+1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å†åœ¨ main ä¸­ä½¿ç”¨<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…ˆåˆ›å»ºä¸€ä¸ªå¼•æ“</span></span><br><span class="line">Engine* engine1 = [[Engine alloc]init];</span><br><span class="line">[engine1 setID: <span class="number">1</span>];</span><br><span class="line"><span class="comment">//å†åˆ›å»ºä¸€ä¸ªæ±½è½¦ï¼Œè®¾ç½®æ±½è½¦çš„å¼•æ“</span></span><br><span class="line">Car* car = [[Car alloc]init];<span class="comment">//retainCount=1</span></span><br><span class="line">[car setEngine: engine1];<span class="comment">//retainCounr=2,å› ä¸ºä½¿ç”¨äº†retainï¼Œæ‰€ä»¥retainCount=2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœè¿›è¡Œäº†ä¸€ä¸ªè¯¯æ“ä½œï¼Œåˆè®¾ç½®äº†ä¸€æ¬¡engine1</span></span><br><span class="line">[car setEngine: engine1];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*åˆ†æï¼šé‚£ä¹ˆï¼Œåˆè¦é‡æ–°è°ƒç”¨ä¸€æ¬¡setteræ–¹æ³•ï¼Œè¿™æ ¹æœ¬å°±æ˜¯æ— æ„ä¹‰çš„æ“ä½œï¼Œæ‰€ä»¥è¦åœ¨è®¾ç½®ä¹‹é—´åŠ ä¸Šåˆ¤æ–­*/</span></span><br></pre></td></tr></table></figure></p><p><strong>ç¬¬å››æ­¥æ”¹è¿›ï¼š</strong><br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  <span class="keyword">if</span>ï¼ˆ_engine != engineï¼‰&#123;<span class="comment">//åˆ¤æ–­æ˜¯å¦é‡å¤è®¾ç½®</span></span><br><span class="line">    [_engine release];<span class="comment">//åœ¨è®¾ç½®ä¹‹å‰ï¼Œå…ˆreleaseï¼Œé‚£ä¹ˆåœ¨è®¾ç½®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨å°†å‰é¢ä¸€ä¸ªå¼•ç”¨releaseæ‰</span></span><br><span class="line">    _engine = [engine <span class="keyword">retain</span>];<span class="comment">//å¤šäº†ä¸€ä¸ªå¼•ç”¨ï¼ŒretainCount+1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>ç¬¬äº”æ­¥æ”¹è¿›ï¼š</strong><br>ç°åœ¨ setter æ–¹æ³•åŸºæœ¬æ²¡æœ‰é—®é¢˜äº†ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬é‡Šæ”¾æ‰ä¸€ä¸ª car å¯¹è±¡çš„æ—¶å€™ï¼Œä¹Ÿè¦é‡Šæ”¾å®ƒé‡Œé¢ _engine çš„å¼•ç”¨ï¼Œæ‰€ä»¥è¦é‡å†™ Car çš„ dealloc æ–¹æ³•ã€‚<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) dealloc &#123;</span><br><span class="line">  [_engine release];<span class="comment">//åœ¨é‡Šæ”¾carçš„æ—¶å€™ï¼Œé‡Šæ”¾æ‰å®ƒå¯¹engineçš„å¼•ç”¨</span></span><br><span class="line">  [<span class="keyword">super</span> dealloc]; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™è¿˜ä¸æ˜¯æœ€å¥½çš„æ–¹æ³•ï¼Œä¸‹é¢çš„æ–¹æ³•æ›´å¥½<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) dealloc &#123;</span><br><span class="line">  [<span class="keyword">self</span> setEngine: <span class="literal">nil</span>];<span class="comment">//é‡Šæ”¾carå¾—åˆ†æ—¶å€™ï¼Œä½¿ç”¨setEngineè®¾ä¸ºnilï¼Œå®ƒä¸ä»…ä¼šreleaseæ‰ï¼Œè€Œä¸”æŒ‡å‘nilï¼Œå³ä½¿è¯¯æ“ä½œä¹Ÿä¸ä¼šå‡ºé”™'</span></span><br><span class="line">  [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰€ä»¥ï¼Œç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨ setter æ–¹æ³•ä¸­çš„æœ€ç»ˆå†™æ³•æ˜¯<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  <span class="keyword">if</span>(_engine != engine)&#123;<span class="comment">//åˆ¤æ–­æ˜¯å¦é‡å¤</span></span><br><span class="line">    [_engine release];<span class="comment">//è®¾ç½®ä¹‹å‰ï¼Œå…ˆreleaseï¼Œåœ¨è®¾ç½®çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨å°†å‰é¢çš„å¼•ç”¨releaseæ‰</span></span><br><span class="line">    _engine = [engine <span class="keyword">retain</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¹Ÿå¯ä»¥æ˜¯ï¼š<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  [engine <span class="keyword">retain</span>]; <span class="comment">//ä¸€å®šæ³¨æ„retainå’Œreleaseçš„å…ˆåé¡ºåºï¼Œä¸ç„¶engineå’Œ_engineç›¸åŒæ—¶ä¼šå‡ºé”™</span></span><br><span class="line">  [_engine release];</span><br><span class="line">  _engine = engine;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç„¶ååœ¨ dealloc æ–¹æ³•ä¸­çš„å†™æ³•æ˜¯ï¼š</p><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) dealloc &#123;</span><br><span class="line">  [<span class="keyword">self</span> setEngine:<span class="literal">nil</span>];</span><br><span class="line">  [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…­ã€propertyä¸­setterçš„å…³é”®å­—"><a href="#å…­ã€propertyä¸­setterçš„å…³é”®å­—" class="headerlink" title="å…­ã€propertyä¸­setterçš„å…³é”®å­—"></a>å…­ã€propertyä¸­setterçš„å…³é”®å­—</h2><p>åœ¨ property ä¸­æœ‰ä¸‰ä¸ªå…³é”®å­—å®šä¹‰å…³äºå±•å¼€ setter æ–¹æ³•ä¸­çš„è¯­æ³•ï¼Œassignã€retainã€copy.</p><ul><li>assign å±•å¼€ setter çš„å†™æ³•</li></ul><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  _engine = engine;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>retain å±•å¼€ setter çš„å†™æ³•</li></ul><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine: (Engine*) engine &#123;</span><br><span class="line">  <span class="keyword">if</span>(_engine != engine) &#123;<span class="comment">//åˆ¤è¯»æ–­æ˜¯å¦é‡å¤è®¾ç½®</span></span><br><span class="line">    [_engine release];<span class="comment">//è®¾ç½®ä¹‹å‰ï¼Œå…ˆreleaseï¼Œé‚£ä¹ˆåœ¨è®¾ç½®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨å°†å‰é¢ä¸€ä¸ªå¼•ç”¨releaseæ‰</span></span><br><span class="line">    _engine = [engine <span class="keyword">retain</span>];<span class="comment">//å¤šäº†ä¸€ä¸ªå¼•ç”¨ï¼ŒretainCount+1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>copy å±•å¼€ setter çš„å†™æ³•</li></ul><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>) setEngine : (Engine*) engine &#123;</span><br><span class="line">  <span class="keyword">if</span>(_engine!=engine) &#123;<span class="comment">//åˆ¤æ–­æ˜¯å¦é‡å¤è®¾ç½®</span></span><br><span class="line">    [_engine release];<span class="comment">//è®¾ç½®ä¹‹å‰å…ˆrelease</span></span><br><span class="line">    _engine = [engine <span class="keyword">copy</span>];<span class="comment">//å¤šäº†ä¸€ä¸ªå¼•ç”¨ï¼ŒretainCount+1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äº copy å±æ€§æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œè¢«å®šä¹‰æœ‰ copy å±æ€§çš„å¯¹è±¡å¿…é¡»è¦ç¬¦åˆ NSCopying åè®®ï¼Œå¹¶ä¸”å®ç° copyWithZone: æ–¹æ³•ã€‚å¯ä»¥çœ‹åˆ°,ä½¿ç”¨ retain å’Œæˆ‘ä»¬ä¸Šé¢ä¸¾çš„ä¾‹å­å®Œå…¨ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ property å’Œå®ƒçš„ retain ä»£æ›¿ä¹‹å‰çš„å†™æ³•ã€‚</p><h2 id="ä¸ƒã€autoreleaseç”¨æ³•ç®€ä»‹"><a href="#ä¸ƒã€autoreleaseç”¨æ³•ç®€ä»‹" class="headerlink" title="ä¸ƒã€autoreleaseç”¨æ³•ç®€ä»‹"></a>ä¸ƒã€autoreleaseç”¨æ³•ç®€ä»‹</h2><p>autorelease ä»å­—é¢ä¸Šçš„æ„æ€ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œè‡ªåŠ¨é‡Šæ”¾æ± ã€‚autorelease å®é™…ä¸Šä¹Ÿæ˜¯å°†å¯¹è±¡è¿›è¡Œ release, ä½†æ˜¯å®ƒå°†å¯¹release çš„è°ƒç”¨è¿›è¡Œäº†å»¶è¿Ÿå¤„ç†ï¼Œå½“ä½ ä½¿ç”¨ autorelease çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šç«‹åˆ»å°†å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å‡1ï¼Œè€Œæ˜¯å°†è¿™ä¸ªå¯¹è±¡æ”¾å…¥äº† autorelease pool ä¸­ï¼Œå½“ pool è¢«é‡Šæ”¾æ—¶ï¼Œpool ä¸­çš„æ‰€æœ‰å¯¹è±¡æ‰ä¼šè¢« releaseã€‚åœ¨æ¯ä¸ªiOSåº”ç”¨ä¸­ï¼Œå¤§å®¶ä¼šçœ‹åˆ°ä¸€ä¸ª autorelease poolï¼Œåœ¨å¼€å§‹æ—¶åˆ›å»ºï¼Œç¨‹åºç»“æŸæ—¶é‡Šæ”¾ï¼Œé‚£å²‚ä¸æ˜¯å¯¹è±¡åœ¨ç¨‹åºç»“æŸæ—¶æ‰è¢« releaseï¼Œè·Ÿå†…å­˜æ³„æ¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå…¶å®ä¸ç„¶ã€‚<br>å¯¹äºæ¯ä¸€ä¸ª Runloopï¼Œç³»ç»Ÿä¼šéšå¼åˆ›å»ºä¸€äº› autorelease poolï¼Œè¿™äº› pool ä¼šæ„æˆä¸€ä¸ªåƒ CallStack ä¸€æ ·çš„æ ˆç»“æ„ï¼Œæ¯ä¸€ä¸ª runloop ç»“æŸçš„æ—¶å€™ï¼Œæ ˆé¡¶çš„ pool ä¼šè¢«é”€æ¯ï¼Œpool ä¸­çš„å¯¹è±¡è¢«è‡ªåŠ¨ releaseï¼Œå¦‚æœä½ ä½¿ç”¨ARCï¼Œé‚£ä¹ˆä½ å°†ä¸èƒ½ç›´æ¥ä½¿ç”¨ autorelease poolï¼Œè€Œæ˜¯ä½¿ç”¨ @autoreleasepool blockã€‚<br>å‚è€ƒï¼š<a href="https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSAutoreleasePool_Class/index.html#//apple_ref/doc/uid/20000051-SW5" target="_blank" rel="noopener">Apple Reference</a> &amp;  <a href="http://www.jianshu.com/p/549c37f60bf7" target="_blank" rel="noopener">What is RunLoop</a><br>ä¾‹å¦‚:<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSAutoreleasePool</span>* pool = [[<span class="built_in">NSAutoRelease</span> alloc]init];</span><br><span class="line"><span class="comment">//Code benefitting from a local autorelease pool.</span></span><br><span class="line"><span class="comment">//æ­¤å¤„ä¸å¯ä»¥ä½¿ç”¨breakï¼Œreturnï¼Œgotoä¹‹ç±»çš„è¯­å¥ã€‚</span></span><br><span class="line">[pool release];</span><br></pre></td></tr></table></figure></p><p>å°†éœ€è¦å†™æˆ<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line"><span class="comment">//Code benefitting from a local autorelease pool.</span></span><br><span class="line"><span class="comment">//æ­¤å¤„å¯ä»¥ä½¿ç”¨breakï¼Œreturnï¼Œgotoä¹‹ç±»çš„è¯­å¥ã€‚</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>å¯¹ä¸€ä¸ª pool å‘é€ release å’Œ drain çš„åŒºåˆ«ï¼š</strong><br>åœ¨å‘ NSAutoreleasePool å‘é€ alloc å’Œ init åˆ›å»ºäº†ä¸€ä¸ª pool ä»¥åï¼Œåœ¨é”€æ¯ pool çš„æ—¶å€™å¯ä»¥å‘ pool å‘é€ drain å’Œ release æ¶ˆæ¯ã€‚macOS æ”¯æŒåƒåœ¾å›æ”¶ï¼ŒiOS å¹¶ä¸æ”¯æŒã€‚åœ¨ä¸€ä¸ªæ”¯æŒåƒåœ¾å›æ”¶çš„ç¯å¢ƒä¸­ï¼Œæ˜¯ä¸éœ€è¦ä½¿ç”¨ autorelease pool çš„ï¼Œä½†æ˜¯å‡å¦‚ä½ æƒ³ç¼–å†™ä¸€ä¸ªåº“ï¼Œè€Œè¿™ä¸ªåº“åˆéœ€è¦åŒæ—¶æ”¯æŒåƒåœ¾å›æ”¶å’Œå¼•ç”¨è®¡æ•°çš„è¯ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨ autorelease poolï¼Œåœ¨æ”¯æŒåƒåœ¾å›æ”¶çš„ç¯å¢ƒä¸­ï¼Œå‘ä¸€ä¸ª pool å‘é€ drain æ¶ˆæ¯å°†ä¼šè§¦å‘ pool åœ¨å¿…è¦çš„æ—¶å€™è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œè€Œå‘é€ release å°±æ˜¯ä¸€ä¸ªç©ºæ“ä½œã€‚è€Œåœ¨ä¸€ä¸ªå¼•ç”¨è®¡æ•°çš„ç¯å¢ƒä¸­ï¼Œdrain å’Œ release æ‰€äº§ç”Ÿçš„æ•ˆæœç›¸åŒã€‚æ‰€ä»¥é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨ drainã€‚</p><h2 id="å…«ã€ä¾¿åˆ©æ„é€ å™¨çš„æƒ…å†µ"><a href="#å…«ã€ä¾¿åˆ©æ„é€ å™¨çš„æƒ…å†µ" class="headerlink" title="å…«ã€ä¾¿åˆ©æ„é€ å™¨çš„æƒ…å†µ"></a>å…«ã€ä¾¿åˆ©æ„é€ å™¨çš„æƒ…å†µ</h2><p>å½“ä½ ä½¿ç”¨ allocã€init æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥å¯¹è±¡çš„åˆå§‹å¼•ç”¨è®¡æ•°ä¸º1ã€‚å½“ä¸å†ä½¿ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œä½ å°±è¦è´Ÿè´£é”€æ¯å®ƒã€‚<br>é™¤äº†è¿™ç§æ ‡å‡†çš„åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•å¤–ï¼Œè¿˜æœ‰ä¸€ç§åˆ›å»ºä¸´æ—¶å¯¹è±¡çš„æ–¹æ³•ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•åˆ›å»ºçš„å¯¹è±¡éƒ½æ˜¯ä¸´æ—¶å¯¹è±¡ï¼Œç”Ÿæˆä¹‹åä¼šè¢«ç›´æ¥åŠ å…¥åˆ°å†…éƒ¨çš„è‡ªåŠ¨é‡Šæ”¾æ± ï¼Œä½ ä¸éœ€è¦å…³å¿ƒå¦‚ä½•é”€æ¯å®ƒã€‚<br>æ¯”å¦‚ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªæ•°ç»„ array å’Œä¸€ä¸ªå­—ç¬¦ä¸² string çš„æ—¶å€™ï¼Œä½¿ç”¨äº†ç±»ä¼¼ä¸‹é¢çš„æ–¹æ³•ï¼š<br><figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSArray</span>* array=[<span class="built_in">NSArray</span> arrayWithArray: obj];         </span><br><span class="line"><span class="built_in">NSString</span>* string = [<span class="built_in">NSString</span> stringWithCString: <span class="string">"This is a temporary string"</span>];</span><br></pre></td></tr></table></figure></p><p>é‚£ä¹ˆï¼Œarray å’Œ string å°±ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è´Ÿè´£å†…å­˜ç®¡ç†ã€‚åŒä½¿ç”¨ alloc å’Œ init ç›¸æ¯”ï¼Œè¿™ç§ä¸ä»¥ init å¼€å¤´çš„åˆå§‹åŒ–æ–¹æ³•ä¹Ÿç§°ä¸ºä¾¿åˆ©æ„é€ å™¨ã€‚    </p><h2 id="ä¹ã€ä½¿ç”¨ARCçš„åŸºæœ¬æ³¨æ„äº‹é¡¹"><a href="#ä¹ã€ä½¿ç”¨ARCçš„åŸºæœ¬æ³¨æ„äº‹é¡¹" class="headerlink" title="ä¹ã€ä½¿ç”¨ARCçš„åŸºæœ¬æ³¨æ„äº‹é¡¹"></a>ä¹ã€ä½¿ç”¨ARCçš„åŸºæœ¬æ³¨æ„äº‹é¡¹</h2><ul><li>ä¸èƒ½åœ¨ç¨‹åºä¸­å®šä¹‰å’Œä½¿ç”¨ä¸‹åˆ—å‡½æ•°ï¼šretainã€releaseã€autorelease å’Œ retainCount    </li><li>ä½¿ç”¨ @autoreleasepool ä»£æ›¿ NSAutoreleasePool</li><li>æ–¹æ³•å‘½åå¿…é¡»éµå¾ªå‘½åè§„åˆ™ï¼Œä¸èƒ½éšæ„å®šä¹‰ä»¥ allocã€initã€newã€copyã€mutableCopy å¼€å¤´ä¸”å’Œæ‰€æœ‰æƒæ— å…³çš„æ–¹æ³•</li><li>ä¸èƒ½åœ¨ dealloc ä¸­é‡Šæ”¾å®ä¾‹å˜é‡ï¼ˆä½†å¯ä»¥åœ¨ dealloc ä¸­é‡Šæ”¾èµ„æºï¼‰ï¼Œä¹Ÿä¸éœ€è¦è°ƒç”¨ [super dealloc]</li><li>ç¼–è¯‘ä»£ç æ—¶ä½¿ç”¨ç¼–è¯‘å™¨ clangï¼Œå¹¶åŠ ä¸Šç¼–è¯‘é€‰é¡¹ -fobjc-arc</li></ul>]]></content>
      
      <categories>
          
          <category> Objective-C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> objc </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hello World</title>
      <link href="/cactus-light/2015/12/25/Hello-World/"/>
      <url>/cactus-light/2015/12/25/Hello-World/</url>
      <content type="html"><![CDATA[<p>Hello, the first blog just greetings.</p><figure class="highlight c"><figcaption><span>hello.c</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">"hello, world"</span>); </span><br></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption><span>hello.cpp</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"Hello, Linda"</span>&lt;&lt;<span class="built_in">endl</span>; <span class="comment">// so who is linda </span></span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>hello.py</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">"Hello, world"</span> </span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>hello.java</span></figcaption><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">"Hello, world"</span>); </span><br></pre></td></tr></table></figure><figure class="highlight swift"><figcaption><span>hello.swift</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">"Hello, world"</span>) </span><br></pre></td></tr></table></figure><figure class="highlight objc"><figcaption><span>hello.m</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"Hello, world"</span>); </span><br></pre></td></tr></table></figure><figure class="highlight golang"><figcaption><span>hello.go</span></figcaption><table><tr><td class="code"><pre><span class="line">fmt.Println(<span class="string">"Hello, world"</span>) </span><br></pre></td></tr></table></figure><figure class="highlight kotlin"><figcaption><span>hello.kt</span></figcaption><table><tr><td class="code"><pre><span class="line">println(<span class="string">"Hello World!"</span>) </span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> æ‚é¡¹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> essay </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
